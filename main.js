!function(){"use strict";document.querySelectorAll(".popup"),document.querySelector(".popup__form");const e=document.querySelector(".elements"),t=(document.querySelector("#card-template").content.querySelector(".element"),document.querySelector(".profile__edit-button")),s=document.querySelector(".profile__add-button"),i=document.querySelector(".popup_type_edit-profile"),n=i.querySelector(".popup__input_type_name"),r=i.querySelector(".popup__input_type_description"),o=document.querySelector(".popup_type_avatar-change"),a=document.querySelector(".profile__image"),l=document.querySelector(".popup_type_add-card"),c=document.querySelector(".popup_type-preview"),h=(c.querySelector(".popup__image"),c.querySelector(".popup__subtitle"),{formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"});function d(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class _{constructor(e){let{data:t,userId:s,templateCardSelector:i,handleCardClick:n,activateLikeButton:r,handleDeleteClick:o}=e;d(this,"_setEventListeners",(()=>{this._likeButton.addEventListener("click",(()=>this._activateLikeButton())),this._deleteButton.addEventListener("click",(()=>this._handleDeleteClick(this))),this._cardImage.addEventListener("click",(()=>this._handleCardClick(this._text,this._link)))})),d(this,"getCardElement",(()=>{this._card=this._cardTemplate.cloneNode(!0),this._likeButton=this._card.querySelector(".element__button-like"),this._deleteButton=this._card.querySelector(".element__button-delete"),this._cardImage=this._card.querySelector(".element__image");const e=this._card.querySelector(".element__title");return this._likesCounter=this._card.querySelector(".element__likes-count"),e.textContent=this._text,this._cardImage.src=this._link,this._cardImage.alt=this._text,this._setEventListeners(),this.setLikes(this._likes),this._userId!==this._ownerId&&(this._deleteButton.style.display="none"),this._card})),this._text=t.name,this._link=t.link,this._likes=t.likes,this._id=t._id,this._userId=s,this._ownerId=t.owner._id,this._templateCardSelector=i,this._handleCardClick=n,this._activateLikeButton=r,this._handleDeleteClick=o,this._cardTemplate=document.querySelector(i).content.querySelector(".element")}getId(){return this._id}removeCard(){this._card.remove(),this._card=null}setLikes(e){this._likes=e,this._likesCounter.textContent=this._likes.length,this.isLiked()?this._likeButton.classList.add("element__button-like_active"):this._likeButton.classList.remove("element__button-like_active")}isLiked(){return this._likes.find((e=>e._id===this._userId))}}function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var p=class{constructor(e,t){u(this,"_showInputError",(e=>{const{inputErrorClass:t,errorClass:s}=this._settings,i=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(t),i.textContent=e.validationMessage,i.classList.add(s)})),u(this,"_hideInputError",(e=>{const{inputErrorClass:t,errorClass:s}=this._settings,i=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(t),i.textContent="",i.classList.remove(s)})),u(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,this._settings)})),u(this,"_hasInvalidInput",(()=>this._inputList.every((e=>e.validity.valid)))),u(this,"toggleButtonState",(()=>{this._hasInvalidInput()?this._enableButton():this.disableButton()})),u(this,"_setEventListeners",(()=>{const{inputSelector:e}=this._settings;this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))})),this._settings=e,this._formElement=t,this._inputList=[...this._formElement.querySelectorAll(this._settings.inputSelector)],this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSelector)}disableButton(){const{inactiveButtonClass:e}=this._settings;this._buttonElement.disabled=!0,this._buttonElement.classList.add(e)}_enableButton(){const{inactiveButtonClass:e}=this._settings;this._buttonElement.disabled=!1,this._buttonElement.classList.remove(e)}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};class m{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popup.classList.add("popup__opened"),this.addKeyDownListener()}addKeyDownListener(){window.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup__opened"),this.removeKeyDownListener()}removeKeyDownListener(){window.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.matches(".popup")||e.target.matches(".popup__close"))&&this.close()}))}}class v extends m{constructor(e,t){super(e),this._handlerSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._submitButton=this._form.querySelector(".popup__save"),this._initialButtonText=this._submitButton.textContent,this._inputs=[...this._form.querySelectorAll(".popup__input")]}_getInputValues(){const e={};return this._inputs.forEach((t=>{const s=t.name,i=t.value;e[s]=i})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handlerSubmit(this._getInputValues())}))}changeSubmitHandler(e){this._handlerSubmit=e}changeText(e){this._submitButton.textContent=e}close(){super.close(),this._form.reset()}}const y=new class{constructor(e){var t,s;s=e=>e.ok?e.json():Promise.reject(e.statusText),(t="_checkResponse")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._baseUrl=e.baseUrl,this._headers=e.headers}getUserInfo(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then(this._checkResponse)}getCards(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then(this._checkResponse)}editProfile(e,t){return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}editAvatar(e){return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}addCard(e,t){return fetch(this._baseUrl+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}addLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then(this._checkResponse)}removeLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}removeLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}deleteCard(e){return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"4cdae314-7e8a-4bed-8ada-70ad33c12e13","Content-Type":"application/json"}}),g=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._userName=document.querySelector(t),this._userDescription=document.querySelector(s),this._avatarPic=document.querySelector(i)}getUserInfo(){return{name:this._userName.textContent,description:this._userDescription.textContent}}setUserInfo(e,t,s){this._userName.textContent=e,this._userDescription.textContent=t}setUserAvatar(e){this._avatarPic.src=e}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"});let k;Promise.all([y.getUserInfo(),y.getCards()]).then((e=>{let[t,s]=e;k=t._id,g.setUserInfo(t.name,t.about,t.avatar),x.renderItems(s)})).catch(console.log);const b=new p(h,i),f=new p(h,l),S=new p(h,o);b.enableValidation(),f.enableValidation(),S.enableValidation();const E=new v(".popup_type_add-card",(t=>{E.changeText("saving..."),y.addCard(t["card-title"],t["card-link"]).then((t=>{B(t,e)})).then((()=>{E.close()})).catch((e=>{console.log(e)})).finally((()=>{E.changeText("Create")}))}));E.setEventListeners();const L=new v(".popup_type_avatar-change",(e=>{L.changeText("saving..."),y.editAvatar(e["card-link"]).then((e=>{g.setUserAvatar(e.avatar)})).then((()=>{L.close()})).catch((e=>{console.log(e)})).finally((()=>{L.changeText("Save")}))}));L.setEventListeners();const C=new v(".popup_type_confirm-delete");C.setEventListeners();const I=new v(".popup_type_edit-profile",(e=>{I.changeText("saving..."),y.editProfile(e.Name,e.description).then((e=>{g.setUserInfo(e.name,e.about,e.avatar)})).then((()=>{I.close()})).catch((e=>{console.log(e)})).finally((()=>{I.changeText("Save")}))}));I.setEventListeners();const q=new class extends m{constructor(e){super(e),this._caption=this._popup.querySelector(".popup__subtitle"),this._image=this._popup.querySelector(".popup__image")}open(e,t){super.open(),this._caption.textContent=e,this._image.src=t,this._image.alt=" image of ".concat(e)}}(".popup_type-preview");q.setEventListeners();const w=e=>{C.open(),C.changeSubmitHandler((()=>{C.changeText("deleting..."),y.deleteCard(e.getId()).then((()=>{e.removeCard()})).then((()=>{C.close()})).catch((e=>{console.log(e)})).finally((()=>{C.changeText("Yes")}))}))},B=e=>{const t=new _({data:e,userId:k,templateCardSelector:"#card-template",handleCardClick:()=>(e=>{q.open(e.name,e.link)})(e),activateLikeButton:()=>(e=>{e.isLiked()?y.removeLike(e.getId()).then((t=>{e.setLikes(t.likes)})).catch((e=>{console.log(e)})):y.addLike(e.getId()).then((t=>{e.setLikes(t.likes)})).catch((e=>{console.log(e)}))})(t),handleDeleteClick:w});x.addItem(t.getCardElement())},x=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:B},".elements");t.addEventListener("click",(function(){!function(){const e=g.getUserInfo();n.value=e.name,r.value=e.description}(),I.open()})),s.addEventListener("click",(function(){f.disableButton(),E.open()})),a.addEventListener("click",(function(){S.disableButton(),L.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBMkJzQkEsU0FBU0MsaUJBQWlCLFVBQzNCRCxTQUFTRSxjQUFjLGdCQTVCckMsTUE4Qk1DLEVBQWNILFNBQVNFLGNBQWMsYUFNckNFLEdBTGVKLFNBQ3ZCRSxjQUFjLGtCQUNkRyxRQUFRSCxjQUFjLFlBR01GLFNBQVNFLGNBQWMsMEJBQzNDSSxFQUFtQk4sU0FBU0UsY0FBYyx3QkFHMUNLLEVBQW1CUCxTQUFTRSxjQUFjLDRCQUcxQ00sRUFBaUJELEVBQWlCTCxjQUMzQywyQkFFU08sRUFBd0JGLEVBQWlCTCxjQUNsRCxrQ0FHU1EsRUFBb0JWLFNBQVNFLGNBQWMsNkJBQzNDUyxFQUFTWCxTQUFTRSxjQUFjLG1CQU9oQ1UsRUFBZVosU0FBU0UsY0FBYyx3QkFHdENXLEVBQW9CYixTQUFTRSxjQUFjLHVCQUkzQ1ksR0FIYUQsRUFBa0JYLGNBQWMsaUJBQ2hDVyxFQUFrQlgsY0FBYyxvQkFFbEMsQ0FDcEJhLGFBQWMsZUFDZEMsY0FBZSxnQkFDZkMscUJBQXNCLGVBQ3RCQyxvQkFBcUIsdUJBQ3JCQyxnQkFBaUIsMEJBQ2pCQyxXQUFZLHlCLHdIQ3ZFVCxNQUFNQyxFQUNUQyxZQUFZLEdBQThGLElBQTlGLEtBQUNDLEVBQUQsT0FBT0MsRUFBUCxxQkFBZUMsRUFBZixnQkFBcUNDLEVBQXJDLG1CQUFzREMsRUFBdEQsa0JBQTBFQyxHQUFvQiwrQkE2QnJGLEtBQ2pCQyxLQUFLQyxZQUFZQyxpQkFBaUIsU0FBUyxJQUFNRixLQUFLRyx3QkFDdERILEtBQUtJLGNBQWNGLGlCQUFpQixTQUFTLElBQU1GLEtBQUtLLG1CQUFtQkwsUUFDM0VBLEtBQUtNLFdBQVdKLGlCQUFpQixTQUFTLElBQU1GLEtBQUtPLGlCQUFpQlAsS0FBS1EsTUFBT1IsS0FBS1MsWUFoQ2UseUJBd0R6RixLQUNiVCxLQUFLVSxNQUFRVixLQUFLVyxjQUFjQyxXQUFVLEdBRTFDWixLQUFLQyxZQUFjRCxLQUFLVSxNQUFNckMsY0FBYyx5QkFDNUMyQixLQUFLSSxjQUFnQkosS0FBS1UsTUFBTXJDLGNBQWMsMkJBQzlDMkIsS0FBS00sV0FBYU4sS0FBS1UsTUFBTXJDLGNBQWMsbUJBQzNDLE1BQU13QyxFQUFZYixLQUFLVSxNQUFNckMsY0FBYyxtQkFnQjNDLE9BZEQyQixLQUFLYyxjQUFnQmQsS0FBS1UsTUFBTXJDLGNBQWMseUJBRTdDd0MsRUFBVUUsWUFBY2YsS0FBS1EsTUFDN0JSLEtBQUtNLFdBQVdVLElBQU1oQixLQUFLUyxNQUMzQlQsS0FBS00sV0FBV1csSUFBTWpCLEtBQUtRLE1BRTNCUixLQUFLa0IscUJBRUxsQixLQUFLbUIsU0FBU25CLEtBQUtvQixRQUVoQnBCLEtBQUtxQixVQUFZckIsS0FBS3NCLFdBQ3JCdEIsS0FBS0ksY0FBY21CLE1BQU1DLFFBQVUsUUFHaEN4QixLQUFLVSxTQTdFWlYsS0FBS1EsTUFBUWQsRUFBSytCLEtBQ2xCekIsS0FBS1MsTUFBUWYsRUFBS2dDLEtBQ2xCMUIsS0FBS29CLE9BQVMxQixFQUFLaUMsTUFDbkIzQixLQUFLNEIsSUFBTWxDLEVBQUtrQyxJQUNoQjVCLEtBQUtxQixRQUFVMUIsRUFDZkssS0FBS3NCLFNBQVc1QixFQUFLbUMsTUFBTUQsSUFFM0I1QixLQUFLOEIsc0JBQXdCbEMsRUFDN0JJLEtBQUtPLGlCQUFtQlYsRUFDeEJHLEtBQUtHLG9CQUFzQkwsRUFDM0JFLEtBQUtLLG1CQUFxQk4sRUFFMUJDLEtBQUtXLGNBQWdCeEMsU0FBU0UsY0FBY3VCLEdBQ3ZDcEIsUUFBUUgsY0FBYyxZQU0vQjBELFFBQ0ksT0FBTy9CLEtBQUs0QixJQUdoQkksYUFDSWhDLEtBQUtVLE1BQU11QixTQUNYakMsS0FBS1UsTUFBUSxLQVNqQlMsU0FBU2UsR0FDTGxDLEtBQUtvQixPQUFTYyxFQUVkbEMsS0FBS2MsY0FBY0MsWUFBY2YsS0FBS29CLE9BQU9lLE9BS25CbkMsS0FBS29DLFVBRzNCcEMsS0FBS0MsWUFBWW9DLFVBQVVDLElBQUksK0JBRS9CdEMsS0FBS0MsWUFBWW9DLFVBQVVKLE9BQU8sK0JBSTFDRyxVQUNHLE9BQU9wQyxLQUFLb0IsT0FBT21CLE1BQUtDLEdBQVFBLEVBQUtaLE1BQVE1QixLQUFLcUIsVyx3SEM2Q3pELE1BbkdPLE1BQ0g1QixZQUFZUixFQUFVd0QsR0FBYSwwQkFRaEJDLElBQ2YsTUFBTSxnQkFBRXBELEVBQUYsV0FBbUJDLEdBQWNTLEtBQUsyQyxVQUV0Q0MsRUFBZTVDLEtBQUs2QyxhQUFheEUsY0FBbEIsV0FBb0NxRSxFQUFhSSxHQUFqRCxXQUNyQkosRUFBYUwsVUFBVUMsSUFBSWhELEdBQzNCc0QsRUFBYTdCLFlBQWMyQixFQUFhSyxrQkFDeENILEVBQWFQLFVBQVVDLElBQUkvQyxNQWRJLDBCQWlCaEJtRCxJQUNmLE1BQU0sZ0JBQUVwRCxFQUFGLFdBQW1CQyxHQUFjUyxLQUFLMkMsVUFFdENDLEVBQWU1QyxLQUFLNkMsYUFBYXhFLGNBQWxCLFdBQW9DcUUsRUFBYUksR0FBakQsV0FDckJKLEVBQWFMLFVBQVVKLE9BQU8zQyxHQUM5QnNELEVBQWE3QixZQUFjLEdBQzNCNkIsRUFBYVAsVUFBVUosT0FBTzFDLE1BdkJDLDhCQTBCWm1ELElBQ2ZBLEVBQWFNLFNBQVNDLE1BQ3hCakQsS0FBS2tELGdCQUFnQlIsR0FFckIxQyxLQUFLbUQsZ0JBQWdCVCxFQUFjMUMsS0FBSzJDLGNBOUJYLDJCQWtDaEIsSUFBTTNDLEtBQUtvRCxXQUFXQyxPQUFNWCxHQUFnQkEsRUFBYU0sU0FBU0MsVUFsQ2xELDRCQWlEZixLQUVaakQsS0FBS3NELG1CQUNGdEQsS0FBS3VELGdCQUVMdkQsS0FBS3dELG1CQXREbUIsNkJBMERkLEtBQ2pCLE1BQU0sY0FBRXJFLEdBQWtCYSxLQUFLMkMsVUFJL0IzQyxLQUFLeUQsb0JBQ0x6RCxLQUFLb0QsV0FBV00sU0FBU2hCLElBQ3ZCQSxFQUFheEMsaUJBQWlCLFNBQVMsS0FDckNGLEtBQUsyRCxvQkFBb0JqQixHQUN6QjFDLEtBQUt5RCw2QkFsRVR6RCxLQUFLMkMsVUFBWTFELEVBQ2pCZSxLQUFLNkMsYUFBZUosRUFDcEJ6QyxLQUFLb0QsV0FBYSxJQUFJcEQsS0FBSzZDLGFBQWF6RSxpQkFBaUI0QixLQUFLMkMsVUFBVXhELGdCQUN4RWEsS0FBSzRELGVBQWlCNUQsS0FBSzZDLGFBQWF4RSxjQUFjMkIsS0FBSzJDLFVBQVV2RCxzQkFpQ3pFb0UsZ0JBQ0ksTUFBTSxvQkFBRW5FLEdBQXdCVyxLQUFLMkMsVUFDckMzQyxLQUFLNEQsZUFBZUMsVUFBVyxFQUMvQjdELEtBQUs0RCxlQUFldkIsVUFBVUMsSUFBSWpELEdBR3RDa0UsZ0JBQ0ksTUFBTSxvQkFBRWxFLEdBQXdCVyxLQUFLMkMsVUFDckMzQyxLQUFLNEQsZUFBZUMsVUFBVyxFQUMvQjdELEtBQUs0RCxlQUFldkIsVUFBVUosT0FBTzVDLEdBeUN6Q3lFLG1CQUNJOUQsS0FBSzZDLGFBQWEzQyxpQkFBaUIsVUFBVzZELElBQzFDQSxFQUFJQyxvQkFHSmhFLEtBQUtrQix1QkM3RlYsTUFBTStDLEVBQ1R4RSxZQUFZeUUsR0FDUmxFLEtBQUttRSxPQUFTaEcsU0FBU0UsY0FBYzZGLEdBQ3JDbEUsS0FBS29FLGdCQUFrQnBFLEtBQUtvRSxnQkFBZ0JDLEtBQUtyRSxNQUdyRG9FLGdCQUFnQkwsR0FDSSxXQUFaQSxFQUFJTyxLQUNQdEUsS0FBS3VFLFFBSVZDLE9BQ0l4RSxLQUFLbUUsT0FBTzlCLFVBQVVDLElBQUksaUJBQzFCdEMsS0FBS3lFLHFCQUdUQSxxQkFDSUMsT0FBT3hFLGlCQUFpQixVQUFXRixLQUFLb0UsaUJBRzVDRyxRQUNJdkUsS0FBS21FLE9BQU85QixVQUFVSixPQUFPLGlCQUM3QmpDLEtBQUsyRSx3QkFHVEEsd0JBQ0lELE9BQU9FLG9CQUFvQixVQUFXNUUsS0FBS29FLGlCQUcvQ1Msb0JBRVE3RSxLQUFLbUUsT0FBT2pFLGlCQUFpQixhQUFjNkQsS0FDbkNBLEVBQUllLE9BQU9DLFFBQVEsV0FBYWhCLEVBQUllLE9BQU9DLFFBQVEsbUJBQ25EL0UsS0FBS3VFLFlDaENsQixNQUFNUyxVQUFzQmYsRUFDL0J4RSxZQUFZd0YsRUFBY0MsR0FDdEJDLE1BQU1GLEdBRU5qRixLQUFLb0YsZUFBaUJGLEVBQ3RCbEYsS0FBS3FGLE1BQVFyRixLQUFLbUUsT0FBTzlGLGNBQWMsZ0JBRXZDMkIsS0FBS3NGLGNBQWdCdEYsS0FBS3FGLE1BQU1oSCxjQUFjLGdCQUM5QzJCLEtBQUt1RixtQkFBcUJ2RixLQUFLc0YsY0FBY3ZFLFlBQzdDZixLQUFLd0YsUUFBVSxJQUFJeEYsS0FBS3FGLE1BQU1qSCxpQkFBaUIsa0JBR25EcUgsa0JBQ0ksTUFBTUMsRUFBUyxHQVNmLE9BUEExRixLQUFLd0YsUUFBUTlCLFNBQVNpQyxJQUNsQixNQUFNckIsRUFBTXFCLEVBQU1sRSxLQUNabUUsRUFBUUQsRUFBTUMsTUFFcEJGLEVBQU9wQixHQUFPc0IsS0FHWEYsRUFHWGIsb0JBQ0lNLE1BQU1OLG9CQUNON0UsS0FBS3FGLE1BQU1uRixpQkFBaUIsVUFBVzJGLElBQ25DQSxFQUFFN0IsaUJBQ0ZoRSxLQUFLb0YsZUFBZXBGLEtBQUt5RixzQkFLakNLLG9CQUFvQkMsR0FDaEIvRixLQUFLb0YsZUFBaUJXLEVBaUIxQkMsV0FBV0MsR0FDUGpHLEtBQUtzRixjQUFjdkUsWUFBY2tGLEVBR3JDMUIsUUFDSVksTUFBTVosUUFDTnZFLEtBQUtxRixNQUFNYSxTQ2lDUixNQUFNQyxFQUFNLElBN0Z2QixNQUNJMUcsWUFBWTJHLEcsVUFLTUMsR0FDbEJBLEVBQUlDLEdBQUtELEVBQUlFLE9BQVNDLFFBQVFDLE9BQU9KLEVBQUlLLGEsRUFOcEIseUIsc0JBQUEsSyx1REFBQSxLLEtBQ25CMUcsS0FBSzJHLFNBQVdQLEVBQVFRLFFBQ3hCNUcsS0FBSzZHLFNBQVdULEVBQVFVLFFBTTFCQyxjQUNJLE9BQU9DLE1BQU1oSCxLQUFLMkcsU0FBVyxZQUFhLENBQ3hDRyxRQUFTOUcsS0FBSzZHLFdBRWZJLEtBQUtqSCxLQUFLa0gsZ0JBR2ZDLFdBQ0ksT0FBT0gsTUFBTWhILEtBQUsyRyxTQUFXLFNBQVUsQ0FDckNHLFFBQVM5RyxLQUFLNkcsV0FFZkksS0FBS2pILEtBQUtrSCxnQkFHZkUsWUFBWTNGLEVBQU00RixHQUNkLE9BQU9MLE1BQU1oSCxLQUFLMkcsU0FBVyxZQUFhLENBQ3RDVyxPQUFRLFFBQ1JSLFFBQVM5RyxLQUFLNkcsU0FDZFUsS0FBTUMsS0FBS0MsVUFBVSxDQUNqQmhHLE9BQ0E0RixZQUdQSixLQUFLakgsS0FBS2tILGdCQUdmUSxXQUFXNUksR0FDUCxPQUFPa0ksTUFBTWhILEtBQUsyRyxTQUFXLG1CQUFvQixDQUM3Q1csT0FBUSxRQUNSUixRQUFTOUcsS0FBSzZHLFNBQ2RVLEtBQU1DLEtBQUtDLFVBQVUsQ0FDakIzSSxhQUdQbUksS0FBS2pILEtBQUtrSCxnQkFHZlMsUUFBUWxHLEVBQU1DLEdBQ1YsT0FBT3NGLE1BQU1oSCxLQUFLMkcsU0FBVyxTQUFVLENBQ25DVyxPQUFRLE9BQ1JSLFFBQVM5RyxLQUFLNkcsU0FDZFUsS0FBTUMsS0FBS0MsVUFBVSxDQUNqQmhHLE9BQ0FDLFdBR1B1RixLQUFLakgsS0FBS2tILGdCQUdmVSxRQUFROUUsR0FDSixPQUFPa0UsTUFBTWhILEtBQUsyRyxTQUFXLGdCQUFrQjdELEVBQUksQ0FDL0N3RSxPQUFRLE1BQ1JSLFFBQVM5RyxLQUFLNkcsV0FFakJJLEtBQUtqSCxLQUFLa0gsZ0JBR2ZXLFdBQVcvRSxHQUNQLE9BQU9rRSxNQUFNaEgsS0FBSzJHLFNBQVcsZ0JBQWtCN0QsRUFBSSxDQUMvQ3dFLE9BQVEsU0FDUlIsUUFBUzlHLEtBQUs2RyxXQUVqQkksS0FBS2pILEtBQUtrSCxnQkFHZlcsV0FBVy9FLEdBQ1QsT0FBT2tFLE1BQU1oSCxLQUFLMkcsU0FBVyxnQkFBa0I3RCxFQUFJLENBQy9Dd0UsT0FBUSxTQUNSUixRQUFTOUcsS0FBSzZHLFdBRWpCSSxLQUFLakgsS0FBS2tILGdCQUdiWSxXQUFXaEYsR0FDVCxPQUFPa0UsTUFBTWhILEtBQUsyRyxTQUFXLFVBQVk3RCxFQUFJLENBQ3pDd0UsT0FBUSxTQUNSUixRQUFTOUcsS0FBSzZHLFdBRWpCSSxLQUFLakgsS0FBS2tILGtCQU1jLENBQzNCTixRQUFTLGlEQUNURSxRQUFTLENBQ1BpQixjQUFlLHVDQUNmLGVBQWdCLHNCQ3BGaEJDLEVBQVcsSUNiVixNQUNIdkksWUFBWSxHQUE4QyxJQUE3QyxhQUFDd0ksRUFBRCxZQUFlQyxFQUFmLGVBQTRCQyxHQUFpQixFQUN0RG5JLEtBQUtvSSxVQUFZakssU0FBU0UsY0FBYzRKLEdBQ3hDakksS0FBS3FJLGlCQUFtQmxLLFNBQVNFLGNBQWM2SixHQUMvQ2xJLEtBQUtzSSxXQUFhbkssU0FBU0UsY0FBYzhKLEdBSTdDcEIsY0FDSSxNQUFPLENBQ1B0RixLQUFNekIsS0FBS29JLFVBQVVySCxZQUNyQndILFlBQWF2SSxLQUFLcUksaUJBQWlCdEgsYUFJdkN5SCxZQUFZL0csRUFBTThHLEVBQWF6SixHQUMzQmtCLEtBQUtvSSxVQUFVckgsWUFBY1UsRUFDN0J6QixLQUFLcUksaUJBQWlCdEgsWUFBY3dILEVBSXhDRSxjQUFjM0osR0FDVmtCLEtBQUtzSSxXQUFXdEgsSUFBTWxDLElEVEEsQ0FDMUJtSixhQUFjLGtCQUNkQyxZQUFhLHdCQUNiQyxlQUFnQixvQkFJcEIsSUFBSXhJLEVBRUo2RyxRQUFRa0MsSUFBSSxDQUFDdkMsRUFBSVksY0FBZVosRUFBSWdCLGFBQy9CRixNQUFLLElBQXVCLElBQXJCMEIsRUFBVUMsR0FBVyxFQUN6QmpKLEVBQVNnSixFQUFTL0csSUFFbEJvRyxFQUFTUSxZQUFZRyxFQUFTbEgsS0FBTWtILEVBQVN0QixNQUFPc0IsRUFBUzdKLFFBQzdEK0osRUFBUUMsWUFBWUYsTUFFdkJHLE1BQU1DLFFBQVFDLEtBSW5CLE1BQU1DLEVBQW9CLElBQUlDLEVBQWNsSyxFQUFVUCxHQUNoRDBLLEVBQXVCLElBQUlELEVBQWNsSyxFQUFVRixHQUNuRHNLLEVBQTRCLElBQUlGLEVBQWNsSyxFQUFVSixHQUU5RHFLLEVBQWtCcEYsbUJBQ2xCc0YsRUFBcUJ0RixtQkFDckJ1RixFQUEwQnZGLG1CQUcxQixNQXVETXdGLEVBQWUsSUFBSXRFLEVBQWMsd0JBdkRWdEYsSUFDekI0SixFQUFhdEQsV0FBVyxhQUN4QkcsRUFBSXdCLFFBQVFqSSxFQUFLLGNBQWVBLEVBQUssY0FDcEN1SCxNQUFLWixJQUNGa0QsRUFBV2xELEVBQ0wvSCxNQUdMMkksTUFBSyxLQUNGcUMsRUFBYS9FLFdBRXBCd0UsT0FBT1MsSUFDSlIsUUFBUUMsSUFBSU8sTUFFZkMsU0FBUSxLQUNMSCxFQUFhdEQsV0FBVyxnQkF5Q2hDc0QsRUFBYXpFLG9CQUViLE1BQU02RSxFQUFvQixJQUFJMUUsRUFBYyw2QkFyQmhCdEYsSUFDeEJnSyxFQUFrQjFELFdBQVcsYUFDN0JHLEVBQUl1QixXQUFXaEksRUFBSyxjQUNuQnVILE1BQUtaLElBQ0YyQixFQUFTUyxjQUFjcEMsRUFBSXZILFdBRTlCbUksTUFBSyxLQUNGeUMsRUFBa0JuRixXQUVyQndFLE9BQU9TLElBQ0pSLFFBQVFDLElBQUlPLE1BRWZDLFNBQVEsS0FDTEMsRUFBa0IxRCxXQUFXLGNBU3JDMEQsRUFBa0I3RSxvQkFFbEIsTUFBTThFLEVBQWtCLElBQUkzRSxFQUFjLDhCQUMxQzJFLEVBQWdCOUUsb0JBRWhCLE1BQU0rRSxFQUFtQixJQUFJNUUsRUFBYyw0QkE3Q1Z0RixJQUNqQ2tLLEVBQWlCNUQsV0FBVyxhQUN4QkcsRUFBSWlCLFlBQVkxSCxFQUFLbUssS0FBTW5LLEVBQUs2SSxhQUMvQnRCLE1BQUtaLElBQ0YyQixFQUFTUSxZQUFZbkMsRUFBSTVFLEtBQU00RSxFQUFJZ0IsTUFBT2hCLEVBQUl2SCxXQUVqRG1JLE1BQUssS0FDRjJDLEVBQWlCckYsV0FFcEJ3RSxPQUFPUyxJQUNKUixRQUFRQyxJQUFJTyxNQUVmQyxTQUFRLEtBQ0xHLEVBQWlCNUQsV0FBVyxjQWlDcEM0RCxFQUFpQi9FLG9CQUVqQixNQUFNaUYsRUFBYSxJRTNHWixjQUE2QjdGLEVBQ2hDeEUsWUFBWXlFLEdBQ1JpQixNQUFNakIsR0FFVmxFLEtBQUsrSixTQUFXL0osS0FBS21FLE9BQU85RixjQUFjLG9CQUMxQzJCLEtBQUtnSyxPQUFTaEssS0FBS21FLE9BQU85RixjQUFjLGlCQUd4Q21HLEtBQUsvQyxFQUFNQyxHQUNQeUQsTUFBTVgsT0FFTnhFLEtBQUsrSixTQUFTaEosWUFBY1UsRUFDNUJ6QixLQUFLZ0ssT0FBT2hKLElBQU1VLEVBQ2xCMUIsS0FBS2dLLE9BQU8vSSxJQUFaLG9CQUFnQ1EsS0Y4RkYsdUJBQ3RDcUksRUFBV2pGLG9CQUVYLE1BMEJNOUUsRUFBcUJrSyxJQUN2Qk4sRUFBZ0JuRixPQUdoQm1GLEVBQWdCN0QscUJBQW9CLEtBQ2hDNkQsRUFBZ0IzRCxXQUFXLGVBQzNCRyxFQUFJMkIsV0FBV21DLEVBQUtsSSxTQUNqQmtGLE1BQUssS0FDSmdELEVBQUtqSSxnQkFFTGlGLE1BQUssS0FDTDBDLEVBQWdCcEYsV0FFaEJ3RSxPQUFPUyxJQUNQUixRQUFRQyxJQUFJTyxNQUVmQyxTQUFRLEtBQ0xFLEVBQWdCM0QsV0FBVyxjQUtqQ3VELEVBQWM3SixJQUNoQixNQUFNdUssRUFBTyxJQUFJekssRUFBSyxDQUNsQkUsT0FDQUMsU0FDQUMscUJBcERxQixpQkFxRHJCQyxnQkFBaUIsSUFuREFILEtBQ3JCb0ssRUFBV3RGLEtBQUs5RSxFQUFLK0IsS0FBTS9CLEVBQUtnQyxPQWtETDdCLENBQWdCSCxHQUN2Q0ksbUJBQW9CLElBaERBbUssS0FDckJBLEVBQUs3SCxVQUNKK0QsRUFBSTBCLFdBQVdvQyxFQUFLbEksU0FDcEJrRixNQUFLWixJQUNMNEQsRUFBSzlJLFNBQVNrRixFQUFJMUUsVUFFakJvSCxPQUFPUyxJQUNKUixRQUFRQyxJQUFJTyxNQUdoQnJELEVBQUl5QixRQUFRcUMsRUFBS2xJLFNBQ2pCa0YsTUFBS1osSUFDTDRELEVBQUs5SSxTQUFTa0YsRUFBSTFFLFVBRWpCb0gsT0FBT1MsSUFDSlIsUUFBUUMsSUFBSU8sT0FpQ1UxSixDQUFtQm1LLEdBQzdDbEssa0JBQW1CQSxJQUd2QjhJLEVBQVFxQixRQUFRRCxFQUFLRSxtQkFHbkJ0QixFQUFVLElHN0tULE1BQ0hwSixZQUFZLEVBQWEySyxHQUFtQixJQUFoQyxTQUFFQyxHQUE4QixFQUN4Q3JLLEtBQUtzSyxVQUFZRCxFQUNqQnJLLEtBQUt1SyxXQUFhcE0sU0FBU0UsY0FBYytMLEdBRzdDdEIsWUFBWTBCLEdBQ1JBLEVBQU05RyxTQUFTaEUsSUFDWE0sS0FBS3NLLFVBQVU1SyxNQUl2QndLLFFBQVFPLEdBQ0p6SyxLQUFLdUssV0FBV0csUUFBUUQsS0hpSzVCLENBQ0lKLFNBQVVkLEdBQ1gsYUE2QlBoTCxFQUFrQjJCLGlCQUFpQixTQW5CbkMsWUFOQSxXQUNJLE1BQU15SyxFQUFjM0MsRUFBU2pCLGNBQzdCcEksRUFBZWlILE1BQVErRSxFQUFZbEosS0FDbkM3QyxFQUFzQmdILE1BQVErRSxFQUFZcEMsWUFJMUNxQyxHQUNBaEIsRUFBaUJwRixVQW1CckIvRixFQUFpQnlCLGlCQUFpQixTQWZsQyxXQUNJa0osRUFBcUI1RixnQkFDckI4RixFQUFhOUUsVUFlakIxRixFQUFPb0IsaUJBQWlCLFNBWHhCLFdBQ0ltSixFQUEwQjdGLGdCQUMxQmtHLEVBQWtCbEYsVSIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGdcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcclxuICAgIH0sXHJcbl07XHJcblxyXG5leHBvcnQgY29uc3QgcG9wdXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cFwiKTtcclxuZXhwb3J0IGNvbnN0IGZvcm1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBlbGVtZW50TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNcIik7XHJcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudFxyXG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKVxyXG4gICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50XCIpO1xyXG5cclxuLy9wcm9maWxlIG1vZGVsIGJ1dHRvbnNcclxuZXhwb3J0IGNvbnN0IGVkaXRCdXR0b25Qcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZEJ1dHRvblByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcblxyXG4vL3BvcHVwIGVkaXQgcHJvZmlsZVxyXG5leHBvcnQgY29uc3QgcG9wdXBFZGl0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGVcIik7XHJcblxyXG4vL3BvcHVwIGVkaXQgcHJvZmlsZSBpbnB1dHNcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW5wdXROYW1lID0gcG9wdXBFZGl0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgXCIucG9wdXBfX2lucHV0X3R5cGVfbmFtZVwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwb3B1cElucHV0RGVzY3JpcHRpb24gPSBwb3B1cEVkaXRQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICBcIi5wb3B1cF9faW5wdXRfdHlwZV9kZXNjcmlwdGlvblwiXHJcbik7XHJcblxyXG5leHBvcnQgY29uc3QgcG9wdXBDaGFuZ2VBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfYXZhdGFyLWNoYW5nZVwiKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcblxyXG4vL2V4cG9ydCBjb25zdCBwb3B1cERlbGV0ZUNhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfYXZhdGFyLWNoYW5nZVwiKTtcclxuLy9leHBvcnQgY29uc3QgZGVsZXRlQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3NhdmVfdHlwZV9hZGQtY2FyZFwiKTtcclxuXHJcblxyXG4vL3BvcHVwIGFkZCBjYXJkXHJcbmV4cG9ydCBjb25zdCBwb3B1cEFkZENhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfYWRkLWNhcmRcIik7XHJcblxyXG4vL2ltYWdlIHByZXZpZXdcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW1hZ2VQcmV2aWV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlLXByZXZpZXdcIik7XHJcbmV4cG9ydCBjb25zdCBwb3B1cEltYWdlID0gcG9wdXBJbWFnZVByZXZpZXcucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XHJcbmV4cG9ydCBjb25zdCBwb3B1cFRpdGxlID0gcG9wdXBJbWFnZVByZXZpZXcucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc3VidGl0bGVcIik7XHJcblxyXG5leHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fc2F2ZVwiLFxyXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fc2F2ZV9kaXNhYmxlZFwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXHJcbn1cclxuXHJcbiIsImV4cG9ydCBjbGFzcyBDYXJkIHtcclxuICAgIGNvbnN0cnVjdG9yKHtkYXRhLCB1c2VySWQsIHRlbXBsYXRlQ2FyZFNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2ssIGFjdGl2YXRlTGlrZUJ1dHRvbiwgaGFuZGxlRGVsZXRlQ2xpY2t9KSB7IC8ve3RleHQsbGlua31cclxuICAgICAgICB0aGlzLl90ZXh0ID0gZGF0YS5uYW1lOyBcclxuICAgICAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgICAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuICAgICAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWRcclxuXHJcbiAgICAgICAgdGhpcy5fdGVtcGxhdGVDYXJkU2VsZWN0b3IgPSB0ZW1wbGF0ZUNhcmRTZWxlY3RvclxyXG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGlja1xyXG4gICAgICAgIHRoaXMuX2FjdGl2YXRlTGlrZUJ1dHRvbiA9IGFjdGl2YXRlTGlrZUJ1dHRvblxyXG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2tcclxuXHJcbiAgICAgICAgdGhpcy5fY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0ZW1wbGF0ZUNhcmRTZWxlY3RvcilcclxuICAgICAgICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50XCIpO1xyXG4gICAgICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICAvL19hY3RpdmF0ZUxpa2VCdXR0b24gPSBldnQgPT4gZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiZWxlbWVudF9fYnV0dG9uLWxpa2VfYWN0aXZlXCIpO1xyXG5cclxuICAgIGdldElkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pZFxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fY2FyZC5yZW1vdmUoKTtcclxuICAgICAgICB0aGlzLl9jYXJkID0gbnVsbDsvL1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5fYWN0aXZhdGVMaWtlQnV0dG9uKCkpO1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcykpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX3RleHQsIHRoaXMuX2xpbmspKTsvLyh0aGlzLmRhdGEpXHJcbiAgICB9XHJcblxyXG4gICAgc2V0TGlrZXMobmV3TGlrZXMpIHtcclxuICAgICAgICB0aGlzLl9saWtlcyA9IG5ld0xpa2VzXHJcblxyXG4gICAgICAgIHRoaXMuX2xpa2VzQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgLy8gY29uc3QgbGlrZUNvdW50ZXIgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICAgICAgLy8gdGhpcy5fbGlrZXNDb3VudGVyLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fbGlrZXMtY291bnRcIikudGV4dENvbnRlbnQgPSBsaWtlQ291bnRlcjtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBjYXJkSXNMaWtlZEJ5VXNlciA9IHRoaXMuaXNMaWtlZCgpXHJcblxyXG4gICAgICAgIGlmIChjYXJkSXNMaWtlZEJ5VXNlcikge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJlbGVtZW50X19idXR0b24tbGlrZV9hY3RpdmVcIik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiZWxlbWVudF9fYnV0dG9uLWxpa2VfYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpc0xpa2VkKCkge1xyXG4gICAgICAgcmV0dXJuIHRoaXMuX2xpa2VzLmZpbmQodXNlciA9PiB1c2VyLl9pZCA9PT0gdGhpcy5fdXNlcklkKSBcclxuICAgIH1cclxuXHJcbiAgICBnZXRDYXJkRWxlbWVudCA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jYXJkID0gdGhpcy5fY2FyZFRlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19idXR0b24tbGlrZVwiKTtcclxuICAgICAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fYnV0dG9uLWRlbGV0ZVwiKTtcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9faW1hZ2VcIik7XHJcbiAgICAgICAgY29uc3QgY2FyZFRpdGxlID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3RpdGxlXCIpO1xyXG5cclxuICAgICAgIHRoaXMuX2xpa2VzQ291bnRlciA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saWtlcy1jb3VudFwiKTtcclxuXHJcbiAgICAgICAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fdGV4dDtcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fdGV4dDtcclxuICAgICAgICAgICAgIFxyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0TGlrZXModGhpcy5fbGlrZXMpXHJcblxyXG4gICAgICAgIGlmKHRoaXMuX3VzZXJJZCAhPT0gdGhpcy5fb3duZXJJZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9kZWxldGVCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXHJcbiAgICAgICAgfVxyXG4gICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZDtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3NcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gWy4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvcildO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIGVycm9yQ2xhc3N9ID0gdGhpcy5fc2V0dGluZ3M7XHJcblxyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChpbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChlcnJvckNsYXNzKTtcclxuICAgIH07XHJcbiAgICAgIFxyXG4gICAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzfSA9IHRoaXMuX3NldHRpbmdzO1xyXG5cclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yQ2xhc3MpO1xyXG4gICAgfTtcclxuXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGlmIChpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgdGhpcy5fc2V0dGluZ3MpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgX2hhc0ludmFsaWRJbnB1dCA9ICgpID0+IHRoaXMuX2lucHV0TGlzdC5ldmVyeShpbnB1dEVsZW1lbnQgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcclxuXHJcbiAgICBcclxuICAgIGRpc2FibGVCdXR0b24oKSB7XHJcbiAgICAgICAgY29uc3QgeyBpbmFjdGl2ZUJ1dHRvbkNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgICAgIGNvbnN0IHsgaW5hY3RpdmVCdXR0b25DbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShpbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgfVxyXG5cclxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlID0gKCkgPT4ge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICAgICAgICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcclxuICAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyBpbnB1dFNlbGVjdG9yIH0gPSB0aGlzLl9zZXR0aW5nc1xyXG4gICAgICAgIC8vY29uc3QgYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgICAgIFxyXG4gICAgICBcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7IC8vdG9nZ2xlIHN1Ym1pdFxyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTsgLy9jaGVjayB2YWxpZGl0eVxyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7IC8vdG9nZ2xlIHN1Ym1pdFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvLyByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICAvLyAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7IFxyXG5cclxuICAgIC8vICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgLy8gICAgIHRoaXMuX2hpZGVFcnJvcihpbnB1dEVsZW1lbnQpIFxyXG4gICAgLy8gICB9KTtcclxuXHJcbiAgICAvLyB9XHJcblxyXG4gICAgLy8gcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgLy8gICAgIHRoaXMuaW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4ge1xyXG4gICAgLy8gICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dClcclxuICAgIC8vICAgICB9KVxyXG4gICAgLy8gfVxyXG5cclxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgICAgfTtcclxuICAgIFxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvciIsImV4cG9ydCBjbGFzcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpXHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpXHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgIHRoaXMuY2xvc2UoKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9fb3BlbmVkXCIpO1xyXG4gICAgICAgIHRoaXMuYWRkS2V5RG93bkxpc3RlbmVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkS2V5RG93bkxpc3RlbmVyKCkge1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX19vcGVuZWRcIik7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVLZXlEb3duTGlzdGVuZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVLZXlEb3duTGlzdGVuZXIoKSB7XHJcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQubWF0Y2hlcyhcIi5wb3B1cFwiKSB8fCBldnQudGFyZ2V0Lm1hdGNoZXMoXCIucG9wdXBfX2Nsb3NlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgIFxyXG4gICAgfVxyXG4gICBcclxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3VwU2VsZWN0b3IsIGhhbmRsZXJTdWJtaXQpIHtcclxuICAgICAgICBzdXBlcihwb3VwU2VsZWN0b3IpXHJcblxyXG4gICAgICAgIHRoaXMuX2hhbmRsZXJTdWJtaXQgPSBoYW5kbGVyU3VibWl0XHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIilcclxuICAgIFxyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc2F2ZVwiKVxyXG4gICAgICAgIHRoaXMuX2luaXRpYWxCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50XHJcbiAgICAgICAgdGhpcy5faW5wdXRzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIildXHJcbiAgICB9XHJcblxyXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHt9XHJcblxyXG4gICAgICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBrZXkgPSBpbnB1dC5uYW1lXHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gaW5wdXQudmFsdWVcclxuICAgICAgICBcclxuICAgICAgICAgICAgdmFsdWVzW2tleV0gPSB2YWx1ZVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHJldHVybiB2YWx1ZXNcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpXHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVyU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICAgICAgICAvL3RoaXMuY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNoYW5nZVN1Ym1pdEhhbmRsZXIobmV3U3VibWl0SGFuZGxlcikge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZXJTdWJtaXQgPSBuZXdTdWJtaXRIYW5kbGVyO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGNoYW5nZVRleHQodGV4dFR5cGUpIHsvLyBpbml0YWwgTG9hZGluZ1xyXG4gICAgLy8gICAgIC8vY29uc3QgYnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zYXZlXCIpXHJcbiAgICAgICAgXHJcbiAgICAvLyAgICAgLy9idXR0b24udGV4dENvbnRlbnQgPSB0ZXh0XHJcblxyXG4gICAgLy8gICAgIGlmKHRleHRUeXBlID09PSBcInNhdmluZ1wiKSB7XHJcbiAgICAvLyAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCJcclxuICAgIC8vICAgICB9XHJcblxyXG4gICAgLy8gICAgIGlmKHRleHRUeXBlID09PSBcImluaXRpYWxcIikge1xyXG4gICAgLy8gICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9pbml0aWFsQnV0dG9uVGV4dFxyXG4gICAgLy8gICAgIH1cclxuICAgIC8vIH1cclxuICAgIFxyXG4gICAgY2hhbmdlVGV4dCh0ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGV4dFxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHN1cGVyLmNsb3NlKClcclxuICAgICAgICB0aGlzLl9mb3JtLnJlc2V0KClcclxuICAgIH1cclxufSIsImNsYXNzIEFwaSB7XHJcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmxcclxuICAgICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVyc1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja1Jlc3BvbnNlID0gKHJlcykgPT5cclxuICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzVGV4dCk7XHJcbiAgXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL3VzZXJzL21lXCIsIHtcclxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgIGdldENhcmRzKCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHNcIiwge1xyXG4gICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICBlZGl0UHJvZmlsZShuYW1lLCBhYm91dCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvdXNlcnMvbWVcIiwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgICAgIGFib3V0XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgICB9XHJcblxyXG4gICAgZWRpdEF2YXRhcihhdmF0YXIpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL3VzZXJzL21lL2F2YXRhclwiLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBhdmF0YXJcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICAgIH0gIFxyXG5cclxuICAgIGFkZENhcmQobmFtZSwgbGluaykge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHNcIiwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICAgICAgbGluayxcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICBhZGRMaWtlKGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9saWtlcy9cIiArIGlkLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgICB9XHJcblxyXG4gICAgcmVtb3ZlTGlrZShpZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHMvbGlrZXMvXCIgKyBpZCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICAgICAgfVxyXG5cclxuICAgIHJlbW92ZUxpa2UoaWQpIHtcclxuICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9saWtlcy9cIiArIGlkLCB7XHJcbiAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQoaWQpIHtcclxuICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9cIiArIGlkLCB7XHJcbiAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgICBcclxuICAgIH1cclxuXHJcbiAgfVxyXG4gIFxyXG4gICAgZXhwb3J0IGNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gICAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC0zLWVuXCIsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgIGF1dGhvcml6YXRpb246IFwiNGNkYWUzMTQtN2U4YS00YmVkLThhZGEtNzBhZDMzYzEyZTEzXCIsXHJcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICB9XHJcbiAgfSk7IiwiaW1wb3J0IFwiLi8uLi9wYWdlcy9pbmRleC5jc3NcIjtcbmltcG9ydCBcIi4vLi4vZm9udHMvZm9udC5jc3NcIjtcbmltcG9ydCB7IGVsZW1lbnRMaXN0LCBlZGl0QnV0dG9uUHJvZmlsZSwgYWRkQnV0dG9uUHJvZmlsZSwgcG9wdXBFZGl0UHJvZmlsZSwgcG9wdXBJbnB1dE5hbWUsIHBvcHVwSW5wdXREZXNjcmlwdGlvbiwgcG9wdXBBZGRDYXJkLCBzZXR0aW5ncywgcG9wdXBDaGFuZ2VBdmF0YXIsIGF2YXRhciwgcG9wdXBEZWxldGVDYXJkfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCJcbmltcG9ydCB7IENhcmR9IGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIlxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIlxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiXG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiXG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCJcblxuaW1wb3J0IHsgYXBpfSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCJcblxuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gICAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLCBcbiAgICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIlxufSlcblxuXG5sZXQgdXNlcklkXG5cblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldENhcmRzKCldKVxuICAgIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xuICAgICAgICB1c2VySWQgPSB1c2VyRGF0YS5faWRcblxuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCB1c2VyRGF0YS5hYm91dCwgdXNlckRhdGEuYXZhdGFyKVxuICAgICAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzKVxufSlcbiAgICAuY2F0Y2goY29uc29sZS5sb2cpXG5cblxuLy8gdmFsaWRhdG9ycyAgICBcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIHBvcHVwRWRpdFByb2ZpbGUpXG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBwb3B1cEFkZENhcmQpXG5jb25zdCBjaGFuZ2VBdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIHBvcHVwQ2hhbmdlQXZhdGFyKVxuXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hZGRDYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5jaGFuZ2VBdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuLy8gc3VibWl0IGhhbmRsZXJzIG9mIG1vZGFsc1xuY29uc3QgaGFuZGxlQWRkQ2FyZFN1Ym1pdCA9IChkYXRhKSA9PiB7XG4gICAgYWRkQ2FyZFBvcHVwLmNoYW5nZVRleHQoXCJzYXZpbmcuLi5cIikgIFxuICAgIGFwaS5hZGRDYXJkKGRhdGFbXCJjYXJkLXRpdGxlXCJdLCBkYXRhW1wiY2FyZC1saW5rXCJdKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJlbmRlckNhcmQocmVzLCAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgZWxlbWVudExpc3RcbiAgICAgICAgICApO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKVxuICAgICAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+e1xuICAgICAgICBhZGRDYXJkUG9wdXAuY2hhbmdlVGV4dChcIkNyZWF0ZVwiKVxuICAgIH0pICAgIFxufVxuXG5jb25zdCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCA9IChkYXRhKSA9PiB7XG5lZGl0UHJvZmlsZVBvcHVwLmNoYW5nZVRleHQoXCJzYXZpbmcuLi5cIilcbiAgICBhcGkuZWRpdFByb2ZpbGUoZGF0YS5OYW1lLCBkYXRhLmRlc2NyaXB0aW9uKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcy5uYW1lLCByZXMuYWJvdXQsIHJlcy5hdmF0YXIpXG4gICAgfSlcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKVxuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT57XG4gICAgICAgIGVkaXRQcm9maWxlUG9wdXAuY2hhbmdlVGV4dChcIlNhdmVcIilcbiAgICB9KVxufVxuXG5cbmNvbnN0IGhhbmRsZUF2YXRhclN1Ym1pdCA9IChkYXRhKSA9PiB7XG4gICAgYXZhdGFyQ2hhbmdlUG9wdXAuY2hhbmdlVGV4dChcInNhdmluZy4uLlwiKVxuICAgIGFwaS5lZGl0QXZhdGFyKGRhdGFbXCJjYXJkLWxpbmtcIl0pXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMuYXZhdGFyKVxuICAgIH0pXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBhdmF0YXJDaGFuZ2VQb3B1cC5jbG9zZSgpXG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSlcbiAgICAuZmluYWxseSgoKSA9PntcbiAgICAgICAgYXZhdGFyQ2hhbmdlUG9wdXAuY2hhbmdlVGV4dChcIlNhdmVcIilcbiAgICB9KVxufVxuXG4vLyBpbnN0YW5jZXMgb2YgbW9kYWxzXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF90eXBlX2FkZC1jYXJkXCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpXG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKVxuXG5jb25zdCBhdmF0YXJDaGFuZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfYXZhdGFyLWNoYW5nZVwiLCBoYW5kbGVBdmF0YXJTdWJtaXQpXG5hdmF0YXJDaGFuZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfY29uZmlybS1kZWxldGVcIilcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZVwiLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdClcbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKVxuXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLnBvcHVwX3R5cGUtcHJldmlld1wiKVxuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IHRlbXBsYXRlQ2FyZFNlbGVjdG9yID0gXCIjY2FyZC10ZW1wbGF0ZVwiXG5cbmNvbnN0IGhhbmRsZUNhcmRDbGljayA9IChkYXRhKSA9PiB7XG4gICAgaW1hZ2VQb3B1cC5vcGVuKGRhdGEubmFtZSwgZGF0YS5saW5rKVxufVxuXG5jb25zdCBhY3RpdmF0ZUxpa2VCdXR0b24gPSAoY2FyZCkgPT4ge1xuICAgIGlmKGNhcmQuaXNMaWtlZCgpKSB7XG4gICAgICAgIGFwaS5yZW1vdmVMaWtlKGNhcmQuZ2V0SWQoKSlcbiAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcylcbiAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGFwaS5hZGRMaWtlKGNhcmQuZ2V0SWQoKSlcbiAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcylcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgfSlcbiAgICB9XG59ICAgICBcblxuY29uc3QgaGFuZGxlRGVsZXRlQ2xpY2sgPSAoY2FyZCkgPT4ge1xuICAgIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKClcbiAgICAvL2RlbGV0ZUNhcmRQb3B1cC5yZXNldFZhbGlkYXRpb24oKVxuXG4gICAgZGVsZXRlQ2FyZFBvcHVwLmNoYW5nZVN1Ym1pdEhhbmRsZXIoKCkgPT4ge1xuICAgICAgICBkZWxldGVDYXJkUG9wdXAuY2hhbmdlVGV4dChcImRlbGV0aW5nLi4uXCIpXG4gICAgICAgIGFwaS5kZWxldGVDYXJkKGNhcmQuZ2V0SWQoKSlcbiAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBjYXJkLnJlbW92ZUNhcmQoKVxuICAgICAgICAgICB9KVxuICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBkZWxldGVDYXJkUG9wdXAuY2xvc2UoKVxuICAgICAgICAgICB9KVxuICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICB9KVxuICAgICAgICAuZmluYWxseSgoKSA9PntcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jaGFuZ2VUZXh0KFwiWWVzXCIpXG4gICAgICAgIH0pXG4gIH0pXG59XG5cbmNvbnN0IHJlbmRlckNhcmQgPSAoZGF0YSkgPT4ge1xuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZCh7XG4gICAgICAgIGRhdGEsXG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgdGVtcGxhdGVDYXJkU2VsZWN0b3IsXG4gICAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4gaGFuZGxlQ2FyZENsaWNrKGRhdGEpLCBcbiAgICAgICAgYWN0aXZhdGVMaWtlQnV0dG9uOiAoKSA9PiBhY3RpdmF0ZUxpa2VCdXR0b24oY2FyZCksXG4gICAgICAgIGhhbmRsZURlbGV0ZUNsaWNrOiBoYW5kbGVEZWxldGVDbGlja1xuICAgIH1cbiAgICApICAgIFxuICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkLmdldENhcmRFbGVtZW50KCkpO1xufVxuXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAgeyAgXG4gICAgICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkIFxuICAgIH0sIFwiLmVsZW1lbnRzXCJcbiAgICApXG5cblxuZnVuY3Rpb24gZmlsbFByb2ZpbGVGb3JtKCkge1xuICAgIGNvbnN0IHByb2ZpbGVEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKVxuICAgIHBvcHVwSW5wdXROYW1lLnZhbHVlID0gcHJvZmlsZURhdGEubmFtZTtcbiAgICBwb3B1cElucHV0RGVzY3JpcHRpb24udmFsdWUgPSBwcm9maWxlRGF0YS5kZXNjcmlwdGlvbjtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRWRpdEJ1dHRvbkNsaWNrKCkge1xuICAgIGZpbGxQcm9maWxlRm9ybSgpO1xuICAgIGVkaXRQcm9maWxlUG9wdXAub3BlbigpXG4gICAgLy9lZGl0UHJvZmlsZVBvcHVwLnJlc2V0VmFsaWRhdGlvbigpXG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZEJ1dHRvbkNsaWNrKCkge1xuICAgIGFkZENhcmRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKVxuICAgIGFkZENhcmRQb3B1cC5vcGVuKClcbiAgICAvL2FkZENhcmRQb3B1cC5yZXNldFZhbGlkYXRpb24oKVxufVxuXG5mdW5jdGlvbiBoYW5kbGVDaGFuZ2VBdmF0YXJDbGljaygpIHtcbiAgICBjaGFuZ2VBdmF0YXJGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKVxuICAgIGF2YXRhckNoYW5nZVBvcHVwLm9wZW4oKVxuICAgIC8vYXZhdGFyQ2hhbmdlUG9wdXAucmVzZXRWYWxpZGF0aW9uKClcbn1cblxuXG5lZGl0QnV0dG9uUHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlRWRpdEJ1dHRvbkNsaWNrKTtcblxuYWRkQnV0dG9uUHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQWRkQnV0dG9uQ2xpY2spO1xuXG5hdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNoYW5nZUF2YXRhckNsaWNrKTsiLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoIHtuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcn0pIHtcclxuICAgICAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKVxyXG4gICAgICAgIHRoaXMuX3VzZXJEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpXHJcbiAgICAgICAgdGhpcy5fYXZhdGFyUGljID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3RvcilcclxuICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgbmFtZTogdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuX3VzZXJEZXNjcmlwdGlvbi50ZXh0Q29udGVudCxcclxuICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyhuYW1lLCBkZXNjcmlwdGlvbiwgYXZhdGFyKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX3VzZXJEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gICAgICAgIC8vdGhpcy5fYXZhdGFyUGljLnNyYyA9IGF2YXRhclxyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyUGljLnNyYyA9IGF2YXRhcjtcclxuICAgIH1cclxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKVxyXG5cclxuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zdWJ0aXRsZVwiKVxyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKSAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICAgICAgc3VwZXIub3BlbigpXHJcbiAgICAgICBcclxuICAgICAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZVxyXG4gICAgICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbmtcclxuICAgICAgICB0aGlzLl9pbWFnZS5hbHQgPSAoYCBpbWFnZSBvZiAke25hbWV9YClcclxuICAgICAgICBcclxuICAgIH1cclxufSIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXJ9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXJcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKVxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XHJcbiAgICAgICAgaXRlbXMuZm9yRWFjaCgoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihkYXRhKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpXHJcbiAgICB9XHJcbn0iXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwicXVlcnlTZWxlY3RvciIsImVsZW1lbnRMaXN0IiwiZWRpdEJ1dHRvblByb2ZpbGUiLCJjb250ZW50IiwiYWRkQnV0dG9uUHJvZmlsZSIsInBvcHVwRWRpdFByb2ZpbGUiLCJwb3B1cElucHV0TmFtZSIsInBvcHVwSW5wdXREZXNjcmlwdGlvbiIsInBvcHVwQ2hhbmdlQXZhdGFyIiwiYXZhdGFyIiwicG9wdXBBZGRDYXJkIiwicG9wdXBJbWFnZVByZXZpZXciLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsInVzZXJJZCIsInRlbXBsYXRlQ2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiYWN0aXZhdGVMaWtlQnV0dG9uIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJ0aGlzIiwiX2xpa2VCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2FjdGl2YXRlTGlrZUJ1dHRvbiIsIl9kZWxldGVCdXR0b24iLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfY2FyZEltYWdlIiwiX2hhbmRsZUNhcmRDbGljayIsIl90ZXh0IiwiX2xpbmsiLCJfY2FyZCIsIl9jYXJkVGVtcGxhdGUiLCJjbG9uZU5vZGUiLCJjYXJkVGl0bGUiLCJfbGlrZXNDb3VudGVyIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJzZXRMaWtlcyIsIl9saWtlcyIsIl91c2VySWQiLCJfb3duZXJJZCIsInN0eWxlIiwiZGlzcGxheSIsIm5hbWUiLCJsaW5rIiwibGlrZXMiLCJfaWQiLCJvd25lciIsIl90ZW1wbGF0ZUNhcmRTZWxlY3RvciIsImdldElkIiwicmVtb3ZlQ2FyZCIsInJlbW92ZSIsIm5ld0xpa2VzIiwibGVuZ3RoIiwiaXNMaWtlZCIsImNsYXNzTGlzdCIsImFkZCIsImZpbmQiLCJ1c2VyIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJfc2V0dGluZ3MiLCJlcnJvckVsZW1lbnQiLCJfZm9ybUVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsIl9pbnB1dExpc3QiLCJldmVyeSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfZW5hYmxlQnV0dG9uIiwiZGlzYWJsZUJ1dHRvbiIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfYnV0dG9uRWxlbWVudCIsImRpc2FibGVkIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsImtleSIsImNsb3NlIiwib3BlbiIsImFkZEtleURvd25MaXN0ZW5lciIsIndpbmRvdyIsInJlbW92ZUtleURvd25MaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsIm1hdGNoZXMiLCJQb3B1cFdpdGhGb3JtIiwicG91cFNlbGVjdG9yIiwiaGFuZGxlclN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZXJTdWJtaXQiLCJfZm9ybSIsIl9zdWJtaXRCdXR0b24iLCJfaW5pdGlhbEJ1dHRvblRleHQiLCJfaW5wdXRzIiwiX2dldElucHV0VmFsdWVzIiwidmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsImUiLCJjaGFuZ2VTdWJtaXRIYW5kbGVyIiwibmV3U3VibWl0SGFuZGxlciIsImNoYW5nZVRleHQiLCJ0ZXh0IiwicmVzZXQiLCJhcGkiLCJvcHRpb25zIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1c1RleHQiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsIl9jaGVja1Jlc3BvbnNlIiwiZ2V0Q2FyZHMiLCJlZGl0UHJvZmlsZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0QXZhdGFyIiwiYWRkQ2FyZCIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwiZGVsZXRlQ2FyZCIsImF1dGhvcml6YXRpb24iLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfdXNlck5hbWUiLCJfdXNlckRlc2NyaXB0aW9uIiwiX2F2YXRhclBpYyIsImRlc2NyaXB0aW9uIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiYWxsIiwidXNlckRhdGEiLCJjYXJkcyIsInNlY3Rpb24iLCJyZW5kZXJJdGVtcyIsImNhdGNoIiwiY29uc29sZSIsImxvZyIsImVkaXRGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwiY2hhbmdlQXZhdGFyRm9ybVZhbGlkYXRvciIsImFkZENhcmRQb3B1cCIsInJlbmRlckNhcmQiLCJlcnIiLCJmaW5hbGx5IiwiYXZhdGFyQ2hhbmdlUG9wdXAiLCJkZWxldGVDYXJkUG9wdXAiLCJlZGl0UHJvZmlsZVBvcHVwIiwiTmFtZSIsImltYWdlUG9wdXAiLCJfY2FwdGlvbiIsIl9pbWFnZSIsImNhcmQiLCJhZGRJdGVtIiwiZ2V0Q2FyZEVsZW1lbnQiLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsIml0ZW1zIiwiZWxlbWVudCIsInByZXBlbmQiLCJwcm9maWxlRGF0YSIsImZpbGxQcm9maWxlRm9ybSJdLCJzb3VyY2VSb290IjoiIn0=