!function(){"use strict";document.querySelectorAll(".popup"),document.querySelector(".popup__form");const e=document.querySelector(".elements"),t=(document.querySelector("#card-template").content.querySelector(".element"),document.querySelector(".profile__edit-button")),s=document.querySelector(".profile__add-button"),i=document.querySelector(".popup_type_edit-profile"),n=i.querySelector(".popup__input_type_name"),r=i.querySelector(".popup__input_type_description"),o=document.querySelector(".popup_type_avatar-change"),a=document.querySelector(".profile__image"),l=document.querySelector(".popup_type_add-card"),c=document.querySelector(".popup_type-preview"),h=(c.querySelector(".popup__image"),c.querySelector(".popup__subtitle"),{formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"});function d(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class _{constructor(e){let{data:t,userId:s,templateCardSelector:i,handleCardClick:n,activateLikeButton:r,handleDeleteClick:o}=e;d(this,"_setEventListeners",(()=>{this._likeButton.addEventListener("click",(()=>this._activateLikeButton())),this._deleteButton.addEventListener("click",(()=>this._handleDeleteClick(this))),this._cardImage.addEventListener("click",(()=>this._handleCardClick(this._text,this._link)))})),d(this,"getCardElement",(()=>{this._card=this._cardTemplate.cloneNode(!0),this._likeButton=this._card.querySelector(".element__button-like"),this._deleteButton=this._card.querySelector(".element__button-delete"),this._cardImage=this._card.querySelector(".element__image");const e=this._card.querySelector(".element__title");return this._likesCounter=this._card.querySelector(".element__likes-count"),e.textContent=this._text,this._cardImage.src=this._link,this._cardImage.alt=this._text,this._setEventListeners(),this.setLikes(this._likes),this._userId!==this._ownerId&&(this._deleteButton.style.display="none"),this._card})),this._text=t.name,this._link=t.link,this._likes=t.likes,this._id=t._id,this._userId=s,this._ownerId=t.owner._id,this._templateCardSelector=i,this._handleCardClick=n,this._activateLikeButton=r,this._handleDeleteClick=o,this._cardTemplate=document.querySelector(i).content.querySelector(".element")}getId(){return this._id}removeCard(){this._card.remove(),this._card=null}setLikes(e){this._likes=e,this._likesCounter.textContent=this._likes.length,this.isLiked()?this._likeButton.classList.add("element__button-like_active"):this._likeButton.classList.remove("element__button-like_active")}isLiked(){return this._likes.find((e=>e._id===this._userId))}}function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var p=class{constructor(e,t){u(this,"_showInputError",(e=>{const{inputErrorClass:t,errorClass:s}=this._settings,i=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(t),i.textContent=e.validationMessage,i.classList.add(s)})),u(this,"_hideInputError",(e=>{const{inputErrorClass:t,errorClass:s}=this._settings,i=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(t),i.textContent="",i.classList.remove(s)})),u(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,this._settings)})),u(this,"_hasInvalidInput",(()=>this._inputList.every((e=>e.validity.valid)))),u(this,"toggleButtonState",(()=>{this._hasInvalidInput()?this._enableButton():this.disableButton()})),u(this,"_setEventListeners",(()=>{const{inputSelector:e}=this._settings;this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))})),this._settings=e,this._formElement=t,this._inputList=[...this._formElement.querySelectorAll(this._settings.inputSelector)],this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSelector)}disableButton(){const{inactiveButtonClass:e}=this._settings;this._buttonElement.disabled=!0,this._buttonElement.classList.add(e)}_enableButton(){const{inactiveButtonClass:e}=this._settings;this._buttonElement.disabled=!1,this._buttonElement.classList.remove(e)}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};class m{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popup.classList.add("popup__opened"),this.addKeyDownListener()}addKeyDownListener(){window.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup__opened"),this.removeKeyDownListener()}removeKeyDownListener(){window.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.matches(".popup")||e.target.matches(".popup__close"))&&this.close()}))}}class v extends m{constructor(e,t){super(e),this._handlerSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._submitButton=this._form.querySelector(".popup__save"),this._initialButtonText=this._submitButton.textContent,this._inputs=[...this._form.querySelectorAll(".popup__input")]}_getInputValues(){const e={};return this._inputs.forEach((t=>{const s=t.name,i=t.value;e[s]=i})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handlerSubmit(this._getInputValues())}))}changeSubmitHandler(e){this._handlerSubmit=e}changeText(e){this._submitButton.textContent=e}close(){super.close(),this._form.reset()}}const y=new class{constructor(e){var t,s;s=e=>e.ok?e.json():Promise.reject(e.statusText),(t="_checkResponse")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._baseUrl=e.baseUrl,this._headers=e.headers}getUserInfo(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then(this._checkResponse)}getCards(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then(this._checkResponse)}editProfile(e,t){return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}editAvatar(e){return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}addCard(e,t){return fetch(this._baseUrl+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}addLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then(this._checkResponse)}removeLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}removeLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}deleteCard(e){return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"4cdae314-7e8a-4bed-8ada-70ad33c12e13","Content-Type":"application/json"}}),g=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._userName=document.querySelector(t),this._userDescription=document.querySelector(s),this._avatarPic=document.querySelector(i)}getUserInfo(){return{name:this._userName.textContent,description:this._userDescription.textContent}}setUserInfo(e,t,s){this._userName.textContent=e,this._userDescription.textContent=t,this.setUserAvatar(s)}setUserAvatar(e){this._avatarPic.src=e}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"});let k;Promise.all([y.getUserInfo(),y.getCards()]).then((e=>{let[t,s]=e;k=t._id,g.setUserInfo(t.name,t.about,t.avatar),x.renderItems(s)})).catch(console.log);const b=new p(h,i),f=new p(h,l),S=new p(h,o);b.enableValidation(),f.enableValidation(),S.enableValidation();const E=new v(".popup_type_add-card",(t=>{E.changeText("saving..."),y.addCard(t["card-title"],t["card-link"]).then((t=>{B(t,e)})).then((()=>{E.close()})).catch((e=>{console.log(e)})).finally((()=>{E.changeText("Create")}))}));E.setEventListeners();const L=new v(".popup_type_avatar-change",(e=>{L.changeText("saving..."),y.editAvatar(e["card-link"]).then((e=>{g.setUserAvatar(e.avatar)})).then((()=>{L.close()})).catch((e=>{console.log(e)})).finally((()=>{L.changeText("Save")}))}));L.setEventListeners();const C=new v(".popup_type_confirm-delete");C.setEventListeners();const I=new v(".popup_type_edit-profile",(e=>{I.changeText("saving..."),y.editProfile(e.Name,e.description).then((e=>{g.setUserInfo(e.name,e.about,e.avatar)})).then((()=>{I.close()})).catch((e=>{console.log(e)})).finally((()=>{I.changeText("Save")}))}));I.setEventListeners();const q=new class extends m{constructor(e){super(e),this._caption=this._popup.querySelector(".popup__subtitle"),this._image=this._popup.querySelector(".popup__image")}open(e,t){super.open(),this._caption.textContent=e,this._image.src=t,this._image.alt=" image of ".concat(e)}}(".popup_type-preview");q.setEventListeners();const w=e=>{C.open(),C.changeSubmitHandler((()=>{C.changeText("deleting..."),y.deleteCard(e.getId()).then((()=>{e.removeCard()})).then((()=>{C.close()})).catch((e=>{console.log(e)})).finally((()=>{C.changeText("Yes")}))}))},B=e=>{const t=new _({data:e,userId:k,templateCardSelector:"#card-template",handleCardClick:()=>(e=>{q.open(e.name,e.link)})(e),activateLikeButton:()=>(e=>{e.isLiked()?y.removeLike(e.getId()).then((t=>{e.setLikes(t.likes)})).catch((e=>{console.log(e)})):y.addLike(e.getId()).then((t=>{e.setLikes(t.likes)})).catch((e=>{console.log(e)}))})(t),handleDeleteClick:w});x.addItem(t.getCardElement())},x=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:B},".elements");t.addEventListener("click",(function(){!function(){const e=g.getUserInfo();n.value=e.name,r.value=e.description}(),I.open()})),s.addEventListener("click",(function(){f.disableButton(),E.open()})),a.addEventListener("click",(function(){S.disableButton(),L.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFTRSxjQUFjK0wsR0FHN0N0QixZQUFZMEIsR0FDUkEsRUFBTTlHLFNBQVNoRSxJQUNYTSxLQUFLc0ssVUFBVTVLLE1BSXZCd0ssUUFBUU8sR0FDSnpLLEtBQUt1SyxXQUFXRyxRQUFRRCxLSGlLNUIsQ0FDSUosU0FBVWQsR0FDWCxhQTZCUGhMLEVBQWtCMkIsaUJBQWlCLFNBbkJuQyxZQU5BLFdBQ0ksTUFBTXlLLEVBQWMzQyxFQUFTakIsY0FDN0JwSSxFQUFlaUgsTUFBUStFLEVBQVlsSixLQUNuQzdDLEVBQXNCZ0gsTUFBUStFLEVBQVlwQyxZQUkxQ3FDLEdBQ0FoQixFQUFpQnBGLFVBbUJyQi9GLEVBQWlCeUIsaUJBQWlCLFNBZmxDLFdBQ0lrSixFQUFxQjVGLGdCQUNyQjhGLEVBQWE5RSxVQWVqQjFGLEVBQU9vQixpQkFBaUIsU0FYeEIsV0FDSW1KLEVBQTBCN0YsZ0JBQzFCa0csRUFBa0JsRixVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxyXG4gICAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBwb3B1cHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwXCIpO1xyXG5leHBvcnQgY29uc3QgZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGVsZW1lbnRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c1wiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpXHJcbiAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRcIik7XHJcblxyXG4vL3Byb2ZpbGUgbW9kZWwgYnV0dG9uc1xyXG5leHBvcnQgY29uc3QgZWRpdEJ1dHRvblByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgYWRkQnV0dG9uUHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuXHJcbi8vcG9wdXAgZWRpdCBwcm9maWxlXHJcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZVwiKTtcclxuXHJcbi8vcG9wdXAgZWRpdCBwcm9maWxlIGlucHV0c1xyXG5leHBvcnQgY29uc3QgcG9wdXBJbnB1dE5hbWUgPSBwb3B1cEVkaXRQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICBcIi5wb3B1cF9faW5wdXRfdHlwZV9uYW1lXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW5wdXREZXNjcmlwdGlvbiA9IHBvcHVwRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcihcclxuICAgIFwiLnBvcHVwX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uXCJcclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwb3B1cENoYW5nZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hdmF0YXItY2hhbmdlXCIpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcclxuXHJcbi8vZXhwb3J0IGNvbnN0IHBvcHVwRGVsZXRlQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hdmF0YXItY2hhbmdlXCIpO1xyXG4vL2V4cG9ydCBjb25zdCBkZWxldGVDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc2F2ZV90eXBlX2FkZC1jYXJkXCIpO1xyXG5cclxuXHJcbi8vcG9wdXAgYWRkIGNhcmRcclxuZXhwb3J0IGNvbnN0IHBvcHVwQWRkQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hZGQtY2FyZFwiKTtcclxuXHJcbi8vaW1hZ2UgcHJldmlld1xyXG5leHBvcnQgY29uc3QgcG9wdXBJbWFnZVByZXZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGUtcHJldmlld1wiKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW1hZ2UgPSBwb3B1cEltYWdlUHJldmlldy5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwVGl0bGUgPSBwb3B1cEltYWdlUHJldmlldy5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zdWJ0aXRsZVwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICAgIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zYXZlXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zYXZlX2Rpc2FibGVkXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcclxufVxyXG5cclxuIiwiZXhwb3J0IGNsYXNzIENhcmQge1xyXG4gICAgY29uc3RydWN0b3Ioe2RhdGEsIHVzZXJJZCwgdGVtcGxhdGVDYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaywgYWN0aXZhdGVMaWtlQnV0dG9uLCBoYW5kbGVEZWxldGVDbGlja30pIHsgLy97dGV4dCxsaW5rfVxyXG4gICAgICAgIHRoaXMuX3RleHQgPSBkYXRhLm5hbWU7IFxyXG4gICAgICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZFxyXG5cclxuICAgICAgICB0aGlzLl90ZW1wbGF0ZUNhcmRTZWxlY3RvciA9IHRlbXBsYXRlQ2FyZFNlbGVjdG9yXHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrXHJcbiAgICAgICAgdGhpcy5fYWN0aXZhdGVMaWtlQnV0dG9uID0gYWN0aXZhdGVMaWtlQnV0dG9uXHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGlja1xyXG5cclxuICAgICAgICB0aGlzLl9jYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRlbXBsYXRlQ2FyZFNlbGVjdG9yKVxyXG4gICAgICAgICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRcIik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIC8vX2FjdGl2YXRlTGlrZUJ1dHRvbiA9IGV2dCA9PiBldnQudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoXCJlbGVtZW50X19idXR0b24tbGlrZV9hY3RpdmVcIik7XHJcblxyXG4gICAgZ2V0SWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lkXHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9jYXJkLnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuX2NhcmQgPSBudWxsOy8vXHJcbiAgICB9XHJcbiAgICBcclxuICAgIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9hY3RpdmF0ZUxpa2VCdXR0b24oKSk7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fdGV4dCwgdGhpcy5fbGluaykpOy8vKHRoaXMuZGF0YSlcclxuICAgIH1cclxuXHJcbiAgICBzZXRMaWtlcyhuZXdMaWtlcykge1xyXG4gICAgICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXNcclxuXHJcbiAgICAgICAgdGhpcy5fbGlrZXNDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG5cclxuICAgICAgICAvLyBjb25zdCBsaWtlQ291bnRlciA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICAgICAgICAvLyB0aGlzLl9saWtlc0NvdW50ZXIucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saWtlcy1jb3VudFwiKS50ZXh0Q29udGVudCA9IGxpa2VDb3VudGVyO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGNhcmRJc0xpa2VkQnlVc2VyID0gdGhpcy5pc0xpa2VkKClcclxuXHJcbiAgICAgICAgaWYgKGNhcmRJc0xpa2VkQnlVc2VyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImVsZW1lbnRfX2J1dHRvbi1saWtlX2FjdGl2ZVwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJlbGVtZW50X19idXR0b24tbGlrZV9hY3RpdmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlzTGlrZWQoKSB7XHJcbiAgICAgICByZXR1cm4gdGhpcy5fbGlrZXMuZmluZCh1c2VyID0+IHVzZXIuX2lkID09PSB0aGlzLl91c2VySWQpIFxyXG4gICAgfVxyXG5cclxuICAgIGdldENhcmRFbGVtZW50ID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NhcmQgPSB0aGlzLl9jYXJkVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2J1dHRvbi1saWtlXCIpO1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19idXR0b24tZGVsZXRlXCIpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZVwiKTtcclxuICAgICAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fdGl0bGVcIik7XHJcblxyXG4gICAgICAgdGhpcy5fbGlrZXNDb3VudGVyID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2xpa2VzLWNvdW50XCIpO1xyXG5cclxuICAgICAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl90ZXh0O1xyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl90ZXh0O1xyXG4gICAgICAgICAgICAgXHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRMaWtlcyh0aGlzLl9saWtlcylcclxuXHJcbiAgICAgICAgaWYodGhpcy5fdXNlcklkICE9PSB0aGlzLl9vd25lcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCJcclxuICAgICAgICB9XHJcbiAgICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkO1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuIiwiZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gICAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5nc1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnRcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKV07XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JDbGFzc30gPSB0aGlzLl9zZXR0aW5ncztcclxuXHJcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGVycm9yQ2xhc3MpO1xyXG4gICAgfTtcclxuICAgICAgXHJcbiAgICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIGVycm9yQ2xhc3N9ID0gdGhpcy5fc2V0dGluZ3M7XHJcblxyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShpbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoZXJyb3JDbGFzcyk7XHJcbiAgICB9O1xyXG5cclxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCB0aGlzLl9zZXR0aW5ncyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBfaGFzSW52YWxpZElucHV0ID0gKCkgPT4gdGhpcy5faW5wdXRMaXN0LmV2ZXJ5KGlucHV0RWxlbWVudCA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG5cclxuICAgIFxyXG4gICAgZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgICAgICBjb25zdCB7IGluYWN0aXZlQnV0dG9uQ2xhc3MgfSA9IHRoaXMuX3NldHRpbmdzO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChpbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICAgICAgY29uc3QgeyBpbmFjdGl2ZUJ1dHRvbkNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB9XHJcblxyXG4gICAgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoKSA9PiB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgICAgICAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcclxuICAgICAgICBjb25zdCB7IGlucHV0U2VsZWN0b3IgfSA9IHRoaXMuX3NldHRpbmdzXHJcbiAgICAgICAgLy9jb25zdCBidXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihzdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICAgICAgXHJcbiAgICAgIFxyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTsgLy90b2dnbGUgc3VibWl0XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpOyAvL2NoZWNrIHZhbGlkaXR5XHJcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTsgLy90b2dnbGUgc3VibWl0XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8vIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIC8vICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTsgXHJcblxyXG4gICAgLy8gICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAvLyAgICAgdGhpcy5faGlkZUVycm9yKGlucHV0RWxlbWVudCkgXHJcbiAgICAvLyAgIH0pO1xyXG5cclxuICAgIC8vIH1cclxuXHJcbiAgICAvLyByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICAvLyAgICAgdGhpcy5pbnB1dExpc3QuZm9yRWFjaChpbnB1dCA9PiB7XHJcbiAgICAvLyAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KVxyXG4gICAgLy8gICAgIH0pXHJcbiAgICAvLyB9XHJcblxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgICB9O1xyXG4gICAgXHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yIiwiZXhwb3J0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3RvcilcclxuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcylcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICAgICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9wZW4oKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX19vcGVuZWRcIik7XHJcbiAgICAgICAgdGhpcy5hZGRLZXlEb3duTGlzdGVuZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRLZXlEb3duTGlzdGVuZXIoKSB7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfX29wZW5lZFwiKTtcclxuICAgICAgICB0aGlzLnJlbW92ZUtleURvd25MaXN0ZW5lcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUtleURvd25MaXN0ZW5lcigpIHtcclxuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXZ0LnRhcmdldC5tYXRjaGVzKFwiLnBvcHVwXCIpIHx8IGV2dC50YXJnZXQubWF0Y2hlcyhcIi5wb3B1cF9fY2xvc2VcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgXHJcbiAgICB9XHJcbiAgIFxyXG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cHtcclxuICAgIGNvbnN0cnVjdG9yKHBvdXBTZWxlY3RvciwgaGFuZGxlclN1Ym1pdCkge1xyXG4gICAgICAgIHN1cGVyKHBvdXBTZWxlY3RvcilcclxuXHJcbiAgICAgICAgdGhpcy5faGFuZGxlclN1Ym1pdCA9IGhhbmRsZXJTdWJtaXRcclxuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKVxyXG4gICAgXHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zYXZlXCIpXHJcbiAgICAgICAgdGhpcy5faW5pdGlhbEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnRcclxuICAgICAgICB0aGlzLl9pbnB1dHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKV1cclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAgICAgY29uc3QgdmFsdWVzID0ge31cclxuXHJcbiAgICAgICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IGlucHV0Lm5hbWVcclxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBpbnB1dC52YWx1ZVxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICB2YWx1ZXNba2V5XSA9IHZhbHVlXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgcmV0dXJuIHZhbHVlc1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKClcclxuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZXJTdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgY2hhbmdlU3VibWl0SGFuZGxlcihuZXdTdWJtaXRIYW5kbGVyKSB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlclN1Ym1pdCA9IG5ld1N1Ym1pdEhhbmRsZXI7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gY2hhbmdlVGV4dCh0ZXh0VHlwZSkgey8vIGluaXRhbCBMb2FkaW5nXHJcbiAgICAvLyAgICAgLy9jb25zdCBidXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3NhdmVcIilcclxuICAgICAgICBcclxuICAgIC8vICAgICAvL2J1dHRvbi50ZXh0Q29udGVudCA9IHRleHRcclxuXHJcbiAgICAvLyAgICAgaWYodGV4dFR5cGUgPT09IFwic2F2aW5nXCIpIHtcclxuICAgIC8vICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIlxyXG4gICAgLy8gICAgIH1cclxuXHJcbiAgICAvLyAgICAgaWYodGV4dFR5cGUgPT09IFwiaW5pdGlhbFwiKSB7XHJcbiAgICAvLyAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX2luaXRpYWxCdXR0b25UZXh0XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gfVxyXG4gICAgXHJcbiAgICBjaGFuZ2VUZXh0KHRleHQpIHtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0ZXh0XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKVxyXG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKVxyXG4gICAgfVxyXG59IiwiY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgICAgdGhpcy5fYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybFxyXG4gICAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzXHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrUmVzcG9uc2UgPSAocmVzKSA9PlxyXG4gICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KTtcclxuICBcclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvdXNlcnMvbWVcIiwge1xyXG4gICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgZ2V0Q2FyZHMoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkc1wiLCB7XHJcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICAgICAgfVxyXG5cclxuICAgIGVkaXRQcm9maWxlKG5hbWUsIGFib3V0KSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICAgICAgYWJvdXRcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICBlZGl0QXZhdGFyKGF2YXRhcikge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvdXNlcnMvbWUvYXZhdGFyXCIsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIGF2YXRhclxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICAgICAgfSAgXHJcblxyXG4gICAgYWRkQ2FyZChuYW1lLCBsaW5rKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkc1wiLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIG5hbWUsXHJcbiAgICAgICAgICAgICAgICBsaW5rLFxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICAgICAgfVxyXG5cclxuICAgIGFkZExpa2UoaWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL2NhcmRzL2xpa2VzL1wiICsgaWQsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICByZW1vdmVMaWtlKGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9saWtlcy9cIiArIGlkLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgICB9XHJcblxyXG4gICAgcmVtb3ZlTGlrZShpZCkge1xyXG4gICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL2NhcmRzL2xpa2VzL1wiICsgaWQsIHtcclxuICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL2NhcmRzL1wiICsgaWQsIHtcclxuICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICAgIFxyXG4gICAgfVxyXG5cclxuICB9XHJcbiAgXHJcbiAgICBleHBvcnQgY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIixcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogXCI0Y2RhZTMxNC03ZThhLTRiZWQtOGFkYS03MGFkMzNjMTJlMTNcIixcclxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICAgIH1cclxuICB9KTsiLCJpbXBvcnQgXCIuLy4uL3BhZ2VzL2luZGV4LmNzc1wiO1xuaW1wb3J0IFwiLi8uLi9mb250cy9mb250LmNzc1wiO1xuaW1wb3J0IHsgZWxlbWVudExpc3QsIGVkaXRCdXR0b25Qcm9maWxlLCBhZGRCdXR0b25Qcm9maWxlLCBwb3B1cEVkaXRQcm9maWxlLCBwb3B1cElucHV0TmFtZSwgcG9wdXBJbnB1dERlc2NyaXB0aW9uLCBwb3B1cEFkZENhcmQsIHNldHRpbmdzLCBwb3B1cENoYW5nZUF2YXRhciwgYXZhdGFyLCBwb3B1cERlbGV0ZUNhcmR9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIlxuaW1wb3J0IHsgQ2FyZH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiXG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCJcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCJcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIlxuXG5pbXBvcnQgeyBhcGl9IGZyb20gXCIuLi91dGlscy9BcGkuanNcIlxuXG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsIFxuICAgIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxuICAgIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19pbWFnZVwiXG59KVxuXG5cbmxldCB1c2VySWRcblxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0Q2FyZHMoKV0pXG4gICAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XG4gICAgICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZFxuXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhLm5hbWUsIHVzZXJEYXRhLmFib3V0LCB1c2VyRGF0YS5hdmF0YXIpXG4gICAgICAgIHNlY3Rpb24ucmVuZGVySXRlbXMoY2FyZHMpXG59KVxuICAgIC5jYXRjaChjb25zb2xlLmxvZylcblxuXG4vLyB2YWxpZGF0b3JzICAgIFxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgcG9wdXBFZGl0UHJvZmlsZSlcbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIHBvcHVwQWRkQ2FyZClcbmNvbnN0IGNoYW5nZUF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgcG9wdXBDaGFuZ2VBdmF0YXIpXG5cbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZENhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmNoYW5nZUF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyBzdWJtaXQgaGFuZGxlcnMgb2YgbW9kYWxzXG5jb25zdCBoYW5kbGVBZGRDYXJkU3VibWl0ID0gKGRhdGEpID0+IHtcbiAgICBhZGRDYXJkUG9wdXAuY2hhbmdlVGV4dChcInNhdmluZy4uLlwiKSAgXG4gICAgYXBpLmFkZENhcmQoZGF0YVtcImNhcmQtdGl0bGVcIl0sIGRhdGFbXCJjYXJkLWxpbmtcIl0pXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmVuZGVyQ2FyZChyZXMsICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICBlbGVtZW50TGlzdFxuICAgICAgICAgICk7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGFkZENhcmRQb3B1cC5jbG9zZSgpXG4gICAgICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT57XG4gICAgICAgIGFkZENhcmRQb3B1cC5jaGFuZ2VUZXh0KFwiQ3JlYXRlXCIpXG4gICAgfSkgICAgXG59XG5cbmNvbnN0IGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0ID0gKGRhdGEpID0+IHtcbmVkaXRQcm9maWxlUG9wdXAuY2hhbmdlVGV4dChcInNhdmluZy4uLlwiKVxuICAgIGFwaS5lZGl0UHJvZmlsZShkYXRhLk5hbWUsIGRhdGEuZGVzY3JpcHRpb24pXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzLm5hbWUsIHJlcy5hYm91dCwgcmVzLmF2YXRhcilcbiAgICB9KVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpXG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSlcbiAgICAuZmluYWxseSgoKSA9PntcbiAgICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jaGFuZ2VUZXh0KFwiU2F2ZVwiKVxuICAgIH0pXG59XG5cblxuY29uc3QgaGFuZGxlQXZhdGFyU3VibWl0ID0gKGRhdGEpID0+IHtcbiAgICBhdmF0YXJDaGFuZ2VQb3B1cC5jaGFuZ2VUZXh0KFwic2F2aW5nLi4uXCIpXG4gICAgYXBpLmVkaXRBdmF0YXIoZGF0YVtcImNhcmQtbGlua1wiXSlcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHJlcy5hdmF0YXIpXG4gICAgfSlcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGF2YXRhckNoYW5nZVBvcHVwLmNsb3NlKClcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+e1xuICAgICAgICBhdmF0YXJDaGFuZ2VQb3B1cC5jaGFuZ2VUZXh0KFwiU2F2ZVwiKVxuICAgIH0pXG59XG5cbi8vIGluc3RhbmNlcyBvZiBtb2RhbHNcbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfYWRkLWNhcmRcIiwgaGFuZGxlQWRkQ2FyZFN1Ym1pdClcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IGF2YXRhckNoYW5nZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBfdHlwZV9hdmF0YXItY2hhbmdlXCIsIGhhbmRsZUF2YXRhclN1Ym1pdClcbmF2YXRhckNoYW5nZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKClcblxuY29uc3QgZGVsZXRlQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBfdHlwZV9jb25maXJtLWRlbGV0ZVwiKVxuZGVsZXRlQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKClcblxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCIsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KVxuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXBfdHlwZS1wcmV2aWV3XCIpXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKClcblxuY29uc3QgdGVtcGxhdGVDYXJkU2VsZWN0b3IgPSBcIiNjYXJkLXRlbXBsYXRlXCJcblxuY29uc3QgaGFuZGxlQ2FyZENsaWNrID0gKGRhdGEpID0+IHtcbiAgICBpbWFnZVBvcHVwLm9wZW4oZGF0YS5uYW1lLCBkYXRhLmxpbmspXG59XG5cbmNvbnN0IGFjdGl2YXRlTGlrZUJ1dHRvbiA9IChjYXJkKSA9PiB7XG4gICAgaWYoY2FyZC5pc0xpa2VkKCkpIHtcbiAgICAgICAgYXBpLnJlbW92ZUxpa2UoY2FyZC5nZXRJZCgpKVxuICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGNhcmQuc2V0TGlrZXMocmVzLmxpa2VzKVxuICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgICAgYXBpLmFkZExpa2UoY2FyZC5nZXRJZCgpKVxuICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGNhcmQuc2V0TGlrZXMocmVzLmxpa2VzKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICB9KVxuICAgIH1cbn0gICAgIFxuXG5jb25zdCBoYW5kbGVEZWxldGVDbGljayA9IChjYXJkKSA9PiB7XG4gICAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKVxuICAgIC8vZGVsZXRlQ2FyZFBvcHVwLnJlc2V0VmFsaWRhdGlvbigpXG5cbiAgICBkZWxldGVDYXJkUG9wdXAuY2hhbmdlU3VibWl0SGFuZGxlcigoKSA9PiB7XG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jaGFuZ2VUZXh0KFwiZGVsZXRpbmcuLi5cIilcbiAgICAgICAgYXBpLmRlbGV0ZUNhcmQoY2FyZC5nZXRJZCgpKVxuICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpXG4gICAgICAgICAgIH0pXG4gICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpXG4gICAgICAgICAgIH0pXG4gICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgIH0pXG4gICAgICAgIC5maW5hbGx5KCgpID0+e1xuICAgICAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLmNoYW5nZVRleHQoXCJZZXNcIilcbiAgICAgICAgfSlcbiAgfSlcbn1cblxuY29uc3QgcmVuZGVyQ2FyZCA9IChkYXRhKSA9PiB7XG4gICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcbiAgICAgICAgZGF0YSxcbiAgICAgICAgdXNlcklkLFxuICAgICAgICB0ZW1wbGF0ZUNhcmRTZWxlY3RvcixcbiAgICAgICAgaGFuZGxlQ2FyZENsaWNrOiAoKSA9PiBoYW5kbGVDYXJkQ2xpY2soZGF0YSksIFxuICAgICAgICBhY3RpdmF0ZUxpa2VCdXR0b246ICgpID0+IGFjdGl2YXRlTGlrZUJ1dHRvbihjYXJkKSxcbiAgICAgICAgaGFuZGxlRGVsZXRlQ2xpY2s6IGhhbmRsZURlbGV0ZUNsaWNrXG4gICAgfVxuICAgICkgICAgXG4gICAgc2VjdGlvbi5hZGRJdGVtKGNhcmQuZ2V0Q2FyZEVsZW1lbnQoKSk7XG59XG5cbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICB7ICBcbiAgICAgICAgcmVuZGVyZXI6IHJlbmRlckNhcmQgXG4gICAgfSwgXCIuZWxlbWVudHNcIlxuICAgIClcblxuXG5mdW5jdGlvbiBmaWxsUHJvZmlsZUZvcm0oKSB7XG4gICAgY29uc3QgcHJvZmlsZURhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpXG4gICAgcG9wdXBJbnB1dE5hbWUudmFsdWUgPSBwcm9maWxlRGF0YS5uYW1lO1xuICAgIHBvcHVwSW5wdXREZXNjcmlwdGlvbi52YWx1ZSA9IHByb2ZpbGVEYXRhLmRlc2NyaXB0aW9uO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVFZGl0QnV0dG9uQ2xpY2soKSB7XG4gICAgZmlsbFByb2ZpbGVGb3JtKCk7XG4gICAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuKClcbiAgICAvL2VkaXRQcm9maWxlUG9wdXAucmVzZXRWYWxpZGF0aW9uKClcbn1cblxuZnVuY3Rpb24gaGFuZGxlQWRkQnV0dG9uQ2xpY2soKSB7XG4gICAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpXG4gICAgYWRkQ2FyZFBvcHVwLm9wZW4oKVxuICAgIC8vYWRkQ2FyZFBvcHVwLnJlc2V0VmFsaWRhdGlvbigpXG59XG5cbmZ1bmN0aW9uIGhhbmRsZUNoYW5nZUF2YXRhckNsaWNrKCkge1xuICAgIGNoYW5nZUF2YXRhckZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpXG4gICAgYXZhdGFyQ2hhbmdlUG9wdXAub3BlbigpXG4gICAgLy9hdmF0YXJDaGFuZ2VQb3B1cC5yZXNldFZhbGlkYXRpb24oKVxufVxuXG5cbmVkaXRCdXR0b25Qcm9maWxlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVFZGl0QnV0dG9uQ2xpY2spO1xuXG5hZGRCdXR0b25Qcm9maWxlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVBZGRCdXR0b25DbGljayk7XG5cbmF2YXRhci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQ2hhbmdlQXZhdGFyQ2xpY2spOyIsImV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcigge25hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yfSkge1xyXG4gICAgICAgIHRoaXMuX3VzZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpXHJcbiAgICAgICAgdGhpcy5fdXNlckRlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3RvcilcclxuICAgICAgICB0aGlzLl9hdmF0YXJQaWMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKVxyXG4gICAgXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICBuYW1lOiB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5fdXNlckRlc2NyaXB0aW9uLnRleHRDb250ZW50LFxyXG4gICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJJbmZvKG5hbWUsIGRlc2NyaXB0aW9uLCBhdmF0YXIpIHtcclxuICAgICAgICB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fdXNlckRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XHJcbiAgICAgICAgdGhpcy5zZXRVc2VyQXZhdGFyKGF2YXRhcilcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xyXG4gICAgICAgIHRoaXMuX2F2YXRhclBpYy5zcmMgPSBhdmF0YXI7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3RvcilcclxuXHJcbiAgICB0aGlzLl9jYXB0aW9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc3VidGl0bGVcIilcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIikgICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgICAgIHN1cGVyLm9wZW4oKVxyXG4gICAgICAgXHJcbiAgICAgICAgdGhpcy5fY2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWVcclxuICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rXHJcbiAgICAgICAgdGhpcy5faW1hZ2UuYWx0ID0gKGAgaW1hZ2Ugb2YgJHtuYW1lfWApXHJcbiAgICAgICAgXHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyXHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3RvcilcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gICAgICAgIGl0ZW1zLmZvckVhY2goKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIoZGF0YSlcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KVxyXG4gICAgfVxyXG59Il0sIm5hbWVzIjpbImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsInF1ZXJ5U2VsZWN0b3IiLCJlbGVtZW50TGlzdCIsImVkaXRCdXR0b25Qcm9maWxlIiwiY29udGVudCIsImFkZEJ1dHRvblByb2ZpbGUiLCJwb3B1cEVkaXRQcm9maWxlIiwicG9wdXBJbnB1dE5hbWUiLCJwb3B1cElucHV0RGVzY3JpcHRpb24iLCJwb3B1cENoYW5nZUF2YXRhciIsImF2YXRhciIsInBvcHVwQWRkQ2FyZCIsInBvcHVwSW1hZ2VQcmV2aWV3Iiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJ1c2VySWQiLCJ0ZW1wbGF0ZUNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImFjdGl2YXRlTGlrZUJ1dHRvbiIsImhhbmRsZURlbGV0ZUNsaWNrIiwidGhpcyIsIl9saWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9hY3RpdmF0ZUxpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2NhcmRJbWFnZSIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfdGV4dCIsIl9saW5rIiwiX2NhcmQiLCJfY2FyZFRlbXBsYXRlIiwiY2xvbmVOb2RlIiwiY2FyZFRpdGxlIiwiX2xpa2VzQ291bnRlciIsInRleHRDb250ZW50Iiwic3JjIiwiYWx0IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwic2V0TGlrZXMiLCJfbGlrZXMiLCJfdXNlcklkIiwiX293bmVySWQiLCJzdHlsZSIsImRpc3BsYXkiLCJuYW1lIiwibGluayIsImxpa2VzIiwiX2lkIiwib3duZXIiLCJfdGVtcGxhdGVDYXJkU2VsZWN0b3IiLCJnZXRJZCIsInJlbW92ZUNhcmQiLCJyZW1vdmUiLCJuZXdMaWtlcyIsImxlbmd0aCIsImlzTGlrZWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJmaW5kIiwidXNlciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiX3NldHRpbmdzIiwiZXJyb3JFbGVtZW50IiwiX2Zvcm1FbGVtZW50IiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJfaW5wdXRMaXN0IiwiZXZlcnkiLCJfaGFzSW52YWxpZElucHV0IiwiX2VuYWJsZUJ1dHRvbiIsImRpc2FibGVCdXR0b24iLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX2J1dHRvbkVsZW1lbnQiLCJkaXNhYmxlZCIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJrZXkiLCJjbG9zZSIsIm9wZW4iLCJhZGRLZXlEb3duTGlzdGVuZXIiLCJ3aW5kb3ciLCJyZW1vdmVLZXlEb3duTGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJtYXRjaGVzIiwiUG9wdXBXaXRoRm9ybSIsInBvdXBTZWxlY3RvciIsImhhbmRsZXJTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVyU3VibWl0IiwiX2Zvcm0iLCJfc3VibWl0QnV0dG9uIiwiX2luaXRpYWxCdXR0b25UZXh0IiwiX2lucHV0cyIsIl9nZXRJbnB1dFZhbHVlcyIsInZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJlIiwiY2hhbmdlU3VibWl0SGFuZGxlciIsIm5ld1N1Ym1pdEhhbmRsZXIiLCJjaGFuZ2VUZXh0IiwidGV4dCIsInJlc2V0IiwiYXBpIiwib3B0aW9ucyIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXNUZXh0IiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJfY2hlY2tSZXNwb25zZSIsImdldENhcmRzIiwiZWRpdFByb2ZpbGUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdEF2YXRhciIsImFkZENhcmQiLCJhZGRMaWtlIiwicmVtb3ZlTGlrZSIsImRlbGV0ZUNhcmQiLCJhdXRob3JpemF0aW9uIiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX3VzZXJOYW1lIiwiX3VzZXJEZXNjcmlwdGlvbiIsIl9hdmF0YXJQaWMiLCJkZXNjcmlwdGlvbiIsInNldFVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsImFsbCIsInVzZXJEYXRhIiwiY2FyZHMiLCJzZWN0aW9uIiwicmVuZGVySXRlbXMiLCJjYXRjaCIsImNvbnNvbGUiLCJsb2ciLCJlZGl0Rm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkRm9ybVZhbGlkYXRvciIsImNoYW5nZUF2YXRhckZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkUG9wdXAiLCJyZW5kZXJDYXJkIiwiZXJyIiwiZmluYWxseSIsImF2YXRhckNoYW5nZVBvcHVwIiwiZGVsZXRlQ2FyZFBvcHVwIiwiZWRpdFByb2ZpbGVQb3B1cCIsIk5hbWUiLCJpbWFnZVBvcHVwIiwiX2NhcHRpb24iLCJfaW1hZ2UiLCJjYXJkIiwiYWRkSXRlbSIsImdldENhcmRFbGVtZW50IiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJpdGVtcyIsImVsZW1lbnQiLCJwcmVwZW5kIiwicHJvZmlsZURhdGEiLCJmaWxsUHJvZmlsZUZvcm0iXSwic291cmNlUm9vdCI6IiJ9