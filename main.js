!function(){"use strict";document.querySelectorAll(".popup"),document.querySelector(".popup__form");const e=document.querySelector(".elements"),t=(document.querySelector("#card-template").content.querySelector(".element"),document.querySelector(".profile__edit-button")),s=document.querySelector(".profile__add-button"),n=document.querySelector(".popup_type_edit-profile"),i=n.querySelector(".popup__input_type_name"),r=n.querySelector(".popup__input_type_description"),o=document.querySelector(".popup_type_avatar-change"),a=document.querySelector(".profile__image"),l=document.querySelector(".popup_type_add-card"),c=document.querySelector(".popup_type-preview"),d=(c.querySelector(".popup__image"),c.querySelector(".popup__subtitle"),{formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"});function h(e){if("Escape"===e.key){const e=document.querySelector(".popup__opened");e&&(e.classList.remove("popup__opened"),window.removeEventListener("keydown",h))}}function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class _{constructor(e){let{data:t,userId:s,templateCardSelector:n,handleCardClick:i,activateLikeButton:r,handleDeleteClick:o}=e;u(this,"_openImagePreview",(()=>{popupImage.src=this._link,popupImage.alt=this._text,popupTitle.textContent=this._text,popupImagePreview.classList.add("popup__opened"),window.addEventListener("keydown",h)})),u(this,"_setEventListeners",(()=>{this._likeButton.addEventListener("click",(()=>this._activateLikeButton())),this._deleteButton.addEventListener("click",(()=>this._handleDeleteClick(this))),this._cardImage.addEventListener("click",(()=>this._handleCardClick(this._text,this._link)))})),u(this,"getCardElement",(()=>(this._card=this._cardTemplate.cloneNode(!0),this._likeButton=this._card.querySelector(".element__button-like"),this._deleteButton=this._card.querySelector(".element__button-delete"),this._cardImage=this._card.querySelector(".element__image"),this._card.querySelector(".element__title").textContent=this._text,this._cardImage.src=this._link,this._cardImage.alt=this._text,this._setEventListeners(),this.setLikes(this._likes),this._userId!==this._ownerId&&(this._card.querySelector(".element__button-delete").style.display="none"),this._card))),this._text=t.name,this._link=t.link,this._likes=t.likes,this._id=t._id,this._userId=s,this._ownerId=t.owner._id,this._templateCardSelector=n,this._handleCardClick=i,this._activateLikeButton=r,this._handleDeleteClick=o,this._cardTemplate=document.querySelector(n).content.querySelector(".element")}getId(){return this._id}removeCard(){this._card.remove(),this._card=null}setLikes(e){this._likes=e;const t=this._likes.length;this._card.querySelector(".element__likes-count").textContent=t,this.isLiked()?this._likeButton.classList.add("element__button-like_active"):this._likeButton.classList.remove("element__button-like_active")}isLiked(){return this._likes.find((e=>e._id===this._userId))}}function p(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var m=class{constructor(e,t){p(this,"_showInputError",(e=>{const{inputErrorClass:t,errorClass:s}=this._settings,n=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(t),n.textContent=e.validationMessage,n.classList.add(s)})),p(this,"_hideInputError",(e=>{const{inputErrorClass:t,errorClass:s}=this._settings,n=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(t),n.textContent="",n.classList.remove(s)})),p(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,this._settings)})),p(this,"_hasInvalidInput",(()=>this._inputList.every((e=>e.validity.valid)))),p(this,"toggleButtonState",(()=>{this._hasInvalidInput()?this._enableButton():this.disableButton()})),p(this,"_setEventListeners",(()=>{const{inputSelector:e}=this._settings;this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))})),this._settings=e,this._formElement=t,this._inputList=[...this._formElement.querySelectorAll(this._settings.inputSelector)],this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSelector)}disableButton(){const{inactiveButtonClass:e}=this._settings;this._buttonElement.disabled=!0,this._buttonElement.classList.add(e)}_enableButton(){const{inactiveButtonClass:e}=this._settings;this._buttonElement.disabled=!1,this._buttonElement.classList.remove(e)}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};class v{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popup.classList.add("popup__opened"),this.addKeyDownListener()}addKeyDownListener(){window.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup__opened"),this.removeKeyDownListener()}removeKeyDownListener(){window.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.matches(".popup")||e.target.matches(".popup__close"))&&this.close()}))}}class y extends v{constructor(e,t){super(e),this._handlerSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._submitButton=this._form.querySelector(".popup__save"),this._initialButtonText=this._submitButton.textContent}_getInputValues(){const e={};return[...this._form.querySelectorAll(".popup__input")].forEach((t=>{const s=t.name,n=t.value;e[s]=n})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handlerSubmit(this._getInputValues())}))}changeSubmitHandler(e){this._handlerSubmit=e}changeText(e){this._submitButton.textContent=e}close(){super.close(),this._form.reset()}}const g=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}getUserInfo(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}getCards(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}editProfile(e,t){return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}editAvatar(e){return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}addCard(e,t){return fetch(this._baseUrl+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}addLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}removeLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}removeLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}deleteCard(e){return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(e.statusText)))}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"4cdae314-7e8a-4bed-8ada-70ad33c12e13","Content-Type":"application/json"}}),k=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:n}=e;this._userName=document.querySelector(t),this._userDescription=document.querySelector(s),this._avatarPic=document.querySelector(n)}getUserInfo(){return{name:this._userName.textContent,description:this._userDescription.textContent}}setUserInfo(e,t,s){this._userName.textContent=e,this._userDescription.textContent=t}setUserAvatar(e){this._avatarPic.src=e}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"});let b;Promise.all([g.getUserInfo(),g.getCards()]).then((e=>{let[t,s]=e;b=t._id,k.setUserInfo(t.name,t.about,t.avatar),B.renderItems(s)})).catch(console.log);const f=new m(d,n),S=new m(d,l),E=new m(d,o);f.enableValidation(),S.enableValidation(),E.enableValidation();const L=new y(".popup_type_add-card",(t=>{L.changeText("saving..."),g.addCard(t["card-title"],t["card-link"]).then((t=>{T(t,e),L.changeText("Create")})).catch((e=>{console.log(e)})).finally((()=>{L.close(),S.disableButton()}))}));L.setEventListeners();const C=new y(".popup_type_avatar-change",(e=>{C.changeText("saving..."),g.editAvatar(e["card-link"]).then((e=>{k.setUserAvatar(e.avatar),C.changeText("Save")})).catch((e=>{console.log(e)})).finally((()=>{C.close()}))}));C.setEventListeners();const I=new y(".popup_type_confirm-delete");I.setEventListeners();const w=new y(".popup_type_edit-profile",(e=>{w.changeText("saving..."),g.editProfile(e.Name,e.description).then((e=>{k.setUserInfo(e.name,e.about,e.avatar),w.changeText("Save"),w.close()})).catch((e=>{console.log(e)})).finally((()=>{}))}));w.setEventListeners();const q=new class extends v{open(e,t){super.open();const s=this._popup.querySelector(".popup__subtitle"),n=this._popup.querySelector(".popup__image");s.textContent=e,n.src=t,n.alt=" image of ".concat(e)}}(".popup_type-preview");q.setEventListeners();const x=e=>{I.open(),I.changeSubmitHandler((()=>{I.changeText("deleting..."),g.deleteCard(e.getId()).then((()=>{e.removeCard(),I.changeText("Yes")})).catch((e=>{console.log(e)})).finally((()=>{I.close()}))}))},T=e=>{const t=new _({data:e,userId:b,templateCardSelector:"#card-template",handleCardClick:()=>(e=>{q.open(e.name,e.link)})(e),activateLikeButton:()=>(e=>{e.isLiked()?g.removeLike(e.getId()).then((t=>{e.setLikes(t.likes)})).catch((e=>{console.log(e)})):g.addLike(e.getId()).then((t=>{e.setLikes(t.likes)})).catch((e=>{console.log(e)}))})(t),handleDeleteClick:x});B.addItem(t.getCardElement())},B=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:T},".elements");t.addEventListener("click",(function(){!function(){const e=k.getUserInfo();i.value=e.name,r.value=e.description}(),w.open()})),s.addEventListener("click",(function(){S.disableButton(),L.open()})),a.addEventListener("click",(function(){E.disableButton(),C.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUtpQyxPQStDTDlCLENBQWdCSCxHQUN2Q0ksbUJBQW9CLElBN0NBNEosS0FDckJBLEVBQUtySCxVQUNKd0QsRUFBSXlCLFdBQVdvQyxFQUFLMUgsU0FDcEJxRSxNQUFLQyxJQUNMb0QsRUFBS3RJLFNBQVNrRixFQUFJMUUsVUFFakI0RyxPQUFPUyxJQUNKUixRQUFRQyxJQUFJTyxNQUdoQnBELEVBQUl3QixRQUFRcUMsRUFBSzFILFNBQ2pCcUUsTUFBS0MsSUFDTG9ELEVBQUt0SSxTQUFTa0YsRUFBSTFFLFVBRWpCNEcsT0FBT1MsSUFDSlIsUUFBUUMsSUFBSU8sT0E4QlVuSixDQUFtQjRKLEdBQzdDM0osa0JBQW1CQSxJQUd2QnVJLEVBQVFxQixRQUFRRCxFQUFLRSxtQkFHbkJ0QixFQUFVLElHeEtULE1BQ0g3SSxZQUFZLEVBQWFvSyxHQUFtQixJQUFoQyxTQUFFQyxHQUE4QixFQUN4QzVKLEtBQUs2SixVQUFZRCxFQUNqQjVKLEtBQUs4SixXQUFhck0sU0FBU0UsY0FBY2dNLEdBRzdDdEIsWUFBWTBCLEdBQ1JBLEVBQU14RyxTQUFTL0QsSUFDWFEsS0FBSzZKLFVBQVVySyxNQUl2QmlLLFFBQVFPLEdBQ0poSyxLQUFLOEosV0FBV0csUUFBUUQsS0g0SjVCLENBQ0lKLFNBQVVkLEdBQ1gsYUEwQlBqTCxFQUFrQjBDLGlCQUFpQixTQWhCbkMsWUFOQSxXQUNJLE1BQU0ySixFQUFjM0MsRUFBU3RCLGNBQzdCaEksRUFBZW1ILE1BQVE4RSxFQUFZMUksS0FDbkN0RCxFQUFzQmtILE1BQVE4RSxFQUFZcEMsWUFJMUNxQyxHQUNBaEIsRUFBaUJoRixVQWdCckJwRyxFQUFpQndDLGlCQUFpQixTQWJsQyxXQUNJb0ksRUFBcUJ0RixnQkFDckJ3RixFQUFhMUUsVUFhakIvRixFQUFPbUMsaUJBQWlCLFNBVnhCLFdBQ0lxSSxFQUEwQnZGLGdCQUMxQjRGLEVBQWtCOUUsVSIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxyXG4gICAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBwb3B1cHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwXCIpO1xyXG5leHBvcnQgY29uc3QgZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGVsZW1lbnRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c1wiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpXHJcbiAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRcIik7XHJcblxyXG4vL3Byb2ZpbGUgbW9kZWwgYnV0dG9uc1xyXG5leHBvcnQgY29uc3QgZWRpdEJ1dHRvblByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgYWRkQnV0dG9uUHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuXHJcbi8vcG9wdXAgZWRpdCBwcm9maWxlXHJcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZVwiKTtcclxuXHJcbi8vcG9wdXAgZWRpdCBwcm9maWxlIGlucHV0c1xyXG5leHBvcnQgY29uc3QgcG9wdXBJbnB1dE5hbWUgPSBwb3B1cEVkaXRQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICBcIi5wb3B1cF9faW5wdXRfdHlwZV9uYW1lXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW5wdXREZXNjcmlwdGlvbiA9IHBvcHVwRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcihcclxuICAgIFwiLnBvcHVwX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uXCJcclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwb3B1cENoYW5nZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hdmF0YXItY2hhbmdlXCIpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcclxuXHJcbi8vZXhwb3J0IGNvbnN0IHBvcHVwRGVsZXRlQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hdmF0YXItY2hhbmdlXCIpO1xyXG4vL2V4cG9ydCBjb25zdCBkZWxldGVDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc2F2ZV90eXBlX2FkZC1jYXJkXCIpO1xyXG5cclxuXHJcbi8vcG9wdXAgYWRkIGNhcmRcclxuZXhwb3J0IGNvbnN0IHBvcHVwQWRkQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hZGQtY2FyZFwiKTtcclxuXHJcbi8vaW1hZ2UgcHJldmlld1xyXG5leHBvcnQgY29uc3QgcG9wdXBJbWFnZVByZXZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGUtcHJldmlld1wiKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW1hZ2UgPSBwb3B1cEltYWdlUHJldmlldy5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwVGl0bGUgPSBwb3B1cEltYWdlUHJldmlldy5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zdWJ0aXRsZVwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICAgIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zYXZlXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zYXZlX2Rpc2FibGVkXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcclxufVxyXG5cclxuIiwiZXhwb3J0IGZ1bmN0aW9uIG9wZW5Qb3B1cChwb3B1cFdpbmRvdykge1xyXG4gICAgcG9wdXBXaW5kb3cuY2xhc3NMaXN0LmFkZChcInBvcHVwX19vcGVuZWRcIik7XHJcbiAgICBhZGRLZXlEb3duTGlzdGVuZXIoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkS2V5RG93bkxpc3RlbmVyKCkge1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUtleURvd24pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVLZXlEb3duKGV2dCkge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgY29uc3Qgb3BlbmVkUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19vcGVuZWRcIik7XHJcbiAgICAgIG9wZW5lZFBvcHVwICYmIGNsb3NlUG9wdXAob3BlbmVkUG9wdXApXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbG9zZVBvcHVwKHBvcHVwV2luZG93KSB7XHJcbiAgICBwb3B1cFdpbmRvdy5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfX29wZW5lZFwiKTtcclxuICAgIHJlbW92ZUtleURvd25MaXN0ZW5lcigpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVLZXlEb3duTGlzdGVuZXIoKSB7XHJcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlS2V5RG93bik7XHJcbn1cclxuXHJcbiIsImltcG9ydCB7IG9wZW5Qb3B1cCB9IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiXHJcblxyXG5leHBvcnQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7ZGF0YSwgdXNlcklkLCB0ZW1wbGF0ZUNhcmRTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrLCBhY3RpdmF0ZUxpa2VCdXR0b24sIGhhbmRsZURlbGV0ZUNsaWNrfSkgeyAvL3t0ZXh0LGxpbmt9XHJcbiAgICAgICAgdGhpcy5fdGV4dCA9IGRhdGEubmFtZTsgXHJcbiAgICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgICAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICAgICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgICAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICAgICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkXHJcblxyXG4gICAgICAgIHRoaXMuX3RlbXBsYXRlQ2FyZFNlbGVjdG9yID0gdGVtcGxhdGVDYXJkU2VsZWN0b3JcclxuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2tcclxuICAgICAgICB0aGlzLl9hY3RpdmF0ZUxpa2VCdXR0b24gPSBhY3RpdmF0ZUxpa2VCdXR0b25cclxuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrXHJcblxyXG4gICAgICAgIHRoaXMuX2NhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGVtcGxhdGVDYXJkU2VsZWN0b3IpXHJcbiAgICAgICAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudFwiKTtcclxuICAgICAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgLy9fYWN0aXZhdGVMaWtlQnV0dG9uID0gZXZ0ID0+IGV2dC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShcImVsZW1lbnRfX2J1dHRvbi1saWtlX2FjdGl2ZVwiKTtcclxuXHJcbiAgICBnZXRJZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faWRcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2NhcmQucmVtb3ZlKCk7XHJcbiAgICAgICAgdGhpcy5fY2FyZCA9IG51bGw7Ly9cclxuICAgIH1cclxuICAgIFxyXG4gICAgX29wZW5JbWFnZVByZXZpZXcgPSAoKSA9PiB7XHJcbiAgICAgICAgcG9wdXBJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgICAgIHBvcHVwSW1hZ2UuYWx0ID0gdGhpcy5fdGV4dDtcclxuICAgICAgICBwb3B1cFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fdGV4dDtcclxuICAgICAgICBvcGVuUG9wdXAocG9wdXBJbWFnZVByZXZpZXcpO1xyXG4gICAgfTtcclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5fYWN0aXZhdGVMaWtlQnV0dG9uKCkpO1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcykpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX3RleHQsIHRoaXMuX2xpbmspKTsvLyh0aGlzLmRhdGEpXHJcbiAgICB9XHJcblxyXG4gICAgc2V0TGlrZXMobmV3TGlrZXMpIHtcclxuICAgICAgICB0aGlzLl9saWtlcyA9IG5ld0xpa2VzXHJcblxyXG4gICAgICAgIC8vIGNvbnN0IGxpa2VzQW1vdW50ID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2xpa2VzLWNvdW50XCIpO1xyXG4gICAgICAgIC8vIGxpa2VzQW1vdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG5cclxuICAgICAgICBjb25zdCBsaWtlc0Ftb3VudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICAgICAgICB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fbGlrZXMtY291bnRcIikudGV4dENvbnRlbnQgPSBsaWtlc0Ftb3VudDtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBjYXJkSXNMaWtlZEJ5VXNlciA9IHRoaXMuaXNMaWtlZCgpXHJcblxyXG4gICAgICAgIGlmIChjYXJkSXNMaWtlZEJ5VXNlcikge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJlbGVtZW50X19idXR0b24tbGlrZV9hY3RpdmVcIik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiZWxlbWVudF9fYnV0dG9uLWxpa2VfYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBpc0xpa2VkKCkge1xyXG4gICAgICAgcmV0dXJuIHRoaXMuX2xpa2VzLmZpbmQodXNlciA9PiB1c2VyLl9pZCA9PT0gdGhpcy5fdXNlcklkKSBcclxuICAgIH1cclxuXHJcbiAgICBnZXRDYXJkRWxlbWVudCA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jYXJkID0gdGhpcy5fY2FyZFRlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19idXR0b24tbGlrZVwiKTtcclxuICAgICAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fYnV0dG9uLWRlbGV0ZVwiKTtcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9faW1hZ2VcIik7XHJcbiAgICAgICAgY29uc3QgY2FyZFRpdGxlID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3RpdGxlXCIpO1xyXG5cclxuICAgICAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl90ZXh0O1xyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl90ZXh0O1xyXG4gICAgICAgICAgICAgXHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRMaWtlcyh0aGlzLl9saWtlcylcclxuXHJcbiAgICAgICAgaWYodGhpcy5fdXNlcklkICE9PSB0aGlzLl9vd25lcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19idXR0b24tZGVsZXRlXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIlxyXG4gICAgICAgIH1cclxuICAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcmQ7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG4iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzXHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudFxyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IFsuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpXTtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzfSA9IHRoaXMuX3NldHRpbmdzO1xyXG5cclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoZXJyb3JDbGFzcyk7XHJcbiAgICB9O1xyXG4gICAgICBcclxuICAgIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JDbGFzc30gPSB0aGlzLl9zZXR0aW5ncztcclxuXHJcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShlcnJvckNsYXNzKTtcclxuICAgIH07XHJcblxyXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eSA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIHRoaXMuX3NldHRpbmdzKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIF9oYXNJbnZhbGlkSW5wdXQgPSAoKSA9PiB0aGlzLl9pbnB1dExpc3QuZXZlcnkoaW5wdXRFbGVtZW50ID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XHJcblxyXG4gICAgXHJcbiAgICBkaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgICAgIGNvbnN0IHsgaW5hY3RpdmVCdXR0b25DbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgX2VuYWJsZUJ1dHRvbigpIHtcclxuICAgICAgICBjb25zdCB7IGluYWN0aXZlQnV0dG9uQ2xhc3MgfSA9IHRoaXMuX3NldHRpbmdzO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB0b2dnbGVCdXR0b25TdGF0ZSA9ICgpID0+IHtcclxuICAgICAgICBcclxuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgICAgICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgaW5wdXRTZWxlY3RvciB9ID0gdGhpcy5fc2V0dGluZ3NcclxuICAgICAgICAvL2NvbnN0IGJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgICAgICBcclxuICAgICAgXHJcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpOyAvL3RvZ2dsZSBzdWJtaXRcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7IC8vY2hlY2sgdmFsaWRpdHlcclxuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpOyAvL3RvZ2dsZSBzdWJtaXRcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgICAgXHJcbiAgICAvLyByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICAvLyAgICAgdGhpcy5pbnB1dExpc3QuZm9yRWFjaChpbnB1dCA9PiB7XHJcbiAgICAvLyAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KVxyXG4gICAgLy8gICAgIH0pXHJcbiAgICAvLyB9XHJcblxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgICB9O1xyXG4gICAgXHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yIiwiZXhwb3J0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3RvcilcclxuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcylcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICAgICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9wZW4oKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX19vcGVuZWRcIik7XHJcbiAgICAgICAgdGhpcy5hZGRLZXlEb3duTGlzdGVuZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRLZXlEb3duTGlzdGVuZXIoKSB7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfX29wZW5lZFwiKTtcclxuICAgICAgICB0aGlzLnJlbW92ZUtleURvd25MaXN0ZW5lcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUtleURvd25MaXN0ZW5lcigpIHtcclxuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXZ0LnRhcmdldC5tYXRjaGVzKFwiLnBvcHVwXCIpIHx8IGV2dC50YXJnZXQubWF0Y2hlcyhcIi5wb3B1cF9fY2xvc2VcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgXHJcbiAgICB9XHJcbiAgIFxyXG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cHtcclxuICAgIGNvbnN0cnVjdG9yKHBvdXBTZWxlY3RvciwgaGFuZGxlclN1Ym1pdCkge1xyXG4gICAgICAgIHN1cGVyKHBvdXBTZWxlY3RvcilcclxuXHJcbiAgICAgICAgdGhpcy5faGFuZGxlclN1Ym1pdCA9IGhhbmRsZXJTdWJtaXRcclxuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKVxyXG4gICAgXHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zYXZlXCIpXHJcbiAgICAgICAgdGhpcy5faW5pdGlhbEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnRcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAgICAgY29uc3QgdmFsdWVzID0ge31cclxuXHJcbiAgICAgICAgY29uc3QgaW5wdXRzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIildXHJcblxyXG4gICAgICAgIGlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBrZXkgPSBpbnB1dC5uYW1lXHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gaW5wdXQudmFsdWVcclxuICAgICAgICBcclxuICAgICAgICAgICAgdmFsdWVzW2tleV0gPSB2YWx1ZVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHJldHVybiB2YWx1ZXNcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpXHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVyU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICAgICAgICAvL3RoaXMuY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNoYW5nZVN1Ym1pdEhhbmRsZXIobmV3U3VibWl0SGFuZGxlcikge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZXJTdWJtaXQgPSBuZXdTdWJtaXRIYW5kbGVyO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGNoYW5nZVRleHQodGV4dFR5cGUpIHsvLyBpbml0YWwgTG9hZGluZ1xyXG4gICAgLy8gICAgIC8vY29uc3QgYnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zYXZlXCIpXHJcbiAgICAgICAgXHJcbiAgICAvLyAgICAgLy9idXR0b24udGV4dENvbnRlbnQgPSB0ZXh0XHJcblxyXG4gICAgLy8gICAgIGlmKHRleHRUeXBlID09PSBcInNhdmluZ1wiKSB7XHJcbiAgICAvLyAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCJcclxuICAgIC8vICAgICB9XHJcblxyXG4gICAgLy8gICAgIGlmKHRleHRUeXBlID09PSBcImluaXRpYWxcIikge1xyXG4gICAgLy8gICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9pbml0aWFsQnV0dG9uVGV4dFxyXG4gICAgLy8gICAgIH1cclxuICAgIC8vIH1cclxuICAgIFxyXG4gICAgY2hhbmdlVGV4dCh0ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGV4dFxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHN1cGVyLmNsb3NlKClcclxuICAgICAgICB0aGlzLl9mb3JtLnJlc2V0KClcclxuICAgIH1cclxufSIsImNsYXNzIEFwaSB7XHJcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmxcclxuICAgICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVyc1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbihyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSlcclxuICAgICAgfVxyXG4gICAgXHJcbiAgICBnZXRDYXJkcygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL2NhcmRzXCIsIHtcclxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHJlcyA9PiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1c1RleHQpKVxyXG4gICAgICB9XHJcblxyXG4gICAgZWRpdFByb2ZpbGUobmFtZSwgYWJvdXQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL3VzZXJzL21lXCIsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIG5hbWUsXHJcbiAgICAgICAgICAgICAgICBhYm91dFxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbihyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSlcclxuICAgICAgfVxyXG5cclxuICAgIGVkaXRBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi91c2Vycy9tZS9hdmF0YXJcIiwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgYXZhdGFyXHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHJlcyA9PiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1c1RleHQpKVxyXG4gICAgICB9ICBcclxuXHJcbiAgICBhZGRDYXJkKG5hbWUsIGxpbmspIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL2NhcmRzXCIsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgICAgIGxpbmssXHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHJlcyA9PiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1c1RleHQpKVxyXG4gICAgICB9XHJcblxyXG4gICAgYWRkTGlrZShpZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHMvbGlrZXMvXCIgKyBpZCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbihyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSlcclxuICAgICAgfVxyXG5cclxuICAgIHJlbW92ZUxpa2UoaWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL2NhcmRzL2xpa2VzL1wiICsgaWQsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4ocmVzID0+IHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzVGV4dCkpXHJcbiAgICAgIH1cclxuXHJcbiAgICByZW1vdmVMaWtlKGlkKSB7XHJcbiAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHMvbGlrZXMvXCIgKyBpZCwge1xyXG4gICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbihyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSlcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHMvXCIgKyBpZCwge1xyXG4gICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbihyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSlcclxuICAgICAgXHJcbiAgICB9XHJcblxyXG4gIH1cclxuICBcclxuICAgIGV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICAgIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtMy1lblwiLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICBhdXRob3JpemF0aW9uOiBcIjRjZGFlMzE0LTdlOGEtNGJlZC04YWRhLTcwYWQzM2MxMmUxM1wiLFxyXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgfVxyXG4gIH0pOyIsImltcG9ydCBcIi4vLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQgXCIuLy4uL2ZvbnRzL2ZvbnQuY3NzXCI7XG5pbXBvcnQgeyBlbGVtZW50TGlzdCwgZWRpdEJ1dHRvblByb2ZpbGUsIGFkZEJ1dHRvblByb2ZpbGUsIHBvcHVwRWRpdFByb2ZpbGUsIHBvcHVwSW5wdXROYW1lLCBwb3B1cElucHV0RGVzY3JpcHRpb24sIHBvcHVwQWRkQ2FyZCwgc2V0dGluZ3MsIHBvcHVwQ2hhbmdlQXZhdGFyLCBhdmF0YXIsIHBvcHVwRGVsZXRlQ2FyZH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiXG5pbXBvcnQgeyBDYXJkfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCJcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIlxuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIlxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiXG5cbmltcG9ydCB7IGFwaX0gZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiXG5cblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICAgIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIiwgXG4gICAgam9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXG4gICAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCJcbn0pXG5cblxubGV0IHVzZXJJZFxuXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRDYXJkcygpXSlcbiAgICAudGhlbigoW3VzZXJEYXRhLCBjYXJkc10pID0+IHtcbiAgICAgICAgdXNlcklkID0gdXNlckRhdGEuX2lkXG5cbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEubmFtZSwgdXNlckRhdGEuYWJvdXQsIHVzZXJEYXRhLmF2YXRhcilcbiAgICAgICAgc2VjdGlvbi5yZW5kZXJJdGVtcyhjYXJkcylcbn0pXG4gICAgLmNhdGNoKGNvbnNvbGUubG9nKVxuXG5cbi8vIHZhbGlkYXRvcnMgICAgXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBwb3B1cEVkaXRQcm9maWxlKVxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgcG9wdXBBZGRDYXJkKVxuY29uc3QgY2hhbmdlQXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBwb3B1cENoYW5nZUF2YXRhcilcblxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuY2hhbmdlQXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vIHN1Ym1pdCBoYW5kbGVycyBvZiBtb2RhbHNcbmNvbnN0IGhhbmRsZUFkZENhcmRTdWJtaXQgPSAoZGF0YSkgPT4ge1xuICAgIGFkZENhcmRQb3B1cC5jaGFuZ2VUZXh0KFwic2F2aW5nLi4uXCIpICBcbiAgICBhcGkuYWRkQ2FyZChkYXRhW1wiY2FyZC10aXRsZVwiXSwgZGF0YVtcImNhcmQtbGlua1wiXSlcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZW5kZXJDYXJkKHJlcywgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIGVsZW1lbnRMaXN0XG4gICAgICAgICAgKTtcbiAgICAgICAgICAvL2FkZENhcmRQb3B1cC5jaGFuZ2VUZXh0KFwiaW5pdGlhbFwiKSBcbiAgICAgICAgICBhZGRDYXJkUG9wdXAuY2hhbmdlVGV4dChcIkNyZWF0ZVwiKSBcbiAgICAgICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSlcbiAgICAuZmluYWxseSgoKSA9PntcbiAgICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKClcbiAgICAgICAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpXG4gICAgfSkgICAgXG59XG5cbmNvbnN0IGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0ID0gKGRhdGEpID0+IHtcbmVkaXRQcm9maWxlUG9wdXAuY2hhbmdlVGV4dChcInNhdmluZy4uLlwiKVxuICAgIGFwaS5lZGl0UHJvZmlsZShkYXRhLk5hbWUsIGRhdGEuZGVzY3JpcHRpb24pXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzLm5hbWUsIHJlcy5hYm91dCwgcmVzLmF2YXRhcilcbiAgICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jaGFuZ2VUZXh0KFwiU2F2ZVwiKVxuICAgIFxuICAgICAgICBlZGl0UHJvZmlsZVBvcHVwLmNsb3NlKClcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+e1xuICAgICAgICBcbiAgICB9KVxufVxuXG5cbmNvbnN0IGhhbmRsZUF2YXRhclN1Ym1pdCA9IChkYXRhKSA9PiB7XG4gICAgYXZhdGFyQ2hhbmdlUG9wdXAuY2hhbmdlVGV4dChcInNhdmluZy4uLlwiKVxuICAgIGFwaS5lZGl0QXZhdGFyKGRhdGFbXCJjYXJkLWxpbmtcIl0pXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMuYXZhdGFyKVxuICAgICAgICBhdmF0YXJDaGFuZ2VQb3B1cC5jaGFuZ2VUZXh0KFwiU2F2ZVwiKVxuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT57XG4gICAgICAgIGF2YXRhckNoYW5nZVBvcHVwLmNsb3NlKClcbiAgICB9KVxufVxuXG4vLyBpbnN0YW5jZXMgb2YgbW9kYWxzXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF90eXBlX2FkZC1jYXJkXCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpXG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKVxuXG5jb25zdCBhdmF0YXJDaGFuZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfYXZhdGFyLWNoYW5nZVwiLCBoYW5kbGVBdmF0YXJTdWJtaXQpXG5hdmF0YXJDaGFuZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfY29uZmlybS1kZWxldGVcIilcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZVwiLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdClcbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKVxuXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLnBvcHVwX3R5cGUtcHJldmlld1wiKVxuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IHRlbXBsYXRlQ2FyZFNlbGVjdG9yID0gXCIjY2FyZC10ZW1wbGF0ZVwiXG5cbmNvbnN0IGhhbmRsZUNhcmRDbGljayA9IChkYXRhKSA9PiB7XG4gICAgaW1hZ2VQb3B1cC5vcGVuKGRhdGEubmFtZSwgZGF0YS5saW5rKVxufVxuXG5jb25zdCBhY3RpdmF0ZUxpa2VCdXR0b24gPSAoY2FyZCkgPT4ge1xuICAgIGlmKGNhcmQuaXNMaWtlZCgpKSB7XG4gICAgICAgIGFwaS5yZW1vdmVMaWtlKGNhcmQuZ2V0SWQoKSlcbiAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcylcbiAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGFwaS5hZGRMaWtlKGNhcmQuZ2V0SWQoKSlcbiAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcylcbiAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICB9KVxuICAgIH1cbn0gICAgIFxuXG5jb25zdCBoYW5kbGVEZWxldGVDbGljayA9IChjYXJkKSA9PiB7XG4gICAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKVxuXG4gICAgZGVsZXRlQ2FyZFBvcHVwLmNoYW5nZVN1Ym1pdEhhbmRsZXIoKCkgPT4ge1xuICAgICAgICBkZWxldGVDYXJkUG9wdXAuY2hhbmdlVGV4dChcImRlbGV0aW5nLi4uXCIpXG4gICAgICAgIGFwaS5kZWxldGVDYXJkKGNhcmQuZ2V0SWQoKSlcbiAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBjYXJkLnJlbW92ZUNhcmQoKVxuICAgICAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLmNoYW5nZVRleHQoXCJZZXNcIikgIFxuICAgICAgICAgICB9KVxuICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICB9KVxuICAgICAgICAuZmluYWxseSgoKSA9PntcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpXG4gICAgICAgIH0pXG4gIH0pXG59XG5cbmNvbnN0IHJlbmRlckNhcmQgPSAoZGF0YSkgPT4ge1xuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZCh7XG4gICAgICAgIGRhdGEsXG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgdGVtcGxhdGVDYXJkU2VsZWN0b3IsXG4gICAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4gaGFuZGxlQ2FyZENsaWNrKGRhdGEpLCBcbiAgICAgICAgYWN0aXZhdGVMaWtlQnV0dG9uOiAoKSA9PiBhY3RpdmF0ZUxpa2VCdXR0b24oY2FyZCksXG4gICAgICAgIGhhbmRsZURlbGV0ZUNsaWNrOiBoYW5kbGVEZWxldGVDbGlja1xuICAgIH1cbiAgICApICAgIFxuICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkLmdldENhcmRFbGVtZW50KCkpO1xufVxuXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAgeyAgXG4gICAgICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkIFxuICAgIH0sIFwiLmVsZW1lbnRzXCJcbiAgICApXG5cblxuZnVuY3Rpb24gZmlsbFByb2ZpbGVGb3JtKCkge1xuICAgIGNvbnN0IHByb2ZpbGVEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKVxuICAgIHBvcHVwSW5wdXROYW1lLnZhbHVlID0gcHJvZmlsZURhdGEubmFtZTtcbiAgICBwb3B1cElucHV0RGVzY3JpcHRpb24udmFsdWUgPSBwcm9maWxlRGF0YS5kZXNjcmlwdGlvbjtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRWRpdEJ1dHRvbkNsaWNrKCkge1xuICAgIGZpbGxQcm9maWxlRm9ybSgpO1xuICAgIGVkaXRQcm9maWxlUG9wdXAub3BlbigpXG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZEJ1dHRvbkNsaWNrKCkge1xuICAgIGFkZENhcmRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKVxuICAgIGFkZENhcmRQb3B1cC5vcGVuKClcbn1cblxuZnVuY3Rpb24gaGFuZGxlQ2hhbmdlQXZhdGFyQ2xpY2soKSB7XG4gICAgY2hhbmdlQXZhdGFyRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKClcbiAgICBhdmF0YXJDaGFuZ2VQb3B1cC5vcGVuKClcbn1cblxuXG5lZGl0QnV0dG9uUHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlRWRpdEJ1dHRvbkNsaWNrKTtcblxuYWRkQnV0dG9uUHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQWRkQnV0dG9uQ2xpY2spO1xuXG5hdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNoYW5nZUF2YXRhckNsaWNrKTsiLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoIHtuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcn0pIHtcclxuICAgICAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKVxyXG4gICAgICAgIHRoaXMuX3VzZXJEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpXHJcbiAgICAgICAgdGhpcy5fYXZhdGFyUGljID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3RvcilcclxuICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgbmFtZTogdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuX3VzZXJEZXNjcmlwdGlvbi50ZXh0Q29udGVudCxcclxuICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyhuYW1lLCBkZXNjcmlwdGlvbiwgYXZhdGFyKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX3VzZXJEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gICAgICAgIC8vdGhpcy5fYXZhdGFyUGljLnNyYyA9IGF2YXRhclxyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyUGljLnNyYyA9IGF2YXRhcjtcclxuICAgIH1cclxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICAgIC8vIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIC8vICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKVxyXG5cclxuICAgIC8vIH1cclxuXHJcbiAgICBvcGVuKG5hbWUsIGxpbmspIHtcclxuICAgICAgICBzdXBlci5vcGVuKClcclxuXHJcbiAgICAgICAgY29uc3QgY2FwdGlvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3N1YnRpdGxlXCIpXHJcbiAgICAgICAgY29uc3QgaW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lXHJcbiAgICAgICAgaW1hZ2Uuc3JjID0gbGlua1xyXG4gICAgICAgIGltYWdlLmFsdCA9IChgIGltYWdlIG9mICR7bmFtZX1gKVxyXG4gICAgICAgIFxyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IoeyByZW5kZXJlcn0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlclxyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpXHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgICAgICBpdGVtcy5mb3JFYWNoKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGRhdGEpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudClcclxuICAgIH1cclxufSJdLCJuYW1lcyI6WyJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJxdWVyeVNlbGVjdG9yIiwiZWxlbWVudExpc3QiLCJlZGl0QnV0dG9uUHJvZmlsZSIsImNvbnRlbnQiLCJhZGRCdXR0b25Qcm9maWxlIiwicG9wdXBFZGl0UHJvZmlsZSIsInBvcHVwSW5wdXROYW1lIiwicG9wdXBJbnB1dERlc2NyaXB0aW9uIiwicG9wdXBDaGFuZ2VBdmF0YXIiLCJhdmF0YXIiLCJwb3B1cEFkZENhcmQiLCJwb3B1cEltYWdlUHJldmlldyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoYW5kbGVLZXlEb3duIiwiZXZ0Iiwia2V5Iiwib3BlbmVkUG9wdXAiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ3aW5kb3ciLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsInVzZXJJZCIsInRlbXBsYXRlQ2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiYWN0aXZhdGVMaWtlQnV0dG9uIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJwb3B1cEltYWdlIiwic3JjIiwidGhpcyIsIl9saW5rIiwiYWx0IiwiX3RleHQiLCJwb3B1cFRpdGxlIiwidGV4dENvbnRlbnQiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2xpa2VCdXR0b24iLCJfYWN0aXZhdGVMaWtlQnV0dG9uIiwiX2RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9jYXJkSW1hZ2UiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2NhcmQiLCJfY2FyZFRlbXBsYXRlIiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwic2V0TGlrZXMiLCJfbGlrZXMiLCJfdXNlcklkIiwiX293bmVySWQiLCJzdHlsZSIsImRpc3BsYXkiLCJuYW1lIiwibGluayIsImxpa2VzIiwiX2lkIiwib3duZXIiLCJfdGVtcGxhdGVDYXJkU2VsZWN0b3IiLCJnZXRJZCIsInJlbW92ZUNhcmQiLCJuZXdMaWtlcyIsImxpa2VzQW1vdW50IiwibGVuZ3RoIiwiaXNMaWtlZCIsImZpbmQiLCJ1c2VyIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJfc2V0dGluZ3MiLCJlcnJvckVsZW1lbnQiLCJfZm9ybUVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsIl9pbnB1dExpc3QiLCJldmVyeSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfZW5hYmxlQnV0dG9uIiwiZGlzYWJsZUJ1dHRvbiIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfYnV0dG9uRWxlbWVudCIsImRpc2FibGVkIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsImNsb3NlIiwib3BlbiIsImFkZEtleURvd25MaXN0ZW5lciIsInJlbW92ZUtleURvd25MaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwibWF0Y2hlcyIsIlBvcHVwV2l0aEZvcm0iLCJwb3VwU2VsZWN0b3IiLCJoYW5kbGVyU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlclN1Ym1pdCIsIl9mb3JtIiwiX3N1Ym1pdEJ1dHRvbiIsIl9pbml0aWFsQnV0dG9uVGV4dCIsIl9nZXRJbnB1dFZhbHVlcyIsInZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJlIiwiY2hhbmdlU3VibWl0SGFuZGxlciIsIm5ld1N1Ym1pdEhhbmRsZXIiLCJjaGFuZ2VUZXh0IiwidGV4dCIsInJlc2V0IiwiYXBpIiwib3B0aW9ucyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1c1RleHQiLCJnZXRDYXJkcyIsImVkaXRQcm9maWxlIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVkaXRBdmF0YXIiLCJhZGRDYXJkIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJkZWxldGVDYXJkIiwiYXV0aG9yaXphdGlvbiIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl91c2VyTmFtZSIsIl91c2VyRGVzY3JpcHRpb24iLCJfYXZhdGFyUGljIiwiZGVzY3JpcHRpb24iLCJzZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzIiwic2VjdGlvbiIsInJlbmRlckl0ZW1zIiwiY2F0Y2giLCJjb25zb2xlIiwibG9nIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiLCJjaGFuZ2VBdmF0YXJGb3JtVmFsaWRhdG9yIiwiYWRkQ2FyZFBvcHVwIiwicmVuZGVyQ2FyZCIsImVyciIsImZpbmFsbHkiLCJhdmF0YXJDaGFuZ2VQb3B1cCIsImRlbGV0ZUNhcmRQb3B1cCIsImVkaXRQcm9maWxlUG9wdXAiLCJOYW1lIiwiaW1hZ2VQb3B1cCIsImNhcHRpb24iLCJpbWFnZSIsImNhcmQiLCJhZGRJdGVtIiwiZ2V0Q2FyZEVsZW1lbnQiLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsIml0ZW1zIiwiZWxlbWVudCIsInByZXBlbmQiLCJwcm9maWxlRGF0YSIsImZpbGxQcm9maWxlRm9ybSJdLCJzb3VyY2VSb290IjoiIn0=