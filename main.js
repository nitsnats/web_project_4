!function(){"use strict";document.querySelectorAll(".popup"),document.querySelector(".popup__form");const e=document.querySelector(".elements"),t=(document.querySelector("#card-template").content.querySelector(".element"),document.querySelector(".profile__edit-button")),s=document.querySelector(".profile__add-button"),i=document.querySelector(".popup_type_edit-profile"),n=i.querySelector(".popup__input_type_name"),r=i.querySelector(".popup__input_type_description"),o=document.querySelector(".popup_type_avatar-change"),a=document.querySelector(".profile__image"),l=document.querySelector(".popup_type_add-card"),c=document.querySelector(".popup_type-preview"),h=(c.querySelector(".popup__image"),c.querySelector(".popup__subtitle"),{formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"});function d(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class _{constructor(e){let{data:t,userId:s,templateCardSelector:i,handleCardClick:n,activateLikeButton:r,handleDeleteClick:o}=e;d(this,"_setEventListeners",(()=>{this._likeButton.addEventListener("click",(()=>this._activateLikeButton())),this._deleteButton.addEventListener("click",(()=>this._handleDeleteClick(this))),this._cardImage.addEventListener("click",(()=>this._handleCardClick(this._text,this._link)))})),d(this,"getCardElement",(()=>{this._card=this._cardTemplate.cloneNode(!0),this._likeButton=this._card.querySelector(".element__button-like"),this._deleteButton=this._card.querySelector(".element__button-delete"),this._cardImage=this._card.querySelector(".element__image");const e=this._card.querySelector(".element__title");return this._likesCounter=this._card.querySelector(".element__likes-count"),e.textContent=this._text,this._cardImage.src=this._link,this._cardImage.alt=this._text,this._setEventListeners(),this.setLikes(this._likes),this._userId!==this._ownerId&&(this._likeButton.style.display="none"),this._card})),this._text=t.name,this._link=t.link,this._likes=t.likes,this._id=t._id,this._userId=s,this._ownerId=t.owner._id,this._templateCardSelector=i,this._handleCardClick=n,this._activateLikeButton=r,this._handleDeleteClick=o,this._cardTemplate=document.querySelector(i).content.querySelector(".element")}getId(){return this._id}removeCard(){this._card.remove(),this._card=null}setLikes(e){this._likes=e,this._card.querySelector(".element__likes-count").textContent=this._likes.length,this.isLiked()?this._likeButton.classList.add("element__button-like_active"):this._likeButton.classList.remove("element__button-like_active")}isLiked(){return this._likes.find((e=>e._id===this._userId))}}function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var p=class{constructor(e,t){u(this,"_showInputError",(e=>{const{inputErrorClass:t,errorClass:s}=this._settings,i=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(t),i.textContent=e.validationMessage,i.classList.add(s)})),u(this,"_hideInputError",(e=>{const{inputErrorClass:t,errorClass:s}=this._settings,i=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(t),i.textContent="",i.classList.remove(s)})),u(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,this._settings)})),u(this,"_hasInvalidInput",(()=>this._inputList.every((e=>e.validity.valid)))),u(this,"toggleButtonState",(()=>{this._hasInvalidInput()?this._enableButton():this.disableButton()})),u(this,"_setEventListeners",(()=>{const{inputSelector:e}=this._settings;this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))})),this._settings=e,this._formElement=t,this._inputList=[...this._formElement.querySelectorAll(this._settings.inputSelector)],this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSelector)}disableButton(){const{inactiveButtonClass:e}=this._settings;this._buttonElement.disabled=!0,this._buttonElement.classList.add(e)}_enableButton(){const{inactiveButtonClass:e}=this._settings;this._buttonElement.disabled=!1,this._buttonElement.classList.remove(e)}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};class m{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popup.classList.add("popup__opened"),this.addKeyDownListener()}addKeyDownListener(){window.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup__opened"),this.removeKeyDownListener()}removeKeyDownListener(){window.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.matches(".popup")||e.target.matches(".popup__close"))&&this.close()}))}}class v extends m{constructor(e,t){super(e),this._handlerSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._submitButton=this._form.querySelector(".popup__save"),this._initialButtonText=this._submitButton.textContent,this._inputs=[...this._form.querySelectorAll(".popup__input")]}_getInputValues(){const e={};return this._inputs.forEach((t=>{const s=t.name,i=t.value;e[s]=i})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handlerSubmit(this._getInputValues())}))}changeSubmitHandler(e){this._handlerSubmit=e}changeText(e){this._submitButton.textContent=e}close(){super.close(),this._form.reset()}}const y=new class{constructor(e){var t,s;s=e=>e.ok?e.json():Promise.reject(e.statusText),(t="_checkResponse")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._baseUrl=e.baseUrl,this._headers=e.headers}getUserInfo(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then(this._checkResponse)}getCards(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then(this._checkResponse)}editProfile(e,t){return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}editAvatar(e){return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}addCard(e,t){return fetch(this._baseUrl+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}addLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then(this._checkResponse)}removeLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}removeLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}deleteCard(e){return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"4cdae314-7e8a-4bed-8ada-70ad33c12e13","Content-Type":"application/json"}}),g=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._userName=document.querySelector(t),this._userDescription=document.querySelector(s),this._avatarPic=document.querySelector(i)}getUserInfo(){return{name:this._userName.textContent,description:this._userDescription.textContent}}setUserInfo(e,t,s){this._userName.textContent=e,this._userDescription.textContent=t}setUserAvatar(e){this._avatarPic.src=e}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"});let k;Promise.all([y.getUserInfo(),y.getCards()]).then((e=>{let[t,s]=e;k=t._id,g.setUserInfo(t.name,t.about,t.avatar),x.renderItems(s)})).catch(console.log);const b=new p(h,i),f=new p(h,l),S=new p(h,o);b.enableValidation(),f.enableValidation(),S.enableValidation();const E=new v(".popup_type_add-card",(t=>{E.changeText("saving..."),y.addCard(t["card-title"],t["card-link"]).then((t=>{B(t,e)})).then((()=>{E.close()})).catch((e=>{console.log(e)})).finally((()=>{E.changeText("Create")}))}));E.setEventListeners();const L=new v(".popup_type_avatar-change",(e=>{L.changeText("saving..."),y.editAvatar(e["card-link"]).then((e=>{g.setUserAvatar(e.avatar)})).then((()=>{L.close()})).catch((e=>{console.log(e)})).finally((()=>{L.changeText("Save")}))}));L.setEventListeners();const C=new v(".popup_type_confirm-delete");C.setEventListeners();const q=new v(".popup_type_edit-profile",(e=>{q.changeText("saving..."),y.editProfile(e.Name,e.description).then((e=>{g.setUserInfo(e.name,e.about,e.avatar)})).then((()=>{q.close()})).catch((e=>{console.log(e)})).finally((()=>{q.changeText("Save")}))}));q.setEventListeners();const I=new class extends m{constructor(e){super(e),this._caption=this._popup.querySelector(".popup__subtitle"),this._image=this._popup.querySelector(".popup__image")}open(e,t){super.open(),this._caption.textContent=e,this._image.src=t,this._image.alt=" image of ".concat(e)}}(".popup_type-preview");I.setEventListeners();const w=e=>{C.open(),C.changeSubmitHandler((()=>{C.changeText("deleting..."),y.deleteCard(e.getId()).then((()=>{e.removeCard()})).then((()=>{C.close()})).catch((e=>{console.log(e)})).finally((()=>{C.changeText("Yes")}))}))},B=e=>{const t=new _({data:e,userId:k,templateCardSelector:"#card-template",handleCardClick:()=>(e=>{I.open(e.name,e.link)})(e),activateLikeButton:()=>(e=>{e.isLiked()?y.removeLike(e.getId()).then((t=>{e.setLikes(t.likes)})).catch((e=>{console.log(e)})):y.addLike(e.getId()).then((t=>{e.setLikes(t.likes)})).catch((e=>{console.log(e)}))})(t),handleDeleteClick:w});x.addItem(t.getCardElement())},x=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:B},".elements");t.addEventListener("click",(function(){!function(){const e=g.getUserInfo();n.value=e.name,r.value=e.description}(),q.open()})),s.addEventListener("click",(function(){f.disableButton(),E.open()})),a.addEventListener("click",(function(){S.disableButton(),L.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBMkJzQkEsU0FBU0MsaUJBQWlCLFVBQzNCRCxTQUFTRSxjQUFjLGdCQTVCckMsTUE4Qk1DLEVBQWNILFNBQVNFLGNBQWMsYUFNckNFLEdBTGVKLFNBQ3ZCRSxjQUFjLGtCQUNkRyxRQUFRSCxjQUFjLFlBR01GLFNBQVNFLGNBQWMsMEJBQzNDSSxFQUFtQk4sU0FBU0UsY0FBYyx3QkFHMUNLLEVBQW1CUCxTQUFTRSxjQUFjLDRCQUcxQ00sRUFBaUJELEVBQWlCTCxjQUMzQywyQkFFU08sRUFBd0JGLEVBQWlCTCxjQUNsRCxrQ0FHU1EsRUFBb0JWLFNBQVNFLGNBQWMsNkJBQzNDUyxFQUFTWCxTQUFTRSxjQUFjLG1CQU9oQ1UsRUFBZVosU0FBU0UsY0FBYyx3QkFHdENXLEVBQW9CYixTQUFTRSxjQUFjLHVCQUkzQ1ksR0FIYUQsRUFBa0JYLGNBQWMsaUJBQ2hDVyxFQUFrQlgsY0FBYyxvQkFFbEMsQ0FDcEJhLGFBQWMsZUFDZEMsY0FBZSxnQkFDZkMscUJBQXNCLGVBQ3RCQyxvQkFBcUIsdUJBQ3JCQyxnQkFBaUIsMEJBQ2pCQyxXQUFZLHlCLHdIQ3ZFVCxNQUFNQyxFQUNUQyxZQUFZLEdBQThGLElBQTlGLEtBQUNDLEVBQUQsT0FBT0MsRUFBUCxxQkFBZUMsRUFBZixnQkFBcUNDLEVBQXJDLG1CQUFzREMsRUFBdEQsa0JBQTBFQyxHQUFvQiwrQkE2QnJGLEtBQ2pCQyxLQUFLQyxZQUFZQyxpQkFBaUIsU0FBUyxJQUFNRixLQUFLRyx3QkFDdERILEtBQUtJLGNBQWNGLGlCQUFpQixTQUFTLElBQU1GLEtBQUtLLG1CQUFtQkwsUUFDM0VBLEtBQUtNLFdBQVdKLGlCQUFpQixTQUFTLElBQU1GLEtBQUtPLGlCQUFpQlAsS0FBS1EsTUFBT1IsS0FBS1MsWUFoQ2UseUJBeUR6RixLQUNiVCxLQUFLVSxNQUFRVixLQUFLVyxjQUFjQyxXQUFVLEdBRTFDWixLQUFLQyxZQUFjRCxLQUFLVSxNQUFNckMsY0FBYyx5QkFDNUMyQixLQUFLSSxjQUFnQkosS0FBS1UsTUFBTXJDLGNBQWMsMkJBQzlDMkIsS0FBS00sV0FBYU4sS0FBS1UsTUFBTXJDLGNBQWMsbUJBQzNDLE1BQU13QyxFQUFZYixLQUFLVSxNQUFNckMsY0FBYyxtQkFnQjNDLE9BZEEyQixLQUFLYyxjQUFnQmQsS0FBS1UsTUFBTXJDLGNBQWMseUJBRTlDd0MsRUFBVUUsWUFBY2YsS0FBS1EsTUFDN0JSLEtBQUtNLFdBQVdVLElBQU1oQixLQUFLUyxNQUMzQlQsS0FBS00sV0FBV1csSUFBTWpCLEtBQUtRLE1BRTNCUixLQUFLa0IscUJBRUxsQixLQUFLbUIsU0FBU25CLEtBQUtvQixRQUVoQnBCLEtBQUtxQixVQUFZckIsS0FBS3NCLFdBQ3JCdEIsS0FBS0MsWUFBWXNCLE1BQU1DLFFBQVUsUUFHOUJ4QixLQUFLVSxTQTlFWlYsS0FBS1EsTUFBUWQsRUFBSytCLEtBQ2xCekIsS0FBS1MsTUFBUWYsRUFBS2dDLEtBQ2xCMUIsS0FBS29CLE9BQVMxQixFQUFLaUMsTUFDbkIzQixLQUFLNEIsSUFBTWxDLEVBQUtrQyxJQUNoQjVCLEtBQUtxQixRQUFVMUIsRUFDZkssS0FBS3NCLFNBQVc1QixFQUFLbUMsTUFBTUQsSUFFM0I1QixLQUFLOEIsc0JBQXdCbEMsRUFDN0JJLEtBQUtPLGlCQUFtQlYsRUFDeEJHLEtBQUtHLG9CQUFzQkwsRUFDM0JFLEtBQUtLLG1CQUFxQk4sRUFFMUJDLEtBQUtXLGNBQWdCeEMsU0FBU0UsY0FBY3VCLEdBQ3ZDcEIsUUFBUUgsY0FBYyxZQU0vQjBELFFBQ0ksT0FBTy9CLEtBQUs0QixJQUdoQkksYUFDSWhDLEtBQUtVLE1BQU11QixTQUNYakMsS0FBS1UsTUFBUSxLQVNqQlMsU0FBU2UsR0FDTGxDLEtBQUtvQixPQUFTYyxFQUVNbEMsS0FBS1UsTUFBTXJDLGNBQWMseUJBQ2pDMEMsWUFBY2YsS0FBS29CLE9BQU9lLE9BS1puQyxLQUFLb0MsVUFHM0JwQyxLQUFLQyxZQUFZb0MsVUFBVUMsSUFBSSwrQkFFL0J0QyxLQUFLQyxZQUFZb0MsVUFBVUosT0FBTywrQkFJMUNHLFVBQ0csT0FBT3BDLEtBQUtvQixPQUFPbUIsTUFBS0MsR0FBUUEsRUFBS1osTUFBUTVCLEtBQUtxQixXLHdIQzRDekQsTUFuR08sTUFDSDVCLFlBQVlSLEVBQVV3RCxHQUFhLDBCQVFoQkMsSUFDZixNQUFNLGdCQUFFcEQsRUFBRixXQUFtQkMsR0FBY1MsS0FBSzJDLFVBRXRDQyxFQUFlNUMsS0FBSzZDLGFBQWF4RSxjQUFsQixXQUFvQ3FFLEVBQWFJLEdBQWpELFdBQ3JCSixFQUFhTCxVQUFVQyxJQUFJaEQsR0FDM0JzRCxFQUFhN0IsWUFBYzJCLEVBQWFLLGtCQUN4Q0gsRUFBYVAsVUFBVUMsSUFBSS9DLE1BZEksMEJBaUJoQm1ELElBQ2YsTUFBTSxnQkFBRXBELEVBQUYsV0FBbUJDLEdBQWNTLEtBQUsyQyxVQUV0Q0MsRUFBZTVDLEtBQUs2QyxhQUFheEUsY0FBbEIsV0FBb0NxRSxFQUFhSSxHQUFqRCxXQUNyQkosRUFBYUwsVUFBVUosT0FBTzNDLEdBQzlCc0QsRUFBYTdCLFlBQWMsR0FDM0I2QixFQUFhUCxVQUFVSixPQUFPMUMsTUF2QkMsOEJBMEJabUQsSUFDZkEsRUFBYU0sU0FBU0MsTUFDeEJqRCxLQUFLa0QsZ0JBQWdCUixHQUVyQjFDLEtBQUttRCxnQkFBZ0JULEVBQWMxQyxLQUFLMkMsY0E5QlgsMkJBa0NoQixJQUFNM0MsS0FBS29ELFdBQVdDLE9BQU1YLEdBQWdCQSxFQUFhTSxTQUFTQyxVQWxDbEQsNEJBaURmLEtBRVpqRCxLQUFLc0QsbUJBQ0Z0RCxLQUFLdUQsZ0JBRUx2RCxLQUFLd0QsbUJBdERtQiw2QkEwRGQsS0FDakIsTUFBTSxjQUFFckUsR0FBa0JhLEtBQUsyQyxVQUkvQjNDLEtBQUt5RCxvQkFDTHpELEtBQUtvRCxXQUFXTSxTQUFTaEIsSUFDdkJBLEVBQWF4QyxpQkFBaUIsU0FBUyxLQUNyQ0YsS0FBSzJELG9CQUFvQmpCLEdBQ3pCMUMsS0FBS3lELDZCQWxFVHpELEtBQUsyQyxVQUFZMUQsRUFDakJlLEtBQUs2QyxhQUFlSixFQUNwQnpDLEtBQUtvRCxXQUFhLElBQUlwRCxLQUFLNkMsYUFBYXpFLGlCQUFpQjRCLEtBQUsyQyxVQUFVeEQsZ0JBQ3hFYSxLQUFLNEQsZUFBaUI1RCxLQUFLNkMsYUFBYXhFLGNBQWMyQixLQUFLMkMsVUFBVXZELHNCQWlDekVvRSxnQkFDSSxNQUFNLG9CQUFFbkUsR0FBd0JXLEtBQUsyQyxVQUNyQzNDLEtBQUs0RCxlQUFlQyxVQUFXLEVBQy9CN0QsS0FBSzRELGVBQWV2QixVQUFVQyxJQUFJakQsR0FHdENrRSxnQkFDSSxNQUFNLG9CQUFFbEUsR0FBd0JXLEtBQUsyQyxVQUNyQzNDLEtBQUs0RCxlQUFlQyxVQUFXLEVBQy9CN0QsS0FBSzRELGVBQWV2QixVQUFVSixPQUFPNUMsR0F5Q3pDeUUsbUJBQ0k5RCxLQUFLNkMsYUFBYTNDLGlCQUFpQixVQUFXNkQsSUFDMUNBLEVBQUlDLG9CQUdKaEUsS0FBS2tCLHVCQzdGVixNQUFNK0MsRUFDVHhFLFlBQVl5RSxHQUNSbEUsS0FBS21FLE9BQVNoRyxTQUFTRSxjQUFjNkYsR0FDckNsRSxLQUFLb0UsZ0JBQWtCcEUsS0FBS29FLGdCQUFnQkMsS0FBS3JFLE1BR3JEb0UsZ0JBQWdCTCxHQUNJLFdBQVpBLEVBQUlPLEtBQ1B0RSxLQUFLdUUsUUFJVkMsT0FDSXhFLEtBQUttRSxPQUFPOUIsVUFBVUMsSUFBSSxpQkFDMUJ0QyxLQUFLeUUscUJBR1RBLHFCQUNJQyxPQUFPeEUsaUJBQWlCLFVBQVdGLEtBQUtvRSxpQkFHNUNHLFFBQ0l2RSxLQUFLbUUsT0FBTzlCLFVBQVVKLE9BQU8saUJBQzdCakMsS0FBSzJFLHdCQUdUQSx3QkFDSUQsT0FBT0Usb0JBQW9CLFVBQVc1RSxLQUFLb0UsaUJBRy9DUyxvQkFFUTdFLEtBQUttRSxPQUFPakUsaUJBQWlCLGFBQWM2RCxLQUNuQ0EsRUFBSWUsT0FBT0MsUUFBUSxXQUFhaEIsRUFBSWUsT0FBT0MsUUFBUSxtQkFDbkQvRSxLQUFLdUUsWUNoQ2xCLE1BQU1TLFVBQXNCZixFQUMvQnhFLFlBQVl3RixFQUFjQyxHQUN0QkMsTUFBTUYsR0FFTmpGLEtBQUtvRixlQUFpQkYsRUFDdEJsRixLQUFLcUYsTUFBUXJGLEtBQUttRSxPQUFPOUYsY0FBYyxnQkFFdkMyQixLQUFLc0YsY0FBZ0J0RixLQUFLcUYsTUFBTWhILGNBQWMsZ0JBQzlDMkIsS0FBS3VGLG1CQUFxQnZGLEtBQUtzRixjQUFjdkUsWUFDN0NmLEtBQUt3RixRQUFVLElBQUl4RixLQUFLcUYsTUFBTWpILGlCQUFpQixrQkFHbkRxSCxrQkFDSSxNQUFNQyxFQUFTLEdBU2YsT0FQQTFGLEtBQUt3RixRQUFROUIsU0FBU2lDLElBQ2xCLE1BQU1yQixFQUFNcUIsRUFBTWxFLEtBQ1ptRSxFQUFRRCxFQUFNQyxNQUVwQkYsRUFBT3BCLEdBQU9zQixLQUdYRixFQUdYYixvQkFDSU0sTUFBTU4sb0JBQ043RSxLQUFLcUYsTUFBTW5GLGlCQUFpQixVQUFXMkYsSUFDbkNBLEVBQUU3QixpQkFDRmhFLEtBQUtvRixlQUFlcEYsS0FBS3lGLHNCQUtqQ0ssb0JBQW9CQyxHQUNoQi9GLEtBQUtvRixlQUFpQlcsRUFpQjFCQyxXQUFXQyxHQUNQakcsS0FBS3NGLGNBQWN2RSxZQUFja0YsRUFHckMxQixRQUNJWSxNQUFNWixRQUNOdkUsS0FBS3FGLE1BQU1hLFNDaUNSLE1BQU1DLEVBQU0sSUE3RnZCLE1BQ0kxRyxZQUFZMkcsRyxVQUtNQyxHQUNsQkEsRUFBSUMsR0FBS0QsRUFBSUUsT0FBU0MsUUFBUUMsT0FBT0osRUFBSUssYSxFQU5wQix5QixzQkFBQSxLLHVEQUFBLEssS0FDbkIxRyxLQUFLMkcsU0FBV1AsRUFBUVEsUUFDeEI1RyxLQUFLNkcsU0FBV1QsRUFBUVUsUUFNMUJDLGNBQ0ksT0FBT0MsTUFBTWhILEtBQUsyRyxTQUFXLFlBQWEsQ0FDeENHLFFBQVM5RyxLQUFLNkcsV0FFZkksS0FBS2pILEtBQUtrSCxnQkFHZkMsV0FDSSxPQUFPSCxNQUFNaEgsS0FBSzJHLFNBQVcsU0FBVSxDQUNyQ0csUUFBUzlHLEtBQUs2RyxXQUVmSSxLQUFLakgsS0FBS2tILGdCQUdmRSxZQUFZM0YsRUFBTTRGLEdBQ2QsT0FBT0wsTUFBTWhILEtBQUsyRyxTQUFXLFlBQWEsQ0FDdENXLE9BQVEsUUFDUlIsUUFBUzlHLEtBQUs2RyxTQUNkVSxLQUFNQyxLQUFLQyxVQUFVLENBQ2pCaEcsT0FDQTRGLFlBR1BKLEtBQUtqSCxLQUFLa0gsZ0JBR2ZRLFdBQVc1SSxHQUNQLE9BQU9rSSxNQUFNaEgsS0FBSzJHLFNBQVcsbUJBQW9CLENBQzdDVyxPQUFRLFFBQ1JSLFFBQVM5RyxLQUFLNkcsU0FDZFUsS0FBTUMsS0FBS0MsVUFBVSxDQUNqQjNJLGFBR1BtSSxLQUFLakgsS0FBS2tILGdCQUdmUyxRQUFRbEcsRUFBTUMsR0FDVixPQUFPc0YsTUFBTWhILEtBQUsyRyxTQUFXLFNBQVUsQ0FDbkNXLE9BQVEsT0FDUlIsUUFBUzlHLEtBQUs2RyxTQUNkVSxLQUFNQyxLQUFLQyxVQUFVLENBQ2pCaEcsT0FDQUMsV0FHUHVGLEtBQUtqSCxLQUFLa0gsZ0JBR2ZVLFFBQVE5RSxHQUNKLE9BQU9rRSxNQUFNaEgsS0FBSzJHLFNBQVcsZ0JBQWtCN0QsRUFBSSxDQUMvQ3dFLE9BQVEsTUFDUlIsUUFBUzlHLEtBQUs2RyxXQUVqQkksS0FBS2pILEtBQUtrSCxnQkFHZlcsV0FBVy9FLEdBQ1AsT0FBT2tFLE1BQU1oSCxLQUFLMkcsU0FBVyxnQkFBa0I3RCxFQUFJLENBQy9Dd0UsT0FBUSxTQUNSUixRQUFTOUcsS0FBSzZHLFdBRWpCSSxLQUFLakgsS0FBS2tILGdCQUdmVyxXQUFXL0UsR0FDVCxPQUFPa0UsTUFBTWhILEtBQUsyRyxTQUFXLGdCQUFrQjdELEVBQUksQ0FDL0N3RSxPQUFRLFNBQ1JSLFFBQVM5RyxLQUFLNkcsV0FFakJJLEtBQUtqSCxLQUFLa0gsZ0JBR2JZLFdBQVdoRixHQUNULE9BQU9rRSxNQUFNaEgsS0FBSzJHLFNBQVcsVUFBWTdELEVBQUksQ0FDekN3RSxPQUFRLFNBQ1JSLFFBQVM5RyxLQUFLNkcsV0FFakJJLEtBQUtqSCxLQUFLa0gsa0JBTWMsQ0FDM0JOLFFBQVMsaURBQ1RFLFFBQVMsQ0FDUGlCLGNBQWUsdUNBQ2YsZUFBZ0Isc0JDcEZoQkMsRUFBVyxJQ2JWLE1BQ0h2SSxZQUFZLEdBQThDLElBQTdDLGFBQUN3SSxFQUFELFlBQWVDLEVBQWYsZUFBNEJDLEdBQWlCLEVBQ3REbkksS0FBS29JLFVBQVlqSyxTQUFTRSxjQUFjNEosR0FDeENqSSxLQUFLcUksaUJBQW1CbEssU0FBU0UsY0FBYzZKLEdBQy9DbEksS0FBS3NJLFdBQWFuSyxTQUFTRSxjQUFjOEosR0FJN0NwQixjQUNJLE1BQU8sQ0FDUHRGLEtBQU16QixLQUFLb0ksVUFBVXJILFlBQ3JCd0gsWUFBYXZJLEtBQUtxSSxpQkFBaUJ0SCxhQUl2Q3lILFlBQVkvRyxFQUFNOEcsRUFBYXpKLEdBQzNCa0IsS0FBS29JLFVBQVVySCxZQUFjVSxFQUM3QnpCLEtBQUtxSSxpQkFBaUJ0SCxZQUFjd0gsRUFJeENFLGNBQWMzSixHQUNWa0IsS0FBS3NJLFdBQVd0SCxJQUFNbEMsSURUQSxDQUMxQm1KLGFBQWMsa0JBQ2RDLFlBQWEsd0JBQ2JDLGVBQWdCLG9CQUlwQixJQUFJeEksRUFFSjZHLFFBQVFrQyxJQUFJLENBQUN2QyxFQUFJWSxjQUFlWixFQUFJZ0IsYUFDL0JGLE1BQUssSUFBdUIsSUFBckIwQixFQUFVQyxHQUFXLEVBQ3pCakosRUFBU2dKLEVBQVMvRyxJQUVsQm9HLEVBQVNRLFlBQVlHLEVBQVNsSCxLQUFNa0gsRUFBU3RCLE1BQU9zQixFQUFTN0osUUFDN0QrSixFQUFRQyxZQUFZRixNQUV2QkcsTUFBTUMsUUFBUUMsS0FJbkIsTUFBTUMsRUFBb0IsSUFBSUMsRUFBY2xLLEVBQVVQLEdBQ2hEMEssRUFBdUIsSUFBSUQsRUFBY2xLLEVBQVVGLEdBQ25Ec0ssRUFBNEIsSUFBSUYsRUFBY2xLLEVBQVVKLEdBRTlEcUssRUFBa0JwRixtQkFDbEJzRixFQUFxQnRGLG1CQUNyQnVGLEVBQTBCdkYsbUJBRzFCLE1BdURNd0YsRUFBZSxJQUFJdEUsRUFBYyx3QkF2RFZ0RixJQUN6QjRKLEVBQWF0RCxXQUFXLGFBQ3hCRyxFQUFJd0IsUUFBUWpJLEVBQUssY0FBZUEsRUFBSyxjQUNwQ3VILE1BQUtaLElBQ0ZrRCxFQUFXbEQsRUFDTC9ILE1BR0wySSxNQUFLLEtBQ0ZxQyxFQUFhL0UsV0FFcEJ3RSxPQUFPUyxJQUNKUixRQUFRQyxJQUFJTyxNQUVmQyxTQUFRLEtBQ0xILEVBQWF0RCxXQUFXLGdCQXlDaENzRCxFQUFhekUsb0JBRWIsTUFBTTZFLEVBQW9CLElBQUkxRSxFQUFjLDZCQXJCaEJ0RixJQUN4QmdLLEVBQWtCMUQsV0FBVyxhQUM3QkcsRUFBSXVCLFdBQVdoSSxFQUFLLGNBQ25CdUgsTUFBS1osSUFDRjJCLEVBQVNTLGNBQWNwQyxFQUFJdkgsV0FFOUJtSSxNQUFLLEtBQ0Z5QyxFQUFrQm5GLFdBRXJCd0UsT0FBT1MsSUFDSlIsUUFBUUMsSUFBSU8sTUFFZkMsU0FBUSxLQUNMQyxFQUFrQjFELFdBQVcsY0FTckMwRCxFQUFrQjdFLG9CQUVsQixNQUFNOEUsRUFBa0IsSUFBSTNFLEVBQWMsOEJBQzFDMkUsRUFBZ0I5RSxvQkFFaEIsTUFBTStFLEVBQW1CLElBQUk1RSxFQUFjLDRCQTdDVnRGLElBQ2pDa0ssRUFBaUI1RCxXQUFXLGFBQ3hCRyxFQUFJaUIsWUFBWTFILEVBQUttSyxLQUFNbkssRUFBSzZJLGFBQy9CdEIsTUFBS1osSUFDRjJCLEVBQVNRLFlBQVluQyxFQUFJNUUsS0FBTTRFLEVBQUlnQixNQUFPaEIsRUFBSXZILFdBRWpEbUksTUFBSyxLQUNGMkMsRUFBaUJyRixXQUVwQndFLE9BQU9TLElBQ0pSLFFBQVFDLElBQUlPLE1BRWZDLFNBQVEsS0FDTEcsRUFBaUI1RCxXQUFXLGNBaUNwQzRELEVBQWlCL0Usb0JBRWpCLE1BQU1pRixFQUFhLElFM0daLGNBQTZCN0YsRUFDaEN4RSxZQUFZeUUsR0FDUmlCLE1BQU1qQixHQUVWbEUsS0FBSytKLFNBQVcvSixLQUFLbUUsT0FBTzlGLGNBQWMsb0JBQzFDMkIsS0FBS2dLLE9BQVNoSyxLQUFLbUUsT0FBTzlGLGNBQWMsaUJBR3hDbUcsS0FBSy9DLEVBQU1DLEdBQ1B5RCxNQUFNWCxPQUVOeEUsS0FBSytKLFNBQVNoSixZQUFjVSxFQUM1QnpCLEtBQUtnSyxPQUFPaEosSUFBTVUsRUFDbEIxQixLQUFLZ0ssT0FBTy9JLElBQVosb0JBQWdDUSxLRjhGRix1QkFDdENxSSxFQUFXakYsb0JBRVgsTUEwQk05RSxFQUFxQmtLLElBQ3ZCTixFQUFnQm5GLE9BR2hCbUYsRUFBZ0I3RCxxQkFBb0IsS0FDaEM2RCxFQUFnQjNELFdBQVcsZUFDM0JHLEVBQUkyQixXQUFXbUMsRUFBS2xJLFNBQ2pCa0YsTUFBSyxLQUNKZ0QsRUFBS2pJLGdCQUVMaUYsTUFBSyxLQUNMMEMsRUFBZ0JwRixXQUVoQndFLE9BQU9TLElBQ1BSLFFBQVFDLElBQUlPLE1BRWZDLFNBQVEsS0FDTEUsRUFBZ0IzRCxXQUFXLGNBS2pDdUQsRUFBYzdKLElBQ2hCLE1BQU11SyxFQUFPLElBQUl6SyxFQUFLLENBQ2xCRSxPQUNBQyxTQUNBQyxxQkFwRHFCLGlCQXFEckJDLGdCQUFpQixJQW5EQUgsS0FDckJvSyxFQUFXdEYsS0FBSzlFLEVBQUsrQixLQUFNL0IsRUFBS2dDLE9Ba0RMN0IsQ0FBZ0JILEdBQ3ZDSSxtQkFBb0IsSUFoREFtSyxLQUNyQkEsRUFBSzdILFVBQ0orRCxFQUFJMEIsV0FBV29DLEVBQUtsSSxTQUNwQmtGLE1BQUtaLElBQ0w0RCxFQUFLOUksU0FBU2tGLEVBQUkxRSxVQUVqQm9ILE9BQU9TLElBQ0pSLFFBQVFDLElBQUlPLE1BR2hCckQsRUFBSXlCLFFBQVFxQyxFQUFLbEksU0FDakJrRixNQUFLWixJQUNMNEQsRUFBSzlJLFNBQVNrRixFQUFJMUUsVUFFakJvSCxPQUFPUyxJQUNKUixRQUFRQyxJQUFJTyxPQWlDVTFKLENBQW1CbUssR0FDN0NsSyxrQkFBbUJBLElBR3ZCOEksRUFBUXFCLFFBQVFELEVBQUtFLG1CQUduQnRCLEVBQVUsSUc3S1QsTUFDSHBKLFlBQVksRUFBYTJLLEdBQW1CLElBQWhDLFNBQUVDLEdBQThCLEVBQ3hDckssS0FBS3NLLFVBQVlELEVBQ2pCckssS0FBS3VLLFdBQWFwTSxTQUFTRSxjQUFjK0wsR0FHN0N0QixZQUFZMEIsR0FDUkEsRUFBTTlHLFNBQVNoRSxJQUNYTSxLQUFLc0ssVUFBVTVLLE1BSXZCd0ssUUFBUU8sR0FDSnpLLEtBQUt1SyxXQUFXRyxRQUFRRCxLSGlLNUIsQ0FDSUosU0FBVWQsR0FDWCxhQTZCUGhMLEVBQWtCMkIsaUJBQWlCLFNBbkJuQyxZQU5BLFdBQ0ksTUFBTXlLLEVBQWMzQyxFQUFTakIsY0FDN0JwSSxFQUFlaUgsTUFBUStFLEVBQVlsSixLQUNuQzdDLEVBQXNCZ0gsTUFBUStFLEVBQVlwQyxZQUkxQ3FDLEdBQ0FoQixFQUFpQnBGLFVBbUJyQi9GLEVBQWlCeUIsaUJBQWlCLFNBZmxDLFdBQ0lrSixFQUFxQjVGLGdCQUNyQjhGLEVBQWE5RSxVQWVqQjFGLEVBQU9vQixpQkFBaUIsU0FYeEIsV0FDSW1KLEVBQTBCN0YsZ0JBQzFCa0csRUFBa0JsRixVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxyXG4gICAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBwb3B1cHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwXCIpO1xyXG5leHBvcnQgY29uc3QgZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGVsZW1lbnRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c1wiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpXHJcbiAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRcIik7XHJcblxyXG4vL3Byb2ZpbGUgbW9kZWwgYnV0dG9uc1xyXG5leHBvcnQgY29uc3QgZWRpdEJ1dHRvblByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgYWRkQnV0dG9uUHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuXHJcbi8vcG9wdXAgZWRpdCBwcm9maWxlXHJcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZVwiKTtcclxuXHJcbi8vcG9wdXAgZWRpdCBwcm9maWxlIGlucHV0c1xyXG5leHBvcnQgY29uc3QgcG9wdXBJbnB1dE5hbWUgPSBwb3B1cEVkaXRQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICBcIi5wb3B1cF9faW5wdXRfdHlwZV9uYW1lXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW5wdXREZXNjcmlwdGlvbiA9IHBvcHVwRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcihcclxuICAgIFwiLnBvcHVwX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uXCJcclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwb3B1cENoYW5nZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hdmF0YXItY2hhbmdlXCIpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcclxuXHJcbi8vZXhwb3J0IGNvbnN0IHBvcHVwRGVsZXRlQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hdmF0YXItY2hhbmdlXCIpO1xyXG4vL2V4cG9ydCBjb25zdCBkZWxldGVDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc2F2ZV90eXBlX2FkZC1jYXJkXCIpO1xyXG5cclxuXHJcbi8vcG9wdXAgYWRkIGNhcmRcclxuZXhwb3J0IGNvbnN0IHBvcHVwQWRkQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hZGQtY2FyZFwiKTtcclxuXHJcbi8vaW1hZ2UgcHJldmlld1xyXG5leHBvcnQgY29uc3QgcG9wdXBJbWFnZVByZXZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGUtcHJldmlld1wiKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW1hZ2UgPSBwb3B1cEltYWdlUHJldmlldy5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwVGl0bGUgPSBwb3B1cEltYWdlUHJldmlldy5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zdWJ0aXRsZVwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICAgIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zYXZlXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zYXZlX2Rpc2FibGVkXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcclxufVxyXG5cclxuIiwiZXhwb3J0IGNsYXNzIENhcmQge1xyXG4gICAgY29uc3RydWN0b3Ioe2RhdGEsIHVzZXJJZCwgdGVtcGxhdGVDYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaywgYWN0aXZhdGVMaWtlQnV0dG9uLCBoYW5kbGVEZWxldGVDbGlja30pIHsgLy97dGV4dCxsaW5rfVxyXG4gICAgICAgIHRoaXMuX3RleHQgPSBkYXRhLm5hbWU7IFxyXG4gICAgICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZFxyXG5cclxuICAgICAgICB0aGlzLl90ZW1wbGF0ZUNhcmRTZWxlY3RvciA9IHRlbXBsYXRlQ2FyZFNlbGVjdG9yXHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrXHJcbiAgICAgICAgdGhpcy5fYWN0aXZhdGVMaWtlQnV0dG9uID0gYWN0aXZhdGVMaWtlQnV0dG9uXHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGlja1xyXG5cclxuICAgICAgICB0aGlzLl9jYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRlbXBsYXRlQ2FyZFNlbGVjdG9yKVxyXG4gICAgICAgICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRcIik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIC8vX2FjdGl2YXRlTGlrZUJ1dHRvbiA9IGV2dCA9PiBldnQudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoXCJlbGVtZW50X19idXR0b24tbGlrZV9hY3RpdmVcIik7XHJcblxyXG4gICAgZ2V0SWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lkXHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9jYXJkLnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuX2NhcmQgPSBudWxsOy8vXHJcbiAgICB9XHJcbiAgICBcclxuICAgIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9hY3RpdmF0ZUxpa2VCdXR0b24oKSk7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fdGV4dCwgdGhpcy5fbGluaykpOy8vKHRoaXMuZGF0YSlcclxuICAgIH1cclxuXHJcbiAgICBzZXRMaWtlcyhuZXdMaWtlcykge1xyXG4gICAgICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXNcclxuXHJcbiAgICAgICAgY29uc3QgbGlrZUNvdW50ZXIgPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fbGlrZXMtY291bnRcIik7XHJcbiAgICAgICAgbGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcblxyXG4gICAgICAgIC8vIGNvbnN0IGxpa2VDb3VudGVyID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgICAgIC8vIHRoaXMuX2xpa2VzQ291bnRlci5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2xpa2VzLWNvdW50XCIpLnRleHRDb250ZW50ID0gbGlrZUNvdW50ZXI7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgY2FyZElzTGlrZWRCeVVzZXIgPSB0aGlzLmlzTGlrZWQoKVxyXG5cclxuICAgICAgICBpZiAoY2FyZElzTGlrZWRCeVVzZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiZWxlbWVudF9fYnV0dG9uLWxpa2VfYWN0aXZlXCIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImVsZW1lbnRfX2J1dHRvbi1saWtlX2FjdGl2ZVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaXNMaWtlZCgpIHtcclxuICAgICAgIHJldHVybiB0aGlzLl9saWtlcy5maW5kKHVzZXIgPT4gdXNlci5faWQgPT09IHRoaXMuX3VzZXJJZCkgXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q2FyZEVsZW1lbnQgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2FyZCA9IHRoaXMuX2NhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fYnV0dG9uLWxpa2VcIik7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2J1dHRvbi1kZWxldGVcIik7XHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2ltYWdlXCIpO1xyXG4gICAgICAgIGNvbnN0IGNhcmRUaXRsZSA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X190aXRsZVwiKTtcclxuXHJcbiAgICAgICAgdGhpcy5fbGlrZXNDb3VudGVyID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2xpa2VzLWNvdW50XCIpO1xyXG5cclxuICAgICAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl90ZXh0O1xyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl90ZXh0O1xyXG4gICAgICAgICAgICAgXHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRMaWtlcyh0aGlzLl9saWtlcylcclxuXHJcbiAgICAgICAgaWYodGhpcy5fdXNlcklkICE9PSB0aGlzLl9vd25lcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpa2VCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXHJcbiAgICAgICAgfVxyXG4gICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZDtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3NcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gWy4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvcildO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIGVycm9yQ2xhc3N9ID0gdGhpcy5fc2V0dGluZ3M7XHJcblxyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChpbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChlcnJvckNsYXNzKTtcclxuICAgIH07XHJcbiAgICAgIFxyXG4gICAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzfSA9IHRoaXMuX3NldHRpbmdzO1xyXG5cclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yQ2xhc3MpO1xyXG4gICAgfTtcclxuXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGlmIChpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgdGhpcy5fc2V0dGluZ3MpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgX2hhc0ludmFsaWRJbnB1dCA9ICgpID0+IHRoaXMuX2lucHV0TGlzdC5ldmVyeShpbnB1dEVsZW1lbnQgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcclxuXHJcbiAgICBcclxuICAgIGRpc2FibGVCdXR0b24oKSB7XHJcbiAgICAgICAgY29uc3QgeyBpbmFjdGl2ZUJ1dHRvbkNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgICAgIGNvbnN0IHsgaW5hY3RpdmVCdXR0b25DbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShpbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgfVxyXG5cclxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlID0gKCkgPT4ge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICAgICAgICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcclxuICAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyBpbnB1dFNlbGVjdG9yIH0gPSB0aGlzLl9zZXR0aW5nc1xyXG4gICAgICAgIC8vY29uc3QgYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgICAgIFxyXG4gICAgICBcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7IC8vdG9nZ2xlIHN1Ym1pdFxyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTsgLy9jaGVjayB2YWxpZGl0eVxyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7IC8vdG9nZ2xlIHN1Ym1pdFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvLyByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICAvLyAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7IFxyXG5cclxuICAgIC8vICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgLy8gICAgIHRoaXMuX2hpZGVFcnJvcihpbnB1dEVsZW1lbnQpIFxyXG4gICAgLy8gICB9KTtcclxuXHJcbiAgICAvLyB9XHJcblxyXG4gICAgLy8gcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgLy8gICAgIHRoaXMuaW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4ge1xyXG4gICAgLy8gICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dClcclxuICAgIC8vICAgICB9KVxyXG4gICAgLy8gfVxyXG5cclxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgICAgfTtcclxuICAgIFxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvciIsImV4cG9ydCBjbGFzcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpXHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpXHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgIHRoaXMuY2xvc2UoKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9fb3BlbmVkXCIpO1xyXG4gICAgICAgIHRoaXMuYWRkS2V5RG93bkxpc3RlbmVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkS2V5RG93bkxpc3RlbmVyKCkge1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX19vcGVuZWRcIik7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVLZXlEb3duTGlzdGVuZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVLZXlEb3duTGlzdGVuZXIoKSB7XHJcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQubWF0Y2hlcyhcIi5wb3B1cFwiKSB8fCBldnQudGFyZ2V0Lm1hdGNoZXMoXCIucG9wdXBfX2Nsb3NlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgIFxyXG4gICAgfVxyXG4gICBcclxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3VwU2VsZWN0b3IsIGhhbmRsZXJTdWJtaXQpIHtcclxuICAgICAgICBzdXBlcihwb3VwU2VsZWN0b3IpXHJcblxyXG4gICAgICAgIHRoaXMuX2hhbmRsZXJTdWJtaXQgPSBoYW5kbGVyU3VibWl0XHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIilcclxuICAgIFxyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc2F2ZVwiKVxyXG4gICAgICAgIHRoaXMuX2luaXRpYWxCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50XHJcbiAgICAgICAgdGhpcy5faW5wdXRzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIildXHJcbiAgICB9XHJcblxyXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHt9XHJcblxyXG4gICAgICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBrZXkgPSBpbnB1dC5uYW1lXHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gaW5wdXQudmFsdWVcclxuICAgICAgICBcclxuICAgICAgICAgICAgdmFsdWVzW2tleV0gPSB2YWx1ZVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHJldHVybiB2YWx1ZXNcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpXHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVyU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICAgICAgICAvL3RoaXMuY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNoYW5nZVN1Ym1pdEhhbmRsZXIobmV3U3VibWl0SGFuZGxlcikge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZXJTdWJtaXQgPSBuZXdTdWJtaXRIYW5kbGVyO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGNoYW5nZVRleHQodGV4dFR5cGUpIHsvLyBpbml0YWwgTG9hZGluZ1xyXG4gICAgLy8gICAgIC8vY29uc3QgYnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zYXZlXCIpXHJcbiAgICAgICAgXHJcbiAgICAvLyAgICAgLy9idXR0b24udGV4dENvbnRlbnQgPSB0ZXh0XHJcblxyXG4gICAgLy8gICAgIGlmKHRleHRUeXBlID09PSBcInNhdmluZ1wiKSB7XHJcbiAgICAvLyAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCJcclxuICAgIC8vICAgICB9XHJcblxyXG4gICAgLy8gICAgIGlmKHRleHRUeXBlID09PSBcImluaXRpYWxcIikge1xyXG4gICAgLy8gICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9pbml0aWFsQnV0dG9uVGV4dFxyXG4gICAgLy8gICAgIH1cclxuICAgIC8vIH1cclxuICAgIFxyXG4gICAgY2hhbmdlVGV4dCh0ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGV4dFxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHN1cGVyLmNsb3NlKClcclxuICAgICAgICB0aGlzLl9mb3JtLnJlc2V0KClcclxuICAgIH1cclxufSIsImNsYXNzIEFwaSB7XHJcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmxcclxuICAgICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVyc1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja1Jlc3BvbnNlID0gKHJlcykgPT5cclxuICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzVGV4dCk7XHJcbiAgXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL3VzZXJzL21lXCIsIHtcclxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgIGdldENhcmRzKCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHNcIiwge1xyXG4gICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICBlZGl0UHJvZmlsZShuYW1lLCBhYm91dCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvdXNlcnMvbWVcIiwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgICAgIGFib3V0XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgICB9XHJcblxyXG4gICAgZWRpdEF2YXRhcihhdmF0YXIpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL3VzZXJzL21lL2F2YXRhclwiLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBhdmF0YXJcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICAgIH0gIFxyXG5cclxuICAgIGFkZENhcmQobmFtZSwgbGluaykge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHNcIiwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICAgICAgbGluayxcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICBhZGRMaWtlKGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9saWtlcy9cIiArIGlkLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgICB9XHJcblxyXG4gICAgcmVtb3ZlTGlrZShpZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHMvbGlrZXMvXCIgKyBpZCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICAgICAgfVxyXG5cclxuICAgIHJlbW92ZUxpa2UoaWQpIHtcclxuICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9saWtlcy9cIiArIGlkLCB7XHJcbiAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQoaWQpIHtcclxuICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9cIiArIGlkLCB7XHJcbiAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgICBcclxuICAgIH1cclxuXHJcbiAgfVxyXG4gIFxyXG4gICAgZXhwb3J0IGNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gICAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC0zLWVuXCIsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgIGF1dGhvcml6YXRpb246IFwiNGNkYWUzMTQtN2U4YS00YmVkLThhZGEtNzBhZDMzYzEyZTEzXCIsXHJcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICB9XHJcbiAgfSk7IiwiaW1wb3J0IFwiLi8uLi9wYWdlcy9pbmRleC5jc3NcIjtcbmltcG9ydCBcIi4vLi4vZm9udHMvZm9udC5jc3NcIjtcbmltcG9ydCB7IGVsZW1lbnRMaXN0LCBlZGl0QnV0dG9uUHJvZmlsZSwgYWRkQnV0dG9uUHJvZmlsZSwgcG9wdXBFZGl0UHJvZmlsZSwgcG9wdXBJbnB1dE5hbWUsIHBvcHVwSW5wdXREZXNjcmlwdGlvbiwgcG9wdXBBZGRDYXJkLCBzZXR0aW5ncywgcG9wdXBDaGFuZ2VBdmF0YXIsIGF2YXRhciwgcG9wdXBEZWxldGVDYXJkfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCJcbmltcG9ydCB7IENhcmR9IGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIlxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIlxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiXG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiXG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCJcblxuaW1wb3J0IHsgYXBpfSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCJcblxuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gICAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLCBcbiAgICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIlxufSlcblxuXG5sZXQgdXNlcklkXG5cblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldENhcmRzKCldKVxuICAgIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xuICAgICAgICB1c2VySWQgPSB1c2VyRGF0YS5faWRcblxuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCB1c2VyRGF0YS5hYm91dCwgdXNlckRhdGEuYXZhdGFyKVxuICAgICAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzKVxufSlcbiAgICAuY2F0Y2goY29uc29sZS5sb2cpXG5cblxuLy8gdmFsaWRhdG9ycyAgICBcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIHBvcHVwRWRpdFByb2ZpbGUpXG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBwb3B1cEFkZENhcmQpXG5jb25zdCBjaGFuZ2VBdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIHBvcHVwQ2hhbmdlQXZhdGFyKVxuXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hZGRDYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5jaGFuZ2VBdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuLy8gc3VibWl0IGhhbmRsZXJzIG9mIG1vZGFsc1xuY29uc3QgaGFuZGxlQWRkQ2FyZFN1Ym1pdCA9IChkYXRhKSA9PiB7XG4gICAgYWRkQ2FyZFBvcHVwLmNoYW5nZVRleHQoXCJzYXZpbmcuLi5cIikgIFxuICAgIGFwaS5hZGRDYXJkKGRhdGFbXCJjYXJkLXRpdGxlXCJdLCBkYXRhW1wiY2FyZC1saW5rXCJdKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJlbmRlckNhcmQocmVzLCAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgZWxlbWVudExpc3RcbiAgICAgICAgICApO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKVxuICAgICAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+e1xuICAgICAgICBhZGRDYXJkUG9wdXAuY2hhbmdlVGV4dChcIkNyZWF0ZVwiKVxuICAgIH0pICAgIFxufVxuXG5jb25zdCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCA9IChkYXRhKSA9PiB7XG5lZGl0UHJvZmlsZVBvcHVwLmNoYW5nZVRleHQoXCJzYXZpbmcuLi5cIilcbiAgICBhcGkuZWRpdFByb2ZpbGUoZGF0YS5OYW1lLCBkYXRhLmRlc2NyaXB0aW9uKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcy5uYW1lLCByZXMuYWJvdXQsIHJlcy5hdmF0YXIpXG4gICAgfSlcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKVxuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT57XG4gICAgICAgIGVkaXRQcm9maWxlUG9wdXAuY2hhbmdlVGV4dChcIlNhdmVcIilcbiAgICB9KVxufVxuXG5cbmNvbnN0IGhhbmRsZUF2YXRhclN1Ym1pdCA9IChkYXRhKSA9PiB7XG4gICAgYXZhdGFyQ2hhbmdlUG9wdXAuY2hhbmdlVGV4dChcInNhdmluZy4uLlwiKVxuICAgIGFwaS5lZGl0QXZhdGFyKGRhdGFbXCJjYXJkLWxpbmtcIl0pXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMuYXZhdGFyKVxuICAgIH0pXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBhdmF0YXJDaGFuZ2VQb3B1cC5jbG9zZSgpXG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSlcbiAgICAuZmluYWxseSgoKSA9PntcbiAgICAgICAgYXZhdGFyQ2hhbmdlUG9wdXAuY2hhbmdlVGV4dChcIlNhdmVcIilcbiAgICB9KVxufVxuXG4vLyBpbnN0YW5jZXMgb2YgbW9kYWxzXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF90eXBlX2FkZC1jYXJkXCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpXG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKVxuXG5jb25zdCBhdmF0YXJDaGFuZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfYXZhdGFyLWNoYW5nZVwiLCBoYW5kbGVBdmF0YXJTdWJtaXQpXG5hdmF0YXJDaGFuZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfY29uZmlybS1kZWxldGVcIilcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZVwiLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdClcbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKVxuXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLnBvcHVwX3R5cGUtcHJldmlld1wiKVxuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IHRlbXBsYXRlQ2FyZFNlbGVjdG9yID0gXCIjY2FyZC10ZW1wbGF0ZVwiXG5cbmNvbnN0IGhhbmRsZUNhcmRDbGljayA9IChkYXRhKSA9PiB7XG4gICAgaW1hZ2VQb3B1cC5vcGVuKGRhdGEubmFtZSwgZGF0YS5saW5rKVxufVxuXG5jb25zdCBhY3RpdmF0ZUxpa2VCdXR0b24gPSAoY2FyZCkgPT4ge1xuICAgIGlmKGNhcmQuaXNMaWtlZCgpKSB7XG4gICAgICAgIGFwaS5yZW1vdmVMaWtlKGNhcmQuZ2V0SWQoKSlcbiAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcylcbiAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGFwaS5hZGRMaWtlKGNhcmQuZ2V0SWQoKSlcbiAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcylcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgfSlcbiAgICB9XG59ICAgICBcblxuY29uc3QgaGFuZGxlRGVsZXRlQ2xpY2sgPSAoY2FyZCkgPT4ge1xuICAgIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKClcbiAgICAvL2RlbGV0ZUNhcmRQb3B1cC5yZXNldFZhbGlkYXRpb24oKVxuXG4gICAgZGVsZXRlQ2FyZFBvcHVwLmNoYW5nZVN1Ym1pdEhhbmRsZXIoKCkgPT4ge1xuICAgICAgICBkZWxldGVDYXJkUG9wdXAuY2hhbmdlVGV4dChcImRlbGV0aW5nLi4uXCIpXG4gICAgICAgIGFwaS5kZWxldGVDYXJkKGNhcmQuZ2V0SWQoKSlcbiAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBjYXJkLnJlbW92ZUNhcmQoKVxuICAgICAgICAgICB9KVxuICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBkZWxldGVDYXJkUG9wdXAuY2xvc2UoKVxuICAgICAgICAgICB9KVxuICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICB9KVxuICAgICAgICAuZmluYWxseSgoKSA9PntcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jaGFuZ2VUZXh0KFwiWWVzXCIpXG4gICAgICAgIH0pXG4gIH0pXG59XG5cbmNvbnN0IHJlbmRlckNhcmQgPSAoZGF0YSkgPT4ge1xuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZCh7XG4gICAgICAgIGRhdGEsXG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgdGVtcGxhdGVDYXJkU2VsZWN0b3IsXG4gICAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4gaGFuZGxlQ2FyZENsaWNrKGRhdGEpLCBcbiAgICAgICAgYWN0aXZhdGVMaWtlQnV0dG9uOiAoKSA9PiBhY3RpdmF0ZUxpa2VCdXR0b24oY2FyZCksXG4gICAgICAgIGhhbmRsZURlbGV0ZUNsaWNrOiBoYW5kbGVEZWxldGVDbGlja1xuICAgIH1cbiAgICApICAgIFxuICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkLmdldENhcmRFbGVtZW50KCkpO1xufVxuXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAgeyAgXG4gICAgICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkIFxuICAgIH0sIFwiLmVsZW1lbnRzXCJcbiAgICApXG5cblxuZnVuY3Rpb24gZmlsbFByb2ZpbGVGb3JtKCkge1xuICAgIGNvbnN0IHByb2ZpbGVEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKVxuICAgIHBvcHVwSW5wdXROYW1lLnZhbHVlID0gcHJvZmlsZURhdGEubmFtZTtcbiAgICBwb3B1cElucHV0RGVzY3JpcHRpb24udmFsdWUgPSBwcm9maWxlRGF0YS5kZXNjcmlwdGlvbjtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRWRpdEJ1dHRvbkNsaWNrKCkge1xuICAgIGZpbGxQcm9maWxlRm9ybSgpO1xuICAgIGVkaXRQcm9maWxlUG9wdXAub3BlbigpXG4gICAgLy9lZGl0UHJvZmlsZVBvcHVwLnJlc2V0VmFsaWRhdGlvbigpXG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZEJ1dHRvbkNsaWNrKCkge1xuICAgIGFkZENhcmRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKVxuICAgIGFkZENhcmRQb3B1cC5vcGVuKClcbiAgICAvL2FkZENhcmRQb3B1cC5yZXNldFZhbGlkYXRpb24oKVxufVxuXG5mdW5jdGlvbiBoYW5kbGVDaGFuZ2VBdmF0YXJDbGljaygpIHtcbiAgICBjaGFuZ2VBdmF0YXJGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKVxuICAgIGF2YXRhckNoYW5nZVBvcHVwLm9wZW4oKVxuICAgIC8vYXZhdGFyQ2hhbmdlUG9wdXAucmVzZXRWYWxpZGF0aW9uKClcbn1cblxuXG5lZGl0QnV0dG9uUHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlRWRpdEJ1dHRvbkNsaWNrKTtcblxuYWRkQnV0dG9uUHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQWRkQnV0dG9uQ2xpY2spO1xuXG5hdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNoYW5nZUF2YXRhckNsaWNrKTsiLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoIHtuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcn0pIHtcclxuICAgICAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKVxyXG4gICAgICAgIHRoaXMuX3VzZXJEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpXHJcbiAgICAgICAgdGhpcy5fYXZhdGFyUGljID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3RvcilcclxuICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgbmFtZTogdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuX3VzZXJEZXNjcmlwdGlvbi50ZXh0Q29udGVudCxcclxuICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyhuYW1lLCBkZXNjcmlwdGlvbiwgYXZhdGFyKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX3VzZXJEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gICAgICAgIC8vdGhpcy5fYXZhdGFyUGljLnNyYyA9IGF2YXRhclxyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyUGljLnNyYyA9IGF2YXRhcjtcclxuICAgIH1cclxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKVxyXG5cclxuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zdWJ0aXRsZVwiKVxyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKSAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICAgICAgc3VwZXIub3BlbigpXHJcbiAgICAgICBcclxuICAgICAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZVxyXG4gICAgICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbmtcclxuICAgICAgICB0aGlzLl9pbWFnZS5hbHQgPSAoYCBpbWFnZSBvZiAke25hbWV9YClcclxuICAgICAgICBcclxuICAgIH1cclxufSIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXJ9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXJcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKVxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XHJcbiAgICAgICAgaXRlbXMuZm9yRWFjaCgoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihkYXRhKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpXHJcbiAgICB9XHJcbn0iXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwicXVlcnlTZWxlY3RvciIsImVsZW1lbnRMaXN0IiwiZWRpdEJ1dHRvblByb2ZpbGUiLCJjb250ZW50IiwiYWRkQnV0dG9uUHJvZmlsZSIsInBvcHVwRWRpdFByb2ZpbGUiLCJwb3B1cElucHV0TmFtZSIsInBvcHVwSW5wdXREZXNjcmlwdGlvbiIsInBvcHVwQ2hhbmdlQXZhdGFyIiwiYXZhdGFyIiwicG9wdXBBZGRDYXJkIiwicG9wdXBJbWFnZVByZXZpZXciLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsInVzZXJJZCIsInRlbXBsYXRlQ2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiYWN0aXZhdGVMaWtlQnV0dG9uIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJ0aGlzIiwiX2xpa2VCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2FjdGl2YXRlTGlrZUJ1dHRvbiIsIl9kZWxldGVCdXR0b24iLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfY2FyZEltYWdlIiwiX2hhbmRsZUNhcmRDbGljayIsIl90ZXh0IiwiX2xpbmsiLCJfY2FyZCIsIl9jYXJkVGVtcGxhdGUiLCJjbG9uZU5vZGUiLCJjYXJkVGl0bGUiLCJfbGlrZXNDb3VudGVyIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJzZXRMaWtlcyIsIl9saWtlcyIsIl91c2VySWQiLCJfb3duZXJJZCIsInN0eWxlIiwiZGlzcGxheSIsIm5hbWUiLCJsaW5rIiwibGlrZXMiLCJfaWQiLCJvd25lciIsIl90ZW1wbGF0ZUNhcmRTZWxlY3RvciIsImdldElkIiwicmVtb3ZlQ2FyZCIsInJlbW92ZSIsIm5ld0xpa2VzIiwibGVuZ3RoIiwiaXNMaWtlZCIsImNsYXNzTGlzdCIsImFkZCIsImZpbmQiLCJ1c2VyIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJfc2V0dGluZ3MiLCJlcnJvckVsZW1lbnQiLCJfZm9ybUVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsIl9pbnB1dExpc3QiLCJldmVyeSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfZW5hYmxlQnV0dG9uIiwiZGlzYWJsZUJ1dHRvbiIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfYnV0dG9uRWxlbWVudCIsImRpc2FibGVkIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsImtleSIsImNsb3NlIiwib3BlbiIsImFkZEtleURvd25MaXN0ZW5lciIsIndpbmRvdyIsInJlbW92ZUtleURvd25MaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsIm1hdGNoZXMiLCJQb3B1cFdpdGhGb3JtIiwicG91cFNlbGVjdG9yIiwiaGFuZGxlclN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZXJTdWJtaXQiLCJfZm9ybSIsIl9zdWJtaXRCdXR0b24iLCJfaW5pdGlhbEJ1dHRvblRleHQiLCJfaW5wdXRzIiwiX2dldElucHV0VmFsdWVzIiwidmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsImUiLCJjaGFuZ2VTdWJtaXRIYW5kbGVyIiwibmV3U3VibWl0SGFuZGxlciIsImNoYW5nZVRleHQiLCJ0ZXh0IiwicmVzZXQiLCJhcGkiLCJvcHRpb25zIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1c1RleHQiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsIl9jaGVja1Jlc3BvbnNlIiwiZ2V0Q2FyZHMiLCJlZGl0UHJvZmlsZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0QXZhdGFyIiwiYWRkQ2FyZCIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwiZGVsZXRlQ2FyZCIsImF1dGhvcml6YXRpb24iLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfdXNlck5hbWUiLCJfdXNlckRlc2NyaXB0aW9uIiwiX2F2YXRhclBpYyIsImRlc2NyaXB0aW9uIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiYWxsIiwidXNlckRhdGEiLCJjYXJkcyIsInNlY3Rpb24iLCJyZW5kZXJJdGVtcyIsImNhdGNoIiwiY29uc29sZSIsImxvZyIsImVkaXRGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwiY2hhbmdlQXZhdGFyRm9ybVZhbGlkYXRvciIsImFkZENhcmRQb3B1cCIsInJlbmRlckNhcmQiLCJlcnIiLCJmaW5hbGx5IiwiYXZhdGFyQ2hhbmdlUG9wdXAiLCJkZWxldGVDYXJkUG9wdXAiLCJlZGl0UHJvZmlsZVBvcHVwIiwiTmFtZSIsImltYWdlUG9wdXAiLCJfY2FwdGlvbiIsIl9pbWFnZSIsImNhcmQiLCJhZGRJdGVtIiwiZ2V0Q2FyZEVsZW1lbnQiLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsIml0ZW1zIiwiZWxlbWVudCIsInByZXBlbmQiLCJwcm9maWxlRGF0YSIsImZpbGxQcm9maWxlRm9ybSJdLCJzb3VyY2VSb290IjoiIn0=